import{C as Yr,S as rn,R as ba,h as js,P as Ke,W as On,A as Rs,a as Ze,M as Nt,b as ya,c as Ns,d as _a,e as xa,N as Ca,V as ye,f as J,B as At,O as Pa,g as Ds,D as Zn,i as xt,T as Ea,E as Bs,j as Ma,k as Fs,l as sn,m as Ta,I as Sa,n as Ri,o as Us,U as Wr,p as Vn,q as Ct,L as ka,r as La,s as zs,t as zn,u as Ia,v as Aa,H as Oa,w as Jn,F as Ni,x as mr,y as Va,z as ja,G as Di,J as ft,K as Ra,Q as Na,X as Ot,Y as Da,Z as Tt,_ as Bi,$ as Fi,a0 as Ba,a1 as fr,a2 as Hs,a3 as Fa,a4 as Ua,a5 as za,a6 as Ha,a7 as $a,a8 as Ga,a9 as Ka,aa as Ya,ab as Wa,ac as qa,ad as Za,ae as Ja,af as Qa}from"./HomeView-CQ25Rm-X.js";import{u as q,l as W,m as Me,q as qr,s as Qn,v as Xa,x as Zr,y as el,z as $s,A as Gs,B as Hn,C as $n,D as _e,E as Ut,G as Ks,H as Dt,I as Ys,J as lt,K as wt,o as Ge,c as st,k as tl,n as nl,L as Ar,M as Ws,N as Ui,F as rl,O as il,e as sl,g as qs,a as Vt,P as ol,b as Zs,d as Xt,Q as al,_ as ll,w as ul,f as zi,p as cl,h as dl}from"./index-Lm6eKlVS.js";import"./ProjectCassette-v7M3LJzT.js";function Je(n){return $s()?(Gs(n),!0):!1}function Oe(){const n=new Set,e=i=>{n.delete(i)};return{on:i=>{n.add(i);const s=()=>e(i);return Je(s),{off:s}},off:e,trigger:(...i)=>Promise.all(Array.from(n).map(s=>s(...i)))}}function he(n){return typeof n=="function"?n():q(n)}const Or=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const pl=n=>n!=null,hl=Object.prototype.toString,ml=n=>hl.call(n)==="[object Object]",Vr=()=>{};function fl(n,e){function t(...r){return new Promise((i,s)=>{Promise.resolve(n(()=>e.apply(this,r),{fn:e,thisArg:this,args:r})).then(i).catch(s)})}return t}function vl(n,e={}){let t,r,i=Vr;const s=a=>{clearTimeout(a),i(),i=Vr};return a=>{const l=he(n),p=he(e.maxWait);return t&&s(t),l<=0||p!==void 0&&p<=0?(r&&(s(r),r=null),Promise.resolve(a())):new Promise((w,h)=>{i=e.rejectOnCancel?h:w,p&&!r&&(r=setTimeout(()=>{t&&s(t),r=null,w(a())},p)),t=setTimeout(()=>{r&&s(r),r=null,w(a())},l)})}}function gl(n,e,t=!1){return e.reduce((r,i)=>(i in n&&(!t||n[i]!==void 0)&&(r[i]=n[i]),r),{})}function wl(n){return Hn()}function bl(n,e=200,t={}){return fl(vl(e,t),n)}function Hi(n,e=200,t={}){const r=W(n.value),i=bl(()=>{r.value=n.value},e,t);return Me(n,()=>i()),r}function yl(n,e={}){if(!qr(n))return Qn(n);const t=Array.isArray(n.value)?Array.from({length:n.value.length}):{};for(const r in n.value)t[r]=Xa(()=>({get(){return n.value[r]},set(i){var s;if((s=he(e.replaceRef))!=null?s:!0)if(Array.isArray(n.value)){const a=[...n.value];a[r]=i,n.value=a}else{const a={...n.value,[r]:i};Object.setPrototypeOf(a,Object.getPrototypeOf(n.value)),n.value=a}else n.value[r]=i}}));return t}function Jr(n,e=!0,t){wl()?Zr(n,t):e?n():el(n)}function _l(n,e=1e3,t={}){const{immediate:r=!0,immediateCallback:i=!1}=t;let s=null;const o=W(!1);function a(){s&&(clearInterval(s),s=null)}function l(){o.value=!1,a()}function p(){const w=he(e);w<=0||(o.value=!0,i&&n(),a(),s=setInterval(n,w))}if(r&&Or&&p(),qr(e)||typeof e=="function"){const w=Me(e,()=>{o.value&&Or&&p()});Je(w)}return Je(l),{isActive:o,pause:l,resume:p}}function Ye(n){var e;const t=he(n);return(e=t==null?void 0:t.$el)!=null?e:t}const ct=Or?window:void 0;function on(...n){let e,t,r,i;if(typeof n[0]=="string"||Array.isArray(n[0])?([t,r,i]=n,e=ct):[e,t,r,i]=n,!e)return Vr;Array.isArray(t)||(t=[t]),Array.isArray(r)||(r=[r]);const s=[],o=()=>{s.forEach(w=>w()),s.length=0},a=(w,h,M,P)=>(w.addEventListener(h,M,P),()=>w.removeEventListener(h,M,P)),l=Me(()=>[Ye(e),he(i)],([w,h])=>{if(o(),!w)return;const M=ml(h)?{...h}:h;s.push(...t.flatMap(P=>r.map(m=>a(w,P,m,M))))},{immediate:!0,flush:"post"}),p=()=>{l(),o()};return Je(p),p}function xl(){const n=W(!1),e=Hn();return e&&Zr(()=>{n.value=!0},e),n}function Xn(n){const e=xl();return _e(()=>(e.value,!!n()))}function Cl(n,e,t={}){const{window:r=ct,...i}=t;let s;const o=Xn(()=>r&&"MutationObserver"in r),a=()=>{s&&(s.disconnect(),s=void 0)},l=_e(()=>{const M=he(n),P=(Array.isArray(M)?M:[M]).map(Ye).filter(pl);return new Set(P)}),p=Me(()=>l.value,M=>{a(),o.value&&M.size&&(s=new MutationObserver(e),M.forEach(P=>s.observe(P,i)))},{immediate:!0,flush:"post"}),w=()=>s==null?void 0:s.takeRecords(),h=()=>{a(),p()};return Je(h),{isSupported:o,stop:h,takeRecords:w}}function er(n,e={}){const{immediate:t=!0,fpsLimit:r=void 0,window:i=ct}=e,s=W(!1),o=r?1e3/r:null;let a=0,l=null;function p(M){if(!s.value||!i)return;a||(a=M);const P=M-a;if(o&&P<o){l=i.requestAnimationFrame(p);return}a=M,n({delta:P,timestamp:M}),l=i.requestAnimationFrame(p)}function w(){!s.value&&i&&(s.value=!0,a=0,l=i.requestAnimationFrame(p))}function h(){s.value=!1,l!=null&&i&&(i.cancelAnimationFrame(l),l=null)}return t&&w(),Je(h),{isActive:$n(s),pause:h,resume:w}}function Pl(n,e={}){const{window:t=ct}=e,r=Xn(()=>t&&"matchMedia"in t&&typeof t.matchMedia=="function");let i;const s=W(!1),o=p=>{s.value=p.matches},a=()=>{i&&("removeEventListener"in i?i.removeEventListener("change",o):i.removeListener(o))},l=Ut(()=>{r.value&&(a(),i=t.matchMedia(he(n)),"addEventListener"in i?i.addEventListener("change",o):i.addListener(o),s.value=i.matches)});return Je(()=>{l(),a(),i=void 0}),s}function El(n={}){const{window:e=ct}=n,t=W(1);if(e){let r=function(){t.value=e.devicePixelRatio,i(),s=e.matchMedia(`(resolution: ${t.value}dppx)`),s.addEventListener("change",r,{once:!0})},i=function(){s==null||s.removeEventListener("change",r)},s;r(),Je(i)}return{pixelRatio:t}}function Js(n,e,t={}){const{window:r=ct,...i}=t;let s;const o=Xn(()=>r&&"ResizeObserver"in r),a=()=>{s&&(s.disconnect(),s=void 0)},l=_e(()=>Array.isArray(n)?n.map(h=>Ye(h)):[Ye(n)]),p=Me(l,h=>{if(a(),o.value&&r){s=new ResizeObserver(e);for(const M of h)M&&s.observe(M,i)}},{immediate:!0,flush:"post"}),w=()=>{a(),p()};return Je(w),{isSupported:o,stop:w}}function Ml(n,e={}){const{reset:t=!0,windowResize:r=!0,windowScroll:i=!0,immediate:s=!0}=e,o=W(0),a=W(0),l=W(0),p=W(0),w=W(0),h=W(0),M=W(0),P=W(0);function m(){const C=Ye(n);if(!C){t&&(o.value=0,a.value=0,l.value=0,p.value=0,w.value=0,h.value=0,M.value=0,P.value=0);return}const f=C.getBoundingClientRect();o.value=f.height,a.value=f.bottom,l.value=f.left,p.value=f.right,w.value=f.top,h.value=f.width,M.value=f.x,P.value=f.y}return Js(n,m),Me(()=>Ye(n),C=>!C&&m()),Cl(n,m,{attributeFilter:["style","class"]}),i&&on("scroll",m,{capture:!0,passive:!0}),r&&on("resize",m,{passive:!0}),Jr(()=>{s&&m()}),{height:o,bottom:a,left:l,right:p,top:w,width:h,x:M,y:P,update:m}}function Tl(n,e={width:0,height:0},t={}){const{window:r=ct,box:i="content-box"}=t,s=_e(()=>{var h,M;return(M=(h=Ye(n))==null?void 0:h.namespaceURI)==null?void 0:M.includes("svg")}),o=W(e.width),a=W(e.height),{stop:l}=Js(n,([h])=>{const M=i==="border-box"?h.borderBoxSize:i==="content-box"?h.contentBoxSize:h.devicePixelContentBoxSize;if(r&&s.value){const P=Ye(n);if(P){const m=P.getBoundingClientRect();o.value=m.width,a.value=m.height}}else if(M){const P=Array.isArray(M)?M:[M];o.value=P.reduce((m,{inlineSize:C})=>m+C,0),a.value=P.reduce((m,{blockSize:C})=>m+C,0)}else o.value=h.contentRect.width,a.value=h.contentRect.height},t);Jr(()=>{const h=Ye(n);h&&(o.value="offsetWidth"in h?h.offsetWidth:e.width,a.value="offsetHeight"in h?h.offsetHeight:e.height)});const p=Me(()=>Ye(n),h=>{o.value=h?e.width:0,a.value=h?e.height:0});function w(){l(),p()}return{width:o,height:a,stop:w}}function Sl(n){var e;const t=W(0);if(typeof performance>"u")return t;const r=(e=n==null?void 0:n.every)!=null?e:10;let i=performance.now(),s=0;return er(()=>{if(s+=1,s>=r){const o=performance.now(),a=o-i;t.value=Math.round(1e3/(a/s)),i=o,s=0}}),t}function kl(n={}){const e=W(),t=Xn(()=>typeof performance<"u"&&"memory"in performance);if(t.value){const{interval:r=1e3}=n;_l(()=>{e.value=performance.memory},r,{immediate:n.immediate,immediateCallback:n.immediateCallback})}return{isSupported:t,memory:e}}const Qs={x:0,y:0,pointerId:0,pressure:0,tiltX:0,tiltY:0,width:0,height:0,twist:0,pointerType:null},Ll=Object.keys(Qs);function Il(n={}){const{target:e=ct}=n,t=W(!1),r=W(n.initialValue||{});Object.assign(r.value,Qs,r.value);const i=s=>{t.value=!0,!(n.pointerTypes&&!n.pointerTypes.includes(s.pointerType))&&(r.value=gl(s,Ll,!1))};if(e){const s={passive:!0};on(e,["pointerdown","pointermove","pointerup"],i,s),on(e,"pointerleave",()=>t.value=!1,s)}return{...yl(r),isInside:t}}function Al(n={}){const{window:e=ct,initialWidth:t=Number.POSITIVE_INFINITY,initialHeight:r=Number.POSITIVE_INFINITY,listenOrientation:i=!0,includeScrollbar:s=!0}=n,o=W(t),a=W(r),l=()=>{e&&(s?(o.value=e.innerWidth,a.value=e.innerHeight):(o.value=e.document.documentElement.clientWidth,a.value=e.document.documentElement.clientHeight))};if(l(),Jr(l),on("resize",l,{passive:!0}),i){const p=Pl("(orientation: portrait)");Me(p,()=>l())}return{width:o,height:a}}var Ol=Object.defineProperty,Vl=(n,e,t)=>e in n?Ol(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,$i=(n,e,t)=>(Vl(n,typeof e!="symbol"?e+"":e,t),t);const jl="@tresjs/core",Rl="module",Nl="4.0.2",Dl="pnpm@9.1.4",Bl="Declarative ThreeJS using Vue Components",Fl="Alvaro Saburido <hola@alvarosaburido.dev> (https://github.com/alvarosabu/)",Ul="MIT",zl=["vue","3d","threejs","three","threejs-vue"],Hl=!1,$l={".":{types:"./dist/index.d.ts",import:"./dist/tres.js",require:"./dist/tres.umd.cjs"},"./components":{types:"./dist/src/components/index.d.ts"},"./composables":{types:"./dist/src/composables/index.d.ts"},"./types":{types:"./dist/src/types/index.d.ts"},"./utils":{types:"./dist/src/utils/index.d.ts"},"./*":"./*"},Gl="./dist/tres.js",Kl="./dist/tres.js",Yl="./dist/index.d.ts",Wl=["*.d.ts","dist"],ql={access:"public"},Zl={dev:"cd playground && npm run dev",build:"vite build",playground:"cd playground && npm run dev",test:"vitest","test:ci":"vitest run","test:ui":"vitest --ui --coverage.enabled=true",release:"release-it",coverage:"vitest run --coverage",lint:"eslint .","lint:fix":"eslint . --fix","docs:dev":"vitepress dev docs","docs:build":"vitepress build docs","docs:serve":"vitepress serve docs","docs:preview":"vitepress preview docs","docs:contributors":"esno scripts/update-contributors.ts",prepare:"node .husky/install.mjs"},Jl={three:">=0.133",vue:">=3.4"},Ql={"@alvarosabu/utils":"^3.2.0","@vue/devtools-api":"^6.6.2","@vueuse/core":"^10.10.0"},Xl={"@release-it/conventional-changelog":"^8.0.1","@stackblitz/sdk":"^1.10.0","@tresjs/cientos":"3.9.0","@tresjs/eslint-config":"^1.1.0","@types/three":"^0.165.0","@typescript-eslint/eslint-plugin":"^7.11.0","@typescript-eslint/parser":"^7.11.0","@vitejs/plugin-vue":"^5.0.5","@vitest/coverage-c8":"^0.33.0","@vitest/coverage-v8":"^1.6.0","@vitest/ui":"^1.6.0","@vue/test-utils":"^2.4.6",eslint:"^9.4.0","eslint-plugin-vue":"^9.26.0",esno:"^4.7.0",gsap:"^3.12.5",husky:"^9.0.11",jsdom:"^24.1.0",kolorist:"^1.8.0",ohmyfetch:"^0.4.21",pathe:"^1.1.2","release-it":"^17.3.0","rollup-plugin-analyzer":"^4.0.0","rollup-plugin-copy":"^3.5.0","rollup-plugin-visualizer":"^5.12.0",three:"^0.165.0",unocss:"^0.60.4",unplugin:"^1.10.1","unplugin-vue-components":"^0.27.0",vite:"^5.2.12","vite-plugin-banner":"^0.7.1","vite-plugin-dts":"3.9.1","vite-plugin-inspect":"^0.8.4","vite-plugin-require-transform":"^1.0.21","vite-svg-loader":"^5.1.0",vitepress:"1.2.2",vitest:"^1.6.0",vue:"^3.4.27","vue-demi":"^0.14.8"},eu={name:jl,type:Rl,version:Nl,packageManager:Dl,description:Bl,author:Fl,license:Ul,keywords:zl,sideEffects:Hl,exports:$l,main:Gl,module:Kl,types:Yl,files:Wl,publishConfig:ql,scripts:Zl,peerDependencies:Jl,dependencies:Ql,devDependencies:Xl},tu=({sizes:n})=>{const e=W([]),t=_e(()=>e.value[0]),r=o=>{const a=o instanceof ya?o:e.value.find(p=>p.uuid===o);if(!a)return;const l=e.value.filter(({uuid:p})=>p!==a.uuid);e.value=[a,...l]},i=(o,a=!1)=>{e.value.some(({uuid:l})=>l===o.uuid)||(a?r(o):e.value.push(o))},s=o=>{e.value=e.value.filter(({uuid:a})=>a!==o.uuid)};return Ut(()=>{n.aspectRatio.value&&e.value.forEach(o=>{!o.manual&&(o instanceof Ke||nu(o))&&(o instanceof Ke?o.aspect=n.aspectRatio.value:(o.left=n.width.value*-.5,o.right=n.width.value*.5,o.top=n.height.value*.5,o.bottom=n.height.value*-.5),o.updateProjectionMatrix())})}),wt(()=>{e.value=[]}),{camera:t,cameras:e,registerCamera:i,deregisterCamera:s,setCameraActive:r}};function nu(n){return n.hasOwnProperty("isOrthographicCamera")&&n.isOrthographicCamera}const ru=Oe(),iu=Oe(),Xs=Oe(),tn=new Yr;let jn=0,Rn=0;er(()=>{ru.trigger({delta:jn,elapsed:Rn,clock:tn}),iu.trigger({delta:jn,elapsed:Rn,clock:tn}),Xs.trigger({delta:jn,elapsed:Rn,clock:tn})},{immediate:!1});Xs.on(()=>{jn=tn.getDelta(),Rn=tn.getElapsedTime()});const xn="[TresJS ▲ ■ ●] ";function tr(){function n(...r){typeof r[0]=="string"?r[0]=xn+r[0]:r.unshift(xn),console.error(...r)}function e(...r){typeof r[0]=="string"?r[0]=xn+r[0]:r.unshift(xn),console.warn(...r)}function t(r,i){}return{logError:n,logWarning:e,logMessage:t}}function su(n){return n instanceof Ze?n:Array.isArray(n)?new Ze(...n):new Ze(n)}class ou extends xt{constructor(...e){super(...e),$i(this,"type","HightlightMesh"),$i(this,"createTime"),this.createTime=Date.now()}onBeforeRender(){const e=(Date.now()-this.createTime)/1e3,t=1+.07*Math.sin(2.5*e);this.scale.set(t,t,t)}}const eo=(n,e)=>{for(const t of Object.keys(e))e[t]instanceof Object&&Object.assign(e[t],eo(n[t],e[t]));return Object.assign(n||{},e),n},au="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",lu=du(au);function Gi(n){return n&&n.nodeType===1}function Cn(n){return n.replace(/-([a-z])/g,(e,t)=>t.toUpperCase())}const uu=/\B([A-Z])/g;function cu(n){return n.replace(uu,"-$1").toLowerCase()}function du(n,e){const t=Object.create(null),r=n.split(",");for(let i=0;i<r.length;i++)t[r[i]]=!0;return i=>!!t[i]}const Ki=(n,e)=>{if(!e)return;const t=Array.isArray(e)?e:e.match(/([^[.\]])+/g);return t==null?void 0:t.reduce((r,i)=>r&&r[i],n)},pu=(n,e,t)=>{const r=Array.isArray(e)?e:e.match(/([^[.\]])+/g);r&&r.reduce((i,s,o)=>(i[s]===void 0&&(i[s]={}),o===r.length-1&&(i[s]=t),i[s]),n)};function to(n,e){if(Gi(n)&&Gi(e)){const i=n.attributes,s=e.attributes;return i.length!==s.length?!1:Array.from(i).every(({name:o,value:a})=>e.getAttribute(o)===a)}if(n===e)return!0;if(n===null||typeof n!="object"||e===null||typeof e!="object")return!1;const t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(const i of t)if(!r.includes(i)||!to(n[i],e[i]))return!1;return!0}function hu(n,e){if(!Array.isArray(n)||!Array.isArray(e)||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!to(n[t],e[t]))return!1;return!0}function mu(n,e,t,r){const i=l=>{if(l.uuid===e)return l;for(const p of l.children){const w=i(p);if(w)return w}},s=i(n);if(!s){console.warn("Object with UUID not found in the scene.");return}let o=s;for(let l=0;l<t.length-1;l++)if(o[t[l]]!==void 0)o=o[t[l]];else{console.warn(`Property path is not valid: ${t.join(".")}`);return}const a=t[t.length-1];o[a]!==void 0?o[a]=r:console.warn(`Property path is not valid: ${t.join(".")}`)}function fu(n){const e=new Ds({color:11003607,transparent:!0,opacity:.2,depthTest:!1,side:Zn});return new ou(n.geometry.clone(),e)}function vu(n){return"map"in n}function Yi(n){vu(n)&&n.map&&n.map.dispose(),n.dispose()}function Qr(n){var e,t;if(n.parent&&((e=n.removeFromParent)==null||e.call(n)),delete n.__tres,[...n.children].forEach(r=>Qr(r)),!(n instanceof rn)){const r=n;n&&((t=n.dispose)==null||t.call(n)),r.geometry&&(r.geometry.dispose(),delete r.geometry),Array.isArray(r.material)?(r.material.forEach(i=>Yi(i)),delete r.material):r.material&&(Yi(r.material),delete r.material)}}const gu=Number.parseInt(Ns.replace("dev","")),Pn={realistic:{shadows:!0,physicallyCorrectLights:!0,outputColorSpace:_a,toneMapping:Rs,toneMappingExposure:3,shadowMap:{enabled:!0,type:xa}},flat:{toneMapping:Ca,toneMappingExposure:1}};function wu({canvas:n,options:e,contextParts:{sizes:t,render:r,invalidate:i,advance:s}}){const o=_e(()=>({alpha:he(e.alpha)??!0,depth:he(e.depth),canvas:Ye(n),context:he(e.context),stencil:he(e.stencil),antialias:he(e.antialias)??!0,precision:he(e.precision),powerPreference:he(e.powerPreference),premultipliedAlpha:he(e.premultipliedAlpha),preserveDrawingBuffer:he(e.preserveDrawingBuffer),logarithmicDepthBuffer:he(e.logarithmicDepthBuffer),failIfMajorPerformanceCaveat:he(e.failIfMajorPerformanceCaveat)})),a=lt(new On(o.value));function l(){e.renderMode==="on-demand"&&i()}Me(o,()=>{a.value.dispose(),a.value=new On(o.value),l()}),Me([t.width,t.height],()=>{a.value.setSize(t.width.value,t.height.value),l()},{immediate:!0}),Me(()=>e.clearColor,l);const{pixelRatio:p}=El();Me(p,()=>{a.value.setPixelRatio(p.value)});const{logError:w}=tr(),h=(()=>{const P=new On,m={shadowMap:{enabled:P.shadowMap.enabled,type:P.shadowMap.type},toneMapping:P.toneMapping,toneMappingExposure:P.toneMappingExposure,outputColorSpace:P.outputColorSpace};return P.dispose(),m})(),M=he(e.renderMode);return M==="on-demand"&&i(),M==="manual"&&setTimeout(()=>{s()},100),Ut(()=>{const P=he(e.preset);P&&(P in Pn||w(`Renderer Preset must be one of these: ${Object.keys(Pn).join(", ")}`),eo(a.value,Pn[P])),M==="always"&&(r.frames.value=Math.max(1,r.frames.value));const m=(x,T)=>{const E=he(x),k=()=>{if(P)return Ki(Pn[P],T)};if(E!==void 0)return E;const S=k();return S!==void 0?S:Ki(h,T)},C=(x,T)=>pu(a.value,T,m(x,T));C(e.shadows,"shadowMap.enabled"),C(e.toneMapping??Rs,"toneMapping"),C(e.shadowMapType,"shadowMap.type"),gu<150&&C(!e.useLegacyLights,"physicallyCorrectLights"),C(e.outputColorSpace,"outputColorSpace"),C(e.toneMappingExposure,"toneMappingExposure");const f=m(e.clearColor,"clearColor");f&&a.value.setClearColor(f?su(f):new Ze(0))}),wt(()=>{a.value.dispose(),a.value.forceContextLoss()}),{renderer:a}}const En=n=>typeof n=="function",bu=(n,e)=>{const t=_e(()=>e.renderer.value.domElement),r=lt([]),{x:i,y:s}=Il({target:t}),o=_e(()=>n.value.filter(U=>{var Q;return((Q=U.__tres)==null?void 0:Q.eventCount)>0}));let a=0;const{width:l,height:p,top:w,left:h}=Ml(t),M=({x:U,y:Q})=>{if(t.value)return{x:(U-h.value)/l.value*2-1,y:-((Q-w.value)/p.value)*2+1}},P=({x:U,y:Q})=>{if(e.camera.value)return e.raycaster.value.setFromCamera(new ye(U,Q),e.camera.value),r.value=e.raycaster.value.intersectObjects(o.value,!0),r.value},m=U=>{const Q=M({x:(U==null?void 0:U.clientX)??i.value,y:(U==null?void 0:U.clientY)??s.value});return Q?P(Q)||[]:[]},C=Oe(),f=Oe(),x=Oe(),T=Oe(),E=Oe(),k=Oe(),S=Oe(),v=Oe();function L(U){const Q={};for(const se in U)typeof se!="function"&&(Q[se]=U[se]);return Q}const d=(U,Q)=>{var se,we,Le;const Fe=L(Q),N=new J(Q==null?void 0:Q.clientX,Q==null?void 0:Q.clientY,0).unproject((se=e.camera)==null?void 0:se.value);U.trigger({...Fe,intersections:r.value,unprojectedPoint:N,ray:(we=e.raycaster)==null?void 0:we.value.ray,camera:(Le=e.camera)==null?void 0:Le.value,sourceEvent:Q,delta:a,stopPropagating:!1})};let b;const u=U=>{m(U),d(x,U),b=U},y=()=>{b&&u(b)};let A,F,j;const z=U=>{var Q;A=(Q=r.value[0])==null?void 0:Q.object,a=0,F=new ye((U==null?void 0:U.clientX)??i.value,(U==null?void 0:U.clientY)??s.value),d(E,U)};let R,H=!1;const te=U=>{var Q,se,we;U instanceof PointerEvent&&(r.value.length===0&&d(k,U),A===((Q=r.value[0])==null?void 0:Q.object)&&(j=new ye((U==null?void 0:U.clientX)??i.value,(U==null?void 0:U.clientY)??s.value),a=F==null?void 0:F.distanceTo(j),U.button===0?(d(C,U),R===((se=r.value[0])==null?void 0:se.object)?H=!0:(R=(we=r.value[0])==null?void 0:we.object,H=!1)):U.button===2&&d(S,U)),d(T,U))},ee=U=>{H&&(d(f,U),R=void 0,H=!1)},Z=U=>d(x,U),Pe=U=>d(v,U);return t.value.addEventListener("pointerup",te),t.value.addEventListener("pointerdown",z),t.value.addEventListener("pointermove",u),t.value.addEventListener("pointerleave",Z),t.value.addEventListener("dblclick",ee),t.value.addEventListener("wheel",Pe),wt(()=>{t!=null&&t.value&&(t.value.removeEventListener("pointerup",te),t.value.removeEventListener("pointerdown",z),t.value.removeEventListener("pointermove",u),t.value.removeEventListener("pointerleave",Z),t.value.removeEventListener("dblclick",ee),t.value.removeEventListener("wheel",Pe))}),{intersects:r,onClick:U=>C.on(U).off,onDblClick:U=>f.on(U).off,onContextMenu:U=>S.on(U).off,onPointerMove:U=>x.on(U).off,onPointerUp:U=>T.on(U).off,onPointerDown:U=>E.on(U).off,onPointerMissed:U=>k.on(U).off,onWheel:U=>v.on(U).off,forceUpdate:y}};function Xr(n){let e=0;return n.traverse(t=>{if(t.isMesh&&t.geometry){const r=t.geometry,i=r.attributes.position.count*3*Float32Array.BYTES_PER_ELEMENT,s=r.index?r.index.count*Uint32Array.BYTES_PER_ELEMENT:0,o=r.attributes.normal?r.attributes.normal.count*3*Float32Array.BYTES_PER_ELEMENT:0,a=r.attributes.uv?r.attributes.uv.count*2*Float32Array.BYTES_PER_ELEMENT:0,l=i+s+o+a;e+=l}}),e}function yu(n){return(n/1024).toFixed(2)}const jr=W({}),Rr=n=>Object.assign(jr.value,n);function _u(n,e,t=10){const r=he(n)?Al():Tl(_e(()=>he(e).parentElement)),i=$n(Hi(r.width,t)),s=$n(Hi(r.height,t)),o=_e(()=>i.value/s.value);return{height:s,width:i,aspectRatio:o}}function vr(){const n=new Map,e=new Set;let t=0,r=!1;const i=()=>{const o=Array.from(n.entries()).sort((a,l)=>{const p=a[1].priority-l[1].priority;return p===0?a[1].addI-l[1].addI:p});e.clear(),o.forEach(a=>e.add(a[0]))},s=o=>{n.delete(o),e.delete(o)};return{on:(o,a=0)=>{n.set(o,{priority:a,addI:t++});const l=()=>s(o);return Je(l),r=!0,{off:l}},off:s,trigger:(...o)=>{r&&(i(),r=!1),e.forEach(a=>a(...o))},dispose:()=>{n.clear(),e.clear()},get count(){return n.size}}}function xu(){const n=new Yr(!1),e=W(!1),t=W(!1);let r;const i=Nt.generateUUID();let s=null;const o=vr(),a=vr(),l=vr();let p={};function w(E){p=E}function h(E,k,S=0){switch(k){case"before":return o.on(E,S);case"render":return s||(s=E),a.dispose(),a.on(E);case"after":return l.on(E,S)}}function M(){e.value||(n.start(),e.value=!0,T())}function P(){e.value&&(n.stop(),cancelAnimationFrame(r),e.value=!1)}function m(){n.stop(),e.value=!1}function C(){n.start(),e.value=!0}function f(){t.value=!0}function x(){t.value=!1}function T(){const E=n.getDelta(),k=n.getElapsedTime(),S={camera:q(p.camera),scene:q(p.scene),renderer:q(p.renderer),raycaster:q(p.raycaster),controls:q(p.controls),invalidate:p.invalidate,advance:p.advance},v={delta:E,elapsed:k,clock:n,...S};e.value&&o.trigger(v),t.value||(a.count?a.trigger(v):s&&s(v)),e.value&&l.trigger(v),r=requestAnimationFrame(T)}return{loopId:i,register:(E,k,S)=>h(E,k,S),start:M,stop:P,pause:m,resume:C,pauseRender:f,resumeRender:x,isRenderPaused:t,isActive:e,setContext:w}}function Cu({scene:n,canvas:e,windowSize:t,disableRender:r,rendererOptions:i,emit:s}){const{logWarning:o}=tr(),a=lt(n),l=_u(t,e),{camera:p,cameras:w,registerCamera:h,deregisterCamera:M,setCameraActive:P}=tu({sizes:l,scene:n}),m={mode:W(i.renderMode||"always"),priority:W(0),frames:W(0),maxFrames:60,canBeInvalidated:_e(()=>m.mode.value==="on-demand"&&m.frames.value===0)};function C(F=1){i.renderMode==="on-demand"?m.frames.value=Math.min(m.maxFrames,m.frames.value+F):o("`invalidate` can only be used when `renderMode` is set to `on-demand`")}function f(){i.renderMode==="manual"?m.frames.value=1:o("`advance` can only be used when `renderMode` is set to `manual`")}const{renderer:x}=wu({scene:n,canvas:e,options:i,emit:s,contextParts:{sizes:l,camera:p,render:m,invalidate:C,advance:f},disableRender:r}),T={sizes:l,scene:a,camera:p,cameras:$n(w),renderer:x,raycaster:lt(new ba),controls:W(null),perf:{maxFrames:160,fps:{value:0,accumulator:[]},memory:{currentMem:0,allocatedMem:0,accumulator:[]}},render:m,advance:f,extend:Rr,invalidate:C,registerCamera:h,setCameraActive:P,deregisterCamera:M,loop:xu()};Ar("useTres",T),T.scene.value.__tres={root:T},T.loop.register(()=>{p.value&&m.frames.value>0&&(x.value.render(n,p.value),s("render",T.renderer.value)),m.priority.value=0,m.mode.value==="always"?m.frames.value=1:m.frames.value=Math.max(0,m.frames.value-1)},"render"),T.loop.start(),wt(()=>{T.loop.stop()});const E=100,k=Sl({every:E}),{isSupported:S,memory:v}=kl({interval:E}),L=160;let d=performance.now();const b=({timestamp:F})=>{T.scene.value&&(T.perf.memory.allocatedMem=Xr(T.scene.value)),F-d>=E&&(d=F,T.perf.fps.accumulator.push(k.value),T.perf.fps.accumulator.length>L&&T.perf.fps.accumulator.shift(),T.perf.fps.value=k.value,S.value&&v.value&&(T.perf.memory.accumulator.push(v.value.usedJSHeapSize/1024/1024),T.perf.memory.accumulator.length>L&&T.perf.memory.accumulator.shift(),T.perf.memory.currentMem=T.perf.memory.accumulator.reduce((j,z)=>j+z,0)/T.perf.memory.accumulator.length))};let u=0;const y=1,{pause:A}=er(({delta:F})=>{window.__TRES__DEVTOOLS__&&(b({timestamp:performance.now()}),u+=F,u>=y&&(window.__TRES__DEVTOOLS__.cb(T),u=0))},{immediate:!0});return wt(()=>{A()}),T}function Pu(n,e,t){const r=lt(),i=lt();n&&(r.value=n),e&&(i.value=e);const s=_e(()=>r.value?r.value.children:[]);function o(S,v){if(Array.isArray(S))for(const L of S)L(v);typeof S=="function"&&S(v)}function a(S,v){const L=[],d=()=>v.stopPropagating=!0;v.stopPropagation=d;for(const b of v==null?void 0:v.intersections){if(v.stopPropagating)return;v={...v,...b};const{object:u}=b;v.eventObject=u,o(u[S],v),L.push(u);let y=u.parent;for(;y!==null&&!v.stopPropagating&&!L.includes(y);)v.eventObject=y,o(y[S],v),L.push(y),y=y.parent;const A=cu(S.slice(2));t(A,{intersection:b,event:v})}}const{onClick:l,onDblClick:p,onContextMenu:w,onPointerMove:h,onPointerDown:M,onPointerUp:P,onPointerMissed:m,onWheel:C,forceUpdate:f}=bu(s,e);P(S=>a("onPointerUp",S)),M(S=>a("onPointerDown",S)),l(S=>a("onClick",S)),p(S=>a("onDoubleClick",S)),w(S=>a("onContextMenu",S)),C(S=>a("onWheel",S));let x=[];h(S=>{const v=S.intersections.map(({object:d})=>d),L=S.intersections;x.forEach(({object:d})=>{v.includes(d)||(S.intersections=x,a("onPointerLeave",S),a("onPointerOut",S))}),S.intersections=L,S.intersections.forEach(({object:d})=>{x.includes(d)||(a("onPointerEnter",S),a("onPointerOver",S))}),a("onPointerMove",S),x=S.intersections});const T=[];m(S=>{const v=()=>S.stopPropagating=!0;S.stopPropagation=v,T.forEach(L=>{S.stopPropagating||(S.eventObject=L,o(L.onPointerMissed,S))}),t("pointer-missed",{event:S})});function E(S){T.push(S)}function k(S){const v=T.indexOf(S);v>-1&&T.splice(v,1)}return e.eventManager={forceUpdate:f,registerPointerMissedObject:E,deregisterPointerMissedObject:k},{forceUpdate:f,registerPointerMissedObject:E,deregisterPointerMissedObject:k}}const{logError:Wi}=tr(),qi=["onClick","onContextMenu","onPointerMove","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onDoubleClick","onPointerDown","onPointerUp","onPointerCancel","onPointerMissed","onLostPointerCapture","onWheel"];function Zi(n){var e;const t=(e=n==null?void 0:n.__tres)==null?void 0:e.root;t&&t.render&&t.render.canBeInvalidated.value&&t.invalidate()}const Eu=()=>{let n=null;function e(l,p,w,h){if(h||(h={}),h.args||(h.args=[]),l==="template"||lu(l))return null;let M=l.replace("Tres",""),P;if(l==="primitive"){(h==null?void 0:h.object)===void 0&&Wi("Tres primitives need a prop 'object'");const m=h.object;M=m.type,P=Object.assign(m.clone(),{type:M})}else{const m=jr.value[M];m||Wi(`${M} is not defined on the THREE namespace. Use extend to add it to the catalog.`),P=new m(...h.args)}return P?(P.isCamera&&(h!=null&&h.position||P.position.set(3,3,3),h!=null&&h.lookAt||P.lookAt(0,0,0)),(h==null?void 0:h.attach)===void 0&&(P.isMaterial?P.attach="material":P.isBufferGeometry&&(P.attach="geometry")),P.__tres={...P.__tres,type:M,memoizedProps:h,eventCount:0,disposable:!0,primitive:l==="primitive"},P.isObject3D&&P.__tres&&(h!=null&&h.material||h!=null&&h.geometry)&&(P.__tres.disposable=!1),P):null}function t(l,p){var w,h,M,P,m;if(!l)return;p&&p.isScene&&(n=p),n&&l.__tres&&(l.__tres.root=n.__tres.root);const C=p||n;if(l!=null&&l.isObject3D){const{registerCamera:f}=(w=l==null?void 0:l.__tres)==null?void 0:w.root;l!=null&&l.isCamera&&f(l),l.onPointerMissed&&(h=l==null?void 0:l.__tres)!=null&&h.root&&((m=(P=(M=l==null?void 0:l.__tres)==null?void 0:M.root)==null?void 0:P.eventManager)==null||m.registerPointerMissedObject(l))}l!=null&&l.isObject3D&&C!=null&&C.isObject3D?(C.add(l),l.dispatchEvent({type:"added"})):l!=null&&l.isFog?C.fog=l:typeof(l==null?void 0:l.attach)=="string"&&(l.__previousAttach=l[C==null?void 0:C.attach],C&&(C[l.attach]=l))}function r(l){var p,w,h,M;if(!l)return;const P=l.__tres;if(l.parent=l.parent||n,l.isObject3D){const m=C=>{var f,x;const T=(x=(f=l==null?void 0:l.__tres)==null?void 0:f.root)==null?void 0:x.deregisterCamera;C.isCamera&&(T==null||T(C))};(p=l.removeFromParent)==null||p.call(l),l.traverse(C=>{var f,x;m(C),C.onPointerMissed&&((x=(f=P==null?void 0:P.root)==null?void 0:f.eventManager)==null||x.deregisterPointerMissedObject(C))}),m(l),Zi(l),!((w=l.__tres)!=null&&w.primitive)&&(h=l.__tres)!=null&&h.disposable&&Qr(l),(M=l.dispose)==null||M.call(l)}}function i(l,p,w,h){var M,P;if(l){let m=l,C=p;if((M=l==null?void 0:l.__tres)!=null&&M.primitive&&C==="object"&&w!==null){const E=e("primitive",void 0,void 0,{object:h});for(const k in E){if(k==="uuid")continue;const S=l[k],v=E[k];!(S!=null&&S.set)&&!En(S)?l[k]=v:S.constructor===v.constructor&&S!=null&&S.copy?S==null||S.copy(v):Array.isArray(v)?S.set(...v):!S.isColor&&S.setScalar?S.setScalar(v):S.set(v)}E!=null&&E.__tres&&(E.__tres.root=n==null?void 0:n.__tres.root),E!=null&&E.isGroup?(l.geometry=void 0,l.material=void 0):delete l.isGroup}if(l!=null&&l.isObject3D&&C==="blocks-pointer-events"){h||h===""?l[C]=h:delete l[C];return}qi.includes(p)&&(l.__tres.eventCount+=1);let f=Cn(C),x=m==null?void 0:m[f];if(C==="args"){const E=l,k=w??[],S=h??[],v=((P=l==null?void 0:l.__tres)==null?void 0:P.type)||l.type;v&&k.length&&!hu(k,S)&&(m=Object.assign(E,new jr.value[v](...h)));return}if(m.type==="BufferGeometry"){if(C==="args")return;m.setAttribute(Cn(C),new At(...h));return}if(C.includes("-")&&x===void 0){const E=C.split("-");x=E.reduce((k,S)=>k[Cn(S)],m),C=E.pop(),f=C,x!=null&&x.set||(m=E.reduce((k,S)=>k[Cn(S)],m))}let T=h;if(T===""&&(T=!0),En(x)){qi.includes(p)||(Array.isArray(T)?l[f](...T):l[f](T)),f.startsWith("on")&&En(T)&&(m[f]=T);return}!(x!=null&&x.set)&&!En(x)?m[f]=T:x.constructor===T.constructor&&x!=null&&x.copy?x==null||x.copy(T):Array.isArray(T)?x.set(...T):!x.isColor&&x.setScalar?x.setScalar(T):x.set(T),Zi(l)}}function s(l){return(l==null?void 0:l.parent)||null}function o(l){const p=new Pa;return p.name=l,p.__tres={type:"Comment"},p.__tres.root=n==null?void 0:n.__tres.root,p}function a(l){if(!l)return null;const p=l.parent||n,w=p.children.indexOf(l);return p.children[w+1]||null}return{insert:t,remove:r,createElement:e,patchProp:i,parentNode:s,createText:()=>{},createComment:o,setText:()=>{},setElementText:()=>{},nextSibling:a,querySelector:()=>{},setScopeId:()=>{},cloneNode:()=>{},insertStaticContent:()=>{}}};function Mu(){return no().__VUE_DEVTOOLS_GLOBAL_HOOK__}function no(){return typeof navigator<"u"&&typeof window<"u"?window:typeof globalThis<"u"?globalThis:{}}const Tu=typeof Proxy=="function",Su="devtools-plugin:setup",ku="plugin:settings:set";let Yt,Nr;function Lu(){var n;return Yt!==void 0||(typeof window<"u"&&window.performance?(Yt=!0,Nr=window.performance):typeof globalThis<"u"&&!((n=globalThis.perf_hooks)===null||n===void 0)&&n.performance?(Yt=!0,Nr=globalThis.perf_hooks.performance):Yt=!1),Yt}function Iu(){return Lu()?Nr.now():Date.now()}let Au=class{constructor(e,t){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=e,this.hook=t;const r={};if(e.settings)for(const o in e.settings){const a=e.settings[o];r[o]=a.defaultValue}const i=`__vue-devtools-plugin-settings__${e.id}`;let s=Object.assign({},r);try{const o=localStorage.getItem(i),a=JSON.parse(o);Object.assign(s,a)}catch{}this.fallbacks={getSettings(){return s},setSettings(o){try{localStorage.setItem(i,JSON.stringify(o))}catch{}s=o},now(){return Iu()}},t&&t.on(ku,(o,a)=>{o===this.plugin.id&&this.fallbacks.setSettings(a)}),this.proxiedOn=new Proxy({},{get:(o,a)=>this.target?this.target.on[a]:(...l)=>{this.onQueue.push({method:a,args:l})}}),this.proxiedTarget=new Proxy({},{get:(o,a)=>this.target?this.target[a]:a==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(a)?(...l)=>(this.targetQueue.push({method:a,args:l,resolve:()=>{}}),this.fallbacks[a](...l)):(...l)=>new Promise(p=>{this.targetQueue.push({method:a,args:l,resolve:p})})})}async setRealTarget(e){this.target=e;for(const t of this.onQueue)this.target.on[t.method](...t.args);for(const t of this.targetQueue)t.resolve(await this.target[t.method](...t.args))}};function Ou(n,e){const t=n,r=no(),i=Mu(),s=Tu&&t.enableEarlyProxy;if(i&&(r.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!s))i.emit(Su,n,e);else{const o=s?new Au(t,i):null;(r.__VUE_DEVTOOLS_PLUGINS__=r.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:t,setupFn:e,proxy:o}),o&&e(o.proxiedTarget)}}function Vu(n,e){const t=`▲ ■ ●${n}`;typeof Ji=="function"?Ji(t,e):console.log(t)}function Ji(n,e){throw new Error(n+e)}const ro=n=>{const e={id:n.uuid,label:n.type,children:[],tags:[]};n.name!==""&&e.tags.push({label:n.name,textColor:5750629,backgroundColor:15793395});const t=Xr(n);return t>0&&e.tags.push({label:`${yu(t)} KB`,textColor:15707189,backgroundColor:16775644,tooltip:"Memory usage"}),n.type.includes("Light")&&(e.tags.push({label:`${n.intensity}`,textColor:9738662,backgroundColor:16316922,tooltip:"Intensity"}),e.tags.push({label:`#${n.color.getHexString()}`,textColor:9738662,backgroundColor:16316922,tooltip:"Color"})),n.type.includes("Camera")&&(e.tags.push({label:`${n.fov}°`,textColor:9738662,backgroundColor:16316922,tooltip:"Field of view"}),e.tags.push({label:`x: ${Math.round(n.position.x)} y: ${Math.round(n.position.y)} z: ${Math.round(n.position.z)}`,textColor:9738662,backgroundColor:16316922,tooltip:"Position"})),e};function io(n,e,t=""){n.children.forEach(r=>{if(r.type==="HightlightMesh"||t&&!r.type.includes(t)&&!r.name.includes(t))return;const i=ro(r);e.children.push(i),io(r,i,t)})}const ju=[],Wt="tres:inspector",Ru=Ks({sceneGraph:null});function Nu(n,e){Ou({id:"dev.esm.tres",label:"TresJS 🪐",logo:"https://raw.githubusercontent.com/Tresjs/tres/main/public/favicon.svg",packageName:"tresjs",homepage:"https://tresjs.org",componentStateTypes:ju,app:n},t=>{typeof t.now!="function"&&Vu("You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html."),t.addInspector({id:Wt,label:"TresJS 🪐",icon:"account_tree",treeFilterPlaceholder:"Search instances"}),setInterval(()=>{t.sendInspectorTree(Wt)},1e3),setInterval(()=>{t.notifyComponentUpdate()},5e3),t.on.getInspectorTree(s=>{if(s.inspectorId===Wt){const o=ro(e.scene.value);io(e.scene.value,o,s.filter),Ru.sceneGraph=o,s.rootNodes=[o]}});let r=null,i=null;t.on.getInspectorState(s=>{var o;if(s.inspectorId===Wt){const[a]=e.scene.value.getObjectsByProperty("uuid",s.nodeId);if(!a)return;if(i&&r&&r.parent&&i.remove(r),a.isMesh){const l=fu(a);a.add(l),r=l,i=a}s.state={object:[{key:"uuid",editable:!0,value:a.uuid},{key:"name",editable:!0,value:a.name},{key:"type",editable:!0,value:a.type},{key:"position",editable:!0,value:a.position},{key:"rotation",editable:!0,value:a.rotation},{key:"scale",editable:!0,value:a.scale},{key:"geometry",value:a.geometry},{key:"material",value:a.material},{key:"color",editable:!0,value:a.color},{key:"intensity",editable:!0,value:a.intensity},{key:"castShadow",editable:!0,value:a.castShadow},{key:"receiveShadow",editable:!0,value:a.receiveShadow},{key:"frustumCulled",editable:!0,value:a.frustumCulled},{key:"matrixAutoUpdate",editable:!0,value:a.matrixAutoUpdate},{key:"matrixWorldNeedsUpdate",editable:!0,value:a.matrixWorldNeedsUpdate},{key:"matrixWorld",value:a.matrixWorld},{key:"visible",editable:!0,value:a.visible}]},a.isScene&&(s.state.info={memory:Xr(a),objects:a.children.length,calls:e.renderer.value.info.render.calls,triangles:e.renderer.value.info.render.triangles,points:e.renderer.value.info.render.points,lines:e.renderer.value.info.render.lines},s.state.programs=((o=e.renderer.value.info.programs)==null?void 0:o.map(l=>({key:l.name,value:{...l,vertexShader:l.vertexShader,attributes:l.getAttributes(),uniforms:l.getUniforms()}})))||[])}}),t.on.editInspectorState(s=>{s.inspectorId===Wt&&mu(e.scene.value,s.nodeId,s.path,s.state.value)})})}const Du=["data-scene","data-tres"],Bu=Dt({__name:"TresCanvas",props:{shadows:{type:Boolean,default:void 0},clearColor:{},toneMapping:{},shadowMapType:{},useLegacyLights:{type:Boolean,default:void 0},outputColorSpace:{},toneMappingExposure:{},renderMode:{default:"always"},camera:{},preset:{},windowSize:{type:Boolean,default:void 0},disableRender:{type:Boolean,default:void 0},context:{},precision:{},alpha:{type:Boolean,default:void 0},premultipliedAlpha:{type:Boolean},antialias:{type:Boolean,default:void 0},stencil:{type:Boolean,default:void 0},preserveDrawingBuffer:{type:Boolean,default:void 0},powerPreference:{},depth:{type:Boolean,default:void 0},logarithmicDepthBuffer:{type:Boolean,default:void 0},failIfMajorPerformanceCaveat:{type:Boolean,default:void 0}},emits:["render","click","double-click","context-menu","pointer-move","pointer-up","pointer-down","pointer-enter","pointer-leave","pointer-over","pointer-out","pointer-missed","wheel"],setup(n,{expose:e,emit:t}){var r;const i=n,s=t,o=Ys(),{logWarning:a}=tr(),l=W(),p=lt(new rn),w=(r=Hn())==null?void 0:r.appContext.app;Rr(js);const h=f=>Dt({setup(){var x;const T=(x=Hn())==null?void 0:x.appContext;return T&&(T.app=w),Ar("useTres",f),Ar("extend",Rr),typeof window<"u"&&Nu(T==null?void 0:T.app,f),()=>Ui(rl,null,o!=null&&o.default?o.default():[])}}),M=f=>{const x=h(f),{render:T}=Ws(Eu());T(Ui(x),p.value)},P=(f,x=!1)=>{Qr(f.scene.value),x&&(f.renderer.value.dispose(),f.renderer.value.renderLists.dispose(),f.renderer.value.forceContextLoss()),p.value.__tres={root:f},M(f)},m=_e(()=>i.disableRender),C=lt(null);return e({context:C,dispose:()=>P(C.value,!0)}),Zr(()=>{const f=l;C.value=Cu({scene:p.value,canvas:f,windowSize:i.windowSize??!1,disableRender:m.value??!1,rendererOptions:i,emit:s}),Pu(p.value,C.value,s);const{registerCamera:x,camera:T,cameras:E,deregisterCamera:k}=C.value;M(C.value);const S=()=>{const v=new Ke(45,window.innerWidth/window.innerHeight,.1,1e3);v.position.set(3,3,3),v.lookAt(0,0,0),x(v);const L=Ut(()=>{E.value.length>=2&&(v.removeFromParent(),k(v),L==null||L())})};Me(()=>i.camera,(v,L)=>{v&&x(v),L&&(L.removeFromParent(),k(L))},{immediate:!0}),T.value||(a("No camera found. Creating a default perspective camera. To have full control over a camera, please add one to the scene."),S())}),wt(()=>{P(C.value)}),(f,x)=>(Ge(),st("canvas",{ref_key:"canvas",ref:l,"data-scene":p.value.uuid,class:tl(f.$attrs.class),"data-tres":`tresjs ${q(eu).version}`,style:nl({display:"block",width:"100%",height:"100%",position:f.windowSize?"fixed":"relative",top:0,left:0,pointerEvents:"auto",touchAction:"none",...f.$attrs.style})},null,14,Du))}}),so=Oe(),oo=Oe(),ei=Oe(),nn=new Yr;let Nn=0,Dn=0;const{pause:Fu,resume:Uu,isActive:zu}=er(()=>{so.trigger({delta:Nn,elapsed:Dn,clock:nn}),oo.trigger({delta:Nn,elapsed:Dn,clock:nn}),ei.trigger({delta:Nn,elapsed:Dn,clock:nn})},{immediate:!1});ei.on(()=>{Nn=nn.getDelta(),Dn=nn.getElapsedTime()});const ao=()=>({onBeforeLoop:so.on,onLoop:oo.on,onAfterLoop:ei.on,pause:Fu,resume:Uu,isActive:zu}),Mn="[TresJS ▲ ■ ●] ";function Hu(){function n(...r){typeof r[0]=="string"?r[0]=Mn+r[0]:r.unshift(Mn),console.error(...r)}function e(...r){typeof r[0]=="string"?r[0]=Mn+r[0]:r.unshift(Mn),console.warn(...r)}function t(r,i){}return{logError:n,logWarning:e,logMessage:t}}const $u="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,hgroup,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",Gu=Ku($u);function Qi(n){return n&&n.nodeType===1}function Tn(n){return n.replace(/-([a-z])/g,(e,t)=>t.toUpperCase())}function Ku(n,e){const t=Object.create(null),r=n.split(",");for(let i=0;i<r.length;i++)t[r[i]]=!0;return i=>!!t[i]}function lo(n,e){if(Qi(n)&&Qi(e)){const i=n.attributes,s=e.attributes;return i.length!==s.length?!1:Array.from(i).every(({name:o,value:a})=>e.getAttribute(o)===a)}if(n===e)return!0;if(n===null||typeof n!="object"||e===null||typeof e!="object")return!1;const t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(const i of t)if(!r.includes(i)||!lo(n[i],e[i]))return!1;return!0}function Yu(n,e){if(!Array.isArray(n)||!Array.isArray(e)||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!lo(n[t],e[t]))return!1;return!0}const Xi=n=>typeof n=="function",Dr=W({}),Wu=n=>Object.assign(Dr.value,n);function ti(){const n=il("useTres");if(!n)throw new Error("useTresContext must be used together with useTresContextProvider");return n}let ve=null;const{logError:es}=Hu(),gr=["onClick","onPointerMove","onPointerEnter","onPointerLeave"],qu={createElement(n,e,t,r){var i,s;if(r||(r={}),r.args||(r.args=[]),n==="template"||Gu(n))return null;let o=n.replace("Tres",""),a;if(n==="primitive"){(r==null?void 0:r.object)===void 0&&es("Tres primitives need a prop 'object'");const l=r.object;o=l.type,a=Object.assign(l,{type:o,attach:r.attach,primitive:!0})}else{const l=Dr.value[o];l||es(`${o} is not defined on the THREE namespace. Use extend to add it to the catalog.`),a=new l(...r.args)}return a.isCamera&&(r!=null&&r.position||a.position.set(3,3,3),r!=null&&r.lookAt||a.lookAt(0,0,0)),(r==null?void 0:r.attach)===void 0&&(a.isMaterial?a.attach="material":a.isBufferGeometry&&(a.attach="geometry")),a.isObject3D&&((i=r==null?void 0:r.material)!=null&&i.isMaterial&&(a.userData.tres__materialViaProp=!0),(s=r==null?void 0:r.geometry)!=null&&s.isBufferGeometry&&(a.userData.tres__geometryViaProp=!0)),a.userData={...a.userData,tres__name:o},a},insert(n,e){var t,r,i,s;e&&e.isScene&&(ve=e);const o=e||ve;if(n!=null&&n.isObject3D){if(n!=null&&n.isCamera){if(!(ve!=null&&ve.userData.tres__registerCamera))throw new Error("could not find tres__registerCamera on scene's userData");(r=ve==null?void 0:(t=ve.userData).tres__registerCamera)==null||r.call(t,n)}if(n&&gr.some(a=>n[a])){if(!(ve!=null&&ve.userData.tres__registerAtPointerEventHandler))throw new Error("could not find tres__registerAtPointerEventHandler on scene's userData");(s=ve==null?void 0:(i=ve.userData).tres__registerAtPointerEventHandler)==null||s.call(i,n)}}n!=null&&n.isObject3D&&o!=null&&o.isObject3D?(o.add(n),n.dispatchEvent({type:"added"})):n!=null&&n.isFog?o.fog=n:typeof(n==null?void 0:n.attach)=="string"&&(n.__previousAttach=n[o==null?void 0:o.attach],o&&(o[n.attach]=n))},remove(n){var e,t;if(n){if(n.isObject3D){const r=n,i=p=>{var w,h;const M=p;p.userData.tres__materialViaProp||((w=M.material)==null||w.dispose(),M.material=void 0),p.userData.tres__geometryViaProp||((h=M.geometry)==null||h.dispose(),M.geometry=void 0)},s=ve==null?void 0:ve.userData.tres__deregisterAtPointerEventHandler,o=ve==null?void 0:ve.userData.tres__deregisterBlockingObjectAtPointerEventHandler,a=p=>{var w,h;if(!o)throw new Error("could not find tres__deregisterBlockingObjectAtPointerEventHandler on scene's userData");if((h=ve==null?void 0:(w=ve.userData).tres__deregisterBlockingObjectAtPointerEventHandler)==null||h.call(w,p),!s)throw new Error("could not find tres__deregisterAtPointerEventHandler on scene's userData");p&&gr.some(M=>p[M])&&(s==null||s(p))},l=p=>{const w=ve==null?void 0:ve.userData.tres__deregisterCamera;if(!w)throw new Error("could not find tres__deregisterCamera on scene's userData");p.isCamera&&(w==null||w(p))};(e=n.removeFromParent)==null||e.call(n),r.traverse(p=>{i(p),l(p),a==null||a(p)}),i(r),l(r),a==null||a(r)}(t=n.dispose)==null||t.call(n)}},patchProp(n,e,t,r){var i,s,o,a;if(n){let l=n,p=e;if(n.isObject3D&&p==="blocks-pointer-events"){r||r===""?(s=ve==null?void 0:(i=ve.userData).tres__registerBlockingObjectAtPointerEventHandler)==null||s.call(i,n):(a=ve==null?void 0:(o=ve.userData).tres__deregisterBlockingObjectAtPointerEventHandler)==null||a.call(o,n);return}let w=Tn(p),h=l==null?void 0:l[w];if(p==="args"){const P=n,m=t??[],C=r??[],f=n.userData.tres__name||n.type;f&&m.length&&!Yu(m,C)&&(l=Object.assign(P,new Dr.value[f](...r)));return}if(l.type==="BufferGeometry"){if(p==="args")return;l.setAttribute(Tn(p),new At(...r));return}if(p.includes("-")&&h===void 0){const P=p.split("-");h=P.reduce((m,C)=>m[Tn(C)],l),p=P.pop(),w=p.toLowerCase(),h!=null&&h.set||(l=P.reduce((m,C)=>m[Tn(C)],l))}let M=r;if(M===""&&(M=!0),Xi(h)){gr.includes(e)||(Array.isArray(M)?n[w](...M):n[w](M));return}!(h!=null&&h.set)&&!Xi(h)?l[w]=M:h.constructor===M.constructor&&h!=null&&h.copy?h==null||h.copy(M):Array.isArray(M)?h.set(...M):!h.isColor&&h.setScalar?h.setScalar(M):h.set(M)}},parentNode(n){return(n==null?void 0:n.parent)||null},createText:()=>{},createComment:()=>{},setText:()=>{},setElementText:()=>{},nextSibling:()=>{},querySelector:()=>{},setScopeId:()=>{},cloneNode:()=>{},insertStaticContent:()=>{}};Ws(qu);Wu(js);Ks({sceneGraph:null});/*! Tweakpane 4.0.3 (c) 2016 cocopon, licensed under the MIT license. */function fe(n){return n==null}function ni(n){return n!==null&&typeof n=="object"}function Br(n){return n!==null&&typeof n=="object"}function Zu(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Pt(n,e){return Array.from(new Set([...Object.keys(n),...Object.keys(e)])).reduce((r,i)=>{const s=n[i],o=e[i];return Br(s)&&Br(o)?Object.assign(Object.assign({},r),{[i]:Pt(s,o)}):Object.assign(Object.assign({},r),{[i]:i in e?o:s})},{})}function Ju(n){return ni(n)?"target"in n:!1}const Qu={alreadydisposed:()=>"View has been already disposed",invalidparams:n=>`Invalid parameters for '${n.name}'`,nomatchingcontroller:n=>`No matching controller for '${n.key}'`,nomatchingview:n=>`No matching view for '${JSON.stringify(n.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:n=>`Not compatible with  plugin '${n.id}'`,propertynotfound:n=>`Property '${n.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class Ne{static alreadyDisposed(){return new Ne({type:"alreadydisposed"})}static notBindable(){return new Ne({type:"notbindable"})}static notCompatible(e,t){return new Ne({type:"notcompatible",context:{id:`${e}.${t}`}})}static propertyNotFound(e){return new Ne({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new Ne({type:"shouldneverhappen"})}constructor(e){var t;this.message=(t=Qu[e.type](e.context))!==null&&t!==void 0?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}}class Gn{constructor(e,t){this.obj_=e,this.key=t}static isBindable(e){return!(e===null||typeof e!="object"&&typeof e!="function")}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,t){const r=this.read();if(!Gn.isBindable(r))throw Ne.notBindable();if(!(e in r))throw Ne.propertyNotFound(e);r[e]=t}}class Be{constructor(){this.observers_={}}on(e,t,r){var i;let s=this.observers_[e];return s||(s=this.observers_[e]=[]),s.push({handler:t,key:(i=r==null?void 0:r.key)!==null&&i!==void 0?i:t}),this}off(e,t){const r=this.observers_[e];return r&&(this.observers_[e]=r.filter(i=>i.key!==t)),this}emit(e,t){const r=this.observers_[e];r&&r.forEach(i=>{i.handler(t)})}}class Xu{constructor(e,t){var r;this.constraint_=t==null?void 0:t.constraint,this.equals_=(r=t==null?void 0:t.equals)!==null&&r!==void 0?r:(i,s)=>i===s,this.emitter=new Be,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const r=t??{forceEmit:!1,last:!0},i=this.constraint_?this.constraint_.constrain(e):e,s=this.rawValue_;this.equals_(s,i)&&!r.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=i,this.emitter.emit("change",{options:r,previousRawValue:s,rawValue:i,sender:this}))}}class ec{constructor(e){this.emitter=new Be,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const r=t??{forceEmit:!1,last:!0},i=this.value_;i===e&&!r.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:r,previousRawValue:i,rawValue:this.value_,sender:this}))}}class tc{constructor(e){this.emitter=new Be,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}function Ce(n,e){const t=e==null?void 0:e.constraint,r=e==null?void 0:e.equals;return!t&&!r?new ec(n):new Xu(n,e)}function nc(n){return[new tc(n),(e,t)=>{n.setRawValue(e,t)}]}class re{constructor(e){this.emitter=new Be,this.valMap_=e;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",()=>{this.emitter.emit("change",{key:t,sender:this})})}static createCore(e){return Object.keys(e).reduce((r,i)=>Object.assign(r,{[i]:Ce(e[i])}),{})}static fromObject(e){const t=this.createCore(e);return new re(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}}class nr{constructor(e){this.values=re.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),r=this.values.get("min");return Math.min(Math.max(e,r),t)}}class rc{constructor(e){this.values=re.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),r=this.values.get("min");let i=e;return fe(r)||(i=Math.max(i,r)),fe(t)||(i=Math.min(i,t)),i}}class ic{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step,r=Math.round((e-t)/this.step);return t+r*this.step}}class sc{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}}const oc={"**":(n,e)=>Math.pow(n,e),"*":(n,e)=>n*e,"/":(n,e)=>n/e,"%":(n,e)=>n%e,"+":(n,e)=>n+e,"-":(n,e)=>n-e,"<<":(n,e)=>n<<e,">>":(n,e)=>n>>e,">>>":(n,e)=>n>>>e,"&":(n,e)=>n&e,"^":(n,e)=>n^e,"|":(n,e)=>n|e};class ac{constructor(e,t,r){this.left=t,this.operator=e,this.right=r}evaluate(){const e=oc[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const lc={"+":n=>n,"-":n=>-n,"~":n=>~n};class uc{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=lc[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function ri(n){return(e,t)=>{for(let r=0;r<n.length;r++){const i=n[r](e,t);if(i!=="")return i}return""}}function an(n,e){var t;const r=n.substr(e).match(/^\s+/);return(t=r&&r[0])!==null&&t!==void 0?t:""}function cc(n,e){const t=n.substr(e,1);return t.match(/^[1-9]$/)?t:""}function ln(n,e){var t;const r=n.substr(e).match(/^[0-9]+/);return(t=r&&r[0])!==null&&t!==void 0?t:""}function dc(n,e){const t=ln(n,e);if(t!=="")return t;const r=n.substr(e,1);if(e+=1,r!=="-"&&r!=="+")return"";const i=ln(n,e);return i===""?"":r+i}function ii(n,e){const t=n.substr(e,1);if(e+=1,t.toLowerCase()!=="e")return"";const r=dc(n,e);return r===""?"":t+r}function uo(n,e){const t=n.substr(e,1);if(t==="0")return t;const r=cc(n,e);return e+=r.length,r===""?"":r+ln(n,e)}function pc(n,e){const t=uo(n,e);if(e+=t.length,t==="")return"";const r=n.substr(e,1);if(e+=r.length,r!==".")return"";const i=ln(n,e);return e+=i.length,t+r+i+ii(n,e)}function hc(n,e){const t=n.substr(e,1);if(e+=t.length,t!==".")return"";const r=ln(n,e);return e+=r.length,r===""?"":t+r+ii(n,e)}function mc(n,e){const t=uo(n,e);return e+=t.length,t===""?"":t+ii(n,e)}const fc=ri([pc,hc,mc]);function vc(n,e){var t;const r=n.substr(e).match(/^[01]+/);return(t=r&&r[0])!==null&&t!==void 0?t:""}function gc(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0b")return"";const r=vc(n,e);return r===""?"":t+r}function wc(n,e){var t;const r=n.substr(e).match(/^[0-7]+/);return(t=r&&r[0])!==null&&t!==void 0?t:""}function bc(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0o")return"";const r=wc(n,e);return r===""?"":t+r}function yc(n,e){var t;const r=n.substr(e).match(/^[0-9a-f]+/i);return(t=r&&r[0])!==null&&t!==void 0?t:""}function _c(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0x")return"";const r=yc(n,e);return r===""?"":t+r}const xc=ri([gc,bc,_c]),Cc=ri([xc,fc]);function Pc(n,e){const t=Cc(n,e);return e+=t.length,t===""?null:{evaluable:new sc(t),cursor:e}}function Ec(n,e){const t=n.substr(e,1);if(e+=t.length,t!=="(")return null;const r=po(n,e);if(!r)return null;e=r.cursor,e+=an(n,e).length;const i=n.substr(e,1);return e+=i.length,i!==")"?null:{evaluable:r.evaluable,cursor:e}}function Mc(n,e){var t;return(t=Pc(n,e))!==null&&t!==void 0?t:Ec(n,e)}function co(n,e){const t=Mc(n,e);if(t)return t;const r=n.substr(e,1);if(e+=r.length,r!=="+"&&r!=="-"&&r!=="~")return null;const i=co(n,e);return i?(e=i.cursor,{cursor:e,evaluable:new uc(r,i.evaluable)}):null}function Tc(n,e,t){t+=an(e,t).length;const r=n.filter(i=>e.startsWith(i,t))[0];return r?(t+=r.length,t+=an(e,t).length,{cursor:t,operator:r}):null}function Sc(n,e){return(t,r)=>{const i=n(t,r);if(!i)return null;r=i.cursor;let s=i.evaluable;for(;;){const o=Tc(e,t,r);if(!o)break;r=o.cursor;const a=n(t,r);if(!a)return null;r=a.cursor,s=new ac(o.operator,s,a.evaluable)}return s?{cursor:r,evaluable:s}:null}}const kc=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((n,e)=>Sc(n,e),co);function po(n,e){return e+=an(n,e).length,kc(n,e)}function Lc(n){const e=po(n,0);return!e||e.cursor+an(n,e.cursor).length!==n.length?null:e.evaluable}function bt(n){var e;const t=Lc(n);return(e=t==null?void 0:t.evaluate())!==null&&e!==void 0?e:null}function ho(n){if(typeof n=="number")return n;if(typeof n=="string"){const e=bt(n);if(!fe(e))return e}return 0}function je(n){return e=>e.toFixed(Math.max(Math.min(n,20),0))}function ae(n,e,t,r,i){const s=(n-e)/(t-e);return r+s*(i-r)}function ts(n){return String(n.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function xe(n,e,t){return Math.min(Math.max(n,e),t)}function mo(n,e){return(n%e+e)%e}function Ic(n,e){return fe(n.step)?Math.max(ts(e),2):ts(n.step)}function fo(n){var e;return(e=n.step)!==null&&e!==void 0?e:1}function Ac(n,e){var t;const r=Math.abs((t=n.step)!==null&&t!==void 0?t:e);return r===0?.1:Math.pow(10,Math.floor(Math.log10(r))-1)}function vo(n,e){return fe(n.step)?null:new ic(n.step,e)}function go(n){return!fe(n.max)&&!fe(n.min)?new nr({max:n.max,min:n.min}):!fe(n.max)||!fe(n.min)?new rc({max:n.max,min:n.min}):null}function wo(n,e){var t,r,i;return{formatter:(t=n.format)!==null&&t!==void 0?t:je(Ic(n,e)),keyScale:(r=n.keyScale)!==null&&r!==void 0?r:fo(n),pointerScale:(i=n.pointerScale)!==null&&i!==void 0?i:Ac(n,e)}}function bo(n){return{format:n.optional.function,keyScale:n.optional.number,max:n.optional.number,min:n.optional.number,pointerScale:n.optional.number,step:n.optional.number}}function si(n){return{constraint:n.constraint,textProps:re.fromObject(wo(n.params,n.initialValue))}}class oi{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}}class rr{constructor(e){this.target=e}}class yo extends rr{constructor(e,t,r){super(e),this.value=t,this.last=r??!0}}class Oc extends rr{constructor(e,t){super(e),this.expanded=t}}class Vc extends rr{constructor(e,t){super(e),this.index=t}}class jc extends rr{constructor(e,t){super(e),this.native=t}}class ai extends oi{constructor(e){super(e),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new Be,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,t){const r=t.bind(this);return this.emitter_.on(e,i=>{r(i)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const t=this.controller.value;this.emitter_.emit("change",new yo(this,t.binding.target.read(),e.options.last))}}function Rc(n,e){const r=Object.keys(e).reduce((i,s)=>{if(i===void 0)return;const o=e[s],a=o(n[s]);return a.succeeded?Object.assign(Object.assign({},i),{[s]:a.value}):void 0},{});return r}function Nc(n,e){return n.reduce((t,r)=>{if(t===void 0)return;const i=e(r);if(!(!i.succeeded||i.value===void 0))return[...t,i.value]},[])}function Dc(n){return n===null?!1:typeof n=="object"}function it(n){return e=>t=>{if(!e&&t===void 0)return{succeeded:!1,value:void 0};if(e&&t===void 0)return{succeeded:!0,value:void 0};const r=n(t);return r!==void 0?{succeeded:!0,value:r}:{succeeded:!1,value:void 0}}}function ns(n){return{custom:e=>it(e)(n),boolean:it(e=>typeof e=="boolean"?e:void 0)(n),number:it(e=>typeof e=="number"?e:void 0)(n),string:it(e=>typeof e=="string"?e:void 0)(n),function:it(e=>typeof e=="function"?e:void 0)(n),constant:e=>it(t=>t===e?e:void 0)(n),raw:it(e=>e)(n),object:e=>it(t=>{if(Dc(t))return Rc(t,e)})(n),array:e=>it(t=>{if(Array.isArray(t))return Nc(t,e)})(n)}}const Fr={optional:ns(!0),required:ns(!1)};function Te(n,e){const t=e(Fr),r=Fr.required.object(t)(n);return r.succeeded?r.value:void 0}function et(n,e,t,r){if(e&&!e(n))return!1;const i=Te(n,t);return i?r(i):!1}function tt(n,e){var t;return Pt((t=n==null?void 0:n())!==null&&t!==void 0?t:{},e)}function Bn(n){return"value"in n}function Bc(n){if(!ni(n)||!("binding"in n))return!1;const e=n.binding;return Ju(e)}const qe="http://www.w3.org/2000/svg";function Kn(n){n.offsetHeight}function Fc(n,e){const t=n.style.transition;n.style.transition="none",e(),n.style.transition=t}function li(n){return n.ontouchstart!==void 0}function Uc(n){const e=n.ownerDocument.defaultView;return e&&"document"in e?n.getContext("2d",{willReadFrequently:!0}):null}const zc={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function ir(n,e){const t=n.createElementNS(qe,"svg");return t.innerHTML=zc[e],t}function _o(n,e,t){n.insertBefore(e,n.children[t])}function ui(n){n.parentElement&&n.parentElement.removeChild(n)}function xo(n){for(;n.children.length>0;)n.removeChild(n.children[0])}function Hc(n){for(;n.childNodes.length>0;)n.removeChild(n.childNodes[0])}function Co(n){return n.relatedTarget?n.relatedTarget:"explicitOriginalTarget"in n?n.explicitOriginalTarget:null}function at(n,e){n.emitter.on("change",t=>{e(t.rawValue)}),e(n.rawValue)}function Qe(n,e,t){at(n.value(e),t)}const $c="tp";function ie(n){return(t,r)=>[$c,"-",n,"v",t?`_${t}`:"",r?`-${r}`:""].join("")}const qt=ie("lbl");function Gc(n,e){const t=n.createDocumentFragment();return e.split(`
`).map(i=>n.createTextNode(i)).forEach((i,s)=>{s>0&&t.appendChild(n.createElement("br")),t.appendChild(i)}),t}class Kc{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(qt()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("div");r.classList.add(qt("l")),Qe(t.props,"label",s=>{fe(s)?this.element.classList.add(qt(void 0,"nol")):(this.element.classList.remove(qt(void 0,"nol")),Hc(r),r.appendChild(Gc(e,s)))}),this.element.appendChild(r),this.labelElement=r;const i=e.createElement("div");i.classList.add(qt("v")),this.element.appendChild(i),this.valueElement=i}}class Yc{constructor(e,t){this.props=t.props,this.valueController=t.valueController,this.viewProps=t.valueController.viewProps,this.view=new Kc(e,{props:t.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return et(e,null,t=>({label:t.optional.string}),t=>(this.props.set("label",t.label),!0))}exportProps(){return tt(null,{label:this.props.get("label")})}}function Wc(){return["veryfirst","first","last","verylast"]}const rs=ie(""),is={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class Po{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",()=>{Wc().forEach(r=>{t.classList.remove(rs(void 0,is[r]))}),this.blade.get("positions").forEach(r=>{t.classList.add(rs(void 0,is[r]))})}),this.viewProps.handleDispose(()=>{ui(t)})}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return et(e,null,t=>({disabled:t.required.boolean,hidden:t.required.boolean}),t=>(this.viewProps.importState(t),!0))}exportState(){return tt(null,Object.assign({},this.viewProps.exportState()))}}class qc extends oi{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return(e=this.controller.buttonController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,t){const r=t.bind(this);return this.controller.buttonController.emitter.on(e,s=>{r(new jc(this,s.nativeEvent))}),this}off(e,t){return this.controller.buttonController.emitter.off(e,t),this}}function Zc(n,e,t){t?n.classList.add(e):n.classList.remove(e)}function zt(n,e){return t=>{Zc(n,e,t)}}function ci(n,e){at(n,t=>{e.textContent=t??""})}const wr=ie("btn");class Jc{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(wr()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("button");r.classList.add(wr("b")),t.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;const i=e.createElement("div");i.classList.add(wr("t")),ci(t.props.value("title"),i),this.buttonElement.appendChild(i)}}class Qc{constructor(e,t){this.emitter=new Be,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new Jc(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return et(e,null,t=>({title:t.optional.string}),t=>(this.props.set("title",t.title),!0))}exportProps(){return tt(null,{title:this.props.get("title")})}onClick_(e){this.emitter.emit("click",{nativeEvent:e,sender:this})}}class ss extends Po{constructor(e,t){const r=new Qc(e,{props:t.buttonProps,viewProps:t.viewProps}),i=new Yc(e,{blade:t.blade,props:t.labelProps,valueController:r});super({blade:t.blade,view:i.view,viewProps:t.viewProps}),this.buttonController=r,this.labelController=i}importState(e){return et(e,t=>super.importState(t)&&this.buttonController.importProps(t)&&this.labelController.importProps(t),()=>({}),()=>!0)}exportState(){return tt(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}}class Eo{constructor(e){const[t,r]=e.split("-"),i=t.split(".");this.major=parseInt(i[0],10),this.minor=parseInt(i[1],10),this.patch=parseInt(i[2],10),this.prerelease=r??null}toString(){const e=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[e,this.prerelease].join("-"):e}}const Xc=new Eo("2.0.3");function ke(n){return Object.assign({core:Xc},n)}ke({id:"button",type:"blade",accept(n){const e=Te(n,t=>({title:t.required.string,view:t.required.constant("button"),label:t.optional.string}));return e?{params:e}:null},controller(n){return new ss(n.document,{blade:n.blade,buttonProps:re.fromObject({title:n.params.title}),labelProps:re.fromObject({label:n.params.label}),viewProps:n.viewProps})},api(n){return n.controller instanceof ss?new qc(n.controller):null}});function ed(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function td(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function nd(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}function rd(n){return ni(n)?"refresh"in n&&typeof n.refresh=="function":!1}function id(n,e){if(!Gn.isBindable(n))throw Ne.notBindable();return new Gn(n,e)}class sd{constructor(e,t){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new Be,this.pool_=t,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(e=>this.pool_.createApi(e))}addBinding(e,t,r){const i=r??{},s=this.controller_.element.ownerDocument,o=this.pool_.createBinding(s,id(e,t),i),a=this.pool_.createBindingApi(o);return this.add(a,i.index)}addFolder(e){return td(this,e)}addButton(e){return ed(this,e)}addTab(e){return nd(this,e)}add(e,t){const r=e.controller;return this.controller_.rack.add(r,t),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const t=this.controller_.element.ownerDocument,r=this.pool_.createBlade(t,e),i=this.pool_.createApi(r);return this.add(i,e.index)}on(e,t){const r=t.bind(this);return this.emitter_.on(e,i=>{r(i)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.children.forEach(e=>{rd(e)&&e.refresh()})}onRackValueChange_(e){const t=e.bladeController,r=this.pool_.createApi(t),i=Bc(t.value)?t.value.binding:null;this.emitter_.emit("change",new yo(r,i?i.target.read():t.value.rawValue,e.options.last))}}class di extends oi{constructor(e,t){super(e),this.rackApi_=new sd(e.rackController,t)}refresh(){this.rackApi_.refresh()}}class pi extends Po{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}importState(e){return et(e,t=>super.importState(t),t=>({children:t.required.array(t.required.raw)}),t=>this.rackController.rack.children.every((r,i)=>r.importState(t.children[i])))}exportState(){return tt(()=>super.exportState(),{children:this.rackController.rack.children.map(e=>e.exportState())})}}function Ur(n){return"rackController"in n}class od{constructor(e){this.emitter=new Be,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw Ne.shouldNeverHappen();const r=t!==void 0?t:this.items_.length;this.items_.splice(r,0,e),this.cache_.add(e);const i=this.extract_(e);i&&(i.emitter.on("add",this.onSubListAdd_),i.emitter.on("remove",this.onSubListRemove_),i.allItems().forEach(s=>{this.cache_.add(s)})),this.emitter.emit("add",{index:r,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const r=this.extract_(e);r&&(r.allItems().forEach(i=>{this.cache_.delete(i)}),r.emitter.off("add",this.onSubListAdd_),r.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}}function ad(n,e){for(let t=0;t<n.length;t++){const r=n[t];if(Bn(r)&&r.value===e)return r}return null}function ld(n){return Ur(n)?n.rackController.rack.bcSet_:null}class ud{constructor(e){var t,r;this.emitter=new Be,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(t=e.blade)!==null&&t!==void 0?t:null,(r=this.blade_)===null||r===void 0||r.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new od(ld),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){var r;(r=e.parent)===null||r===void 0||r.remove(e),e.parent=this,this.bcSet_.add(e,t)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:t,sender:this}),!t)return;const r=e.item;if(r.viewProps.emitter.on("change",this.onChildViewPropsChange_),r.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),r.viewProps.handleDispose(this.onChildDispose_),Bn(r))r.value.emitter.on("change",this.onChildValueChange_);else if(Ur(r)){const i=r.rackController.rack;if(i){const s=i.emitter;s.on("layout",this.onRackLayout_),s.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:t,sender:this}),!t)return;const r=e.item;if(Bn(r))r.value.emitter.off("change",this.onChildValueChange_);else if(Ur(r)){const i=r.rackController.rack;if(i){const s=i.emitter;s.off("layout",this.onRackLayout_),s.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter(i=>!i.viewProps.get("hidden")),t=e[0],r=e[e.length-1];this.bcSet_.items.forEach(i=>{const s=[];i===t&&(s.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&s.push("veryfirst")),i===r&&(s.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&s.push("verylast")),i.blade.set("positions",s)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(t=>t.viewProps.get("disposed")).forEach(t=>{this.bcSet_.remove(t)})}onChildValueChange_(e){const t=ad(this.find(Bn),e.sender);if(!t)throw Ne.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:t,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class hi{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const t=new ud({blade:e.root?void 0:e.blade,viewProps:e.viewProps});t.emitter.on("add",this.onRackAdd_),t.emitter.on("remove",this.onRackRemove_),this.rack=t,this.viewProps.handleDispose(()=>{for(let r=this.rack.children.length-1;r>=0;r--)this.rack.children[r].viewProps.set("disposed",!0)})}onRackAdd_(e){e.root&&_o(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.root&&ui(e.bladeController.view.element)}}function Mo(){return new re({positions:Ce([],{equals:Zu})})}class pn extends re{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},r=re.createCore(t);return new pn(r)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!fe(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const r=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};Qe(this,"expanded",r),Qe(this,"temporaryExpanded",r)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function cd(n,e){let t=0;return Fc(e,()=>{n.set("expandedHeight",null),n.set("temporaryExpanded",!0),Kn(e),t=e.clientHeight,n.set("temporaryExpanded",null),Kn(e)}),t}function os(n,e){e.style.height=n.styleHeight}function mi(n,e){n.value("expanded").emitter.on("beforechange",()=>{if(n.set("completed",!1),fe(n.get("expandedHeight"))){const t=cd(n,e);t>0&&n.set("expandedHeight",t)}n.set("shouldFixHeight",!0),Kn(e)}),n.emitter.on("change",()=>{os(n,e)}),os(n,e),e.addEventListener("transitionend",t=>{t.propertyName==="height"&&n.cleanUpTransition()})}class dd extends di{constructor(e,t){super(e,t),this.emitter_=new Be,this.controller.foldable.value("expanded").emitter.on("change",r=>{this.emitter_.emit("fold",new Oc(this,r.sender.rawValue))}),this.rackApi_.on("change",r=>{this.emitter_.emit("change",r)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,t,r){return this.rackApi_.addBinding(e,t,r)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const r=t.bind(this);return this.emitter_.on(e,i=>{r(i)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}}const To=ie("cnt");class pd{constructor(e,t){var r;this.className_=ie((r=t.viewName)!==null&&r!==void 0?r:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),To()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),Qe(this.foldable_,"completed",zt(this.element,this.className_(void 0,"cpl")));const i=e.createElement("button");i.classList.add(this.className_("b")),Qe(t.props,"title",p=>{fe(p)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(this.className_("i")),this.element.appendChild(s);const o=e.createElement("div");o.classList.add(this.className_("t")),ci(t.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;const a=e.createElement("div");a.classList.add(this.className_("m")),this.buttonElement.appendChild(a);const l=e.createElement("div");l.classList.add(this.className_("c")),this.element.appendChild(l),this.containerElement=l}}class as extends pi{constructor(e,t){var r;const i=pn.create((r=t.expanded)!==null&&r!==void 0?r:!0),s=new pd(e,{foldable:i,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new hi({blade:t.blade,element:s.containerElement,root:t.root,viewProps:t.viewProps}),view:s})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=i,mi(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return et(e,t=>super.importState(t),t=>({expanded:t.required.boolean,title:t.optional.string}),t=>(this.foldable.set("expanded",t.expanded),this.props.set("title",t.title),!0))}exportState(){return tt(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}ke({id:"folder",type:"blade",accept(n){const e=Te(n,t=>({title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean}));return e?{params:e}:null},controller(n){return new as(n.document,{blade:n.blade,expanded:n.params.expanded,props:re.fromObject({title:n.params.title}),viewProps:n.viewProps})},api(n){return n.controller instanceof as?new dd(n.controller,n.pool):null}});const hd=ie("");function ls(n,e){return zt(n,hd(void 0,e))}class hn extends re{constructor(e){var t;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=nc(Ce(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,r,i;const s=e??{};return new hn(re.createCore({disabled:(t=s.disabled)!==null&&t!==void 0?t:!1,disposed:!1,hidden:(r=s.hidden)!==null&&r!==void 0?r:!1,parent:(i=s.parent)!==null&&i!==void 0?i:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){at(this.globalDisabled_,ls(e,"disabled")),Qe(this,"hidden",ls(e,"hidden"))}bindDisabled(e){at(this.globalDisabled_,t=>{e.disabled=t})}bindTabIndex(e){at(this.globalDisabled_,t=>{e.tabIndex=t?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",t=>{t&&e()})}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return(e?e.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const r=e.previousRawValue;r==null||r.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}const us=ie("tbp");class md{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(us()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("div");r.classList.add(us("c")),this.element.appendChild(r),this.containerElement=r}}const Zt=ie("tbi");class fd{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Zt()),t.viewProps.bindClassModifiers(this.element),Qe(t.props,"selected",s=>{s?this.element.classList.add(Zt(void 0,"sel")):this.element.classList.remove(Zt(void 0,"sel"))});const r=e.createElement("button");r.classList.add(Zt("b")),t.viewProps.bindDisabled(r),this.element.appendChild(r),this.buttonElement=r;const i=e.createElement("div");i.classList.add(Zt("t")),ci(t.props.value("title"),i),this.buttonElement.appendChild(i),this.titleElement=i}}class vd{constructor(e,t){this.emitter=new Be,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new fd(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class zr extends pi{constructor(e,t){const r=new md(e,{viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new hi({blade:t.blade,element:r.containerElement,viewProps:t.viewProps}),view:r})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new vd(e,{props:t.itemProps,viewProps:hn.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=t.props,Qe(this.props,"selected",i=>{this.itemController.props.set("selected",i),this.viewProps.set("hidden",!i)})}get itemController(){return this.ic_}importState(e){return et(e,t=>super.importState(t),t=>({selected:t.required.boolean,title:t.required.string}),t=>(this.ic_.props.set("selected",t.selected),this.ic_.props.set("title",t.title),!0))}exportState(){return tt(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}}class gd extends di{constructor(e,t){super(e,t),this.emitter_=new Be,this.onSelect_=this.onSelect_.bind(this),this.pool_=t,this.rackApi_.on("change",r=>{this.emitter_.emit("change",r)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const t=this.controller.view.element.ownerDocument,r=new zr(t,{blade:Mo(),itemProps:re.fromObject({selected:!1,title:e.title}),props:re.fromObject({selected:!1}),viewProps:hn.create()}),i=this.pool_.createApi(r);return this.rackApi_.add(i,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,t){const r=t.bind(this);return this.emitter_.on(e,i=>{r(i)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}onSelect_(e){this.emitter_.emit("select",new Vc(this,e.rawValue))}}class wd extends di{get title(){var e;return(e=this.controller.itemController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBinding(e,t,r){return this.rackApi_.addBinding(e,t,r)}addBlade(e){return this.rackApi_.addBlade(e)}}const cs=-1;class bd{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=Ce(!0),this.selectedIndex=Ce(cs),this.items_=[]}add(e,t){const r=t??this.items_.length;this.items_.splice(r,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=cs,this.empty.rawValue=!0;return}const e=this.items_.findIndex(t=>t.rawValue);e<0?(this.items_.forEach((t,r)=>{t.rawValue=r===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((t,r)=>{t.rawValue=r===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const t=this.items_.findIndex(r=>r===e.sender);this.items_.forEach((r,i)=>{r.rawValue=i===t}),this.selectedIndex.rawValue=t}else this.keepSelection_()}}const Jt=ie("tab");class yd{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Jt(),To()),t.viewProps.bindClassModifiers(this.element),at(t.empty,zt(this.element,Jt(void 0,"nop")));const r=e.createElement("div");r.classList.add(Jt("t")),this.element.appendChild(r),this.itemsElement=r;const i=e.createElement("div");i.classList.add(Jt("i")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Jt("c")),this.element.appendChild(s),this.contentsElement=s}}class ds extends pi{constructor(e,t){const r=new bd,i=new yd(e,{empty:r.empty,viewProps:t.viewProps});super({blade:t.blade,rackController:new hi({blade:t.blade,element:i.contentsElement,viewProps:t.viewProps}),view:i}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const s=this.rackController.rack;s.emitter.on("add",this.onRackAdd_),s.emitter.on("remove",this.onRackRemove_),this.tab=r}add(e,t){this.rackController.rack.add(e,t)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const t=e.bladeController;_o(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.tab.add(t.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const t=e.bladeController;ui(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.tab.remove(t.props.value("selected"))}}ke({id:"tab",type:"blade",accept(n){const e=Te(n,t=>({pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")}));return!e||e.pages.length===0?null:{params:e}},controller(n){const e=new ds(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(t=>{const r=new zr(n.document,{blade:Mo(),itemProps:re.fromObject({selected:!1,title:t.title}),props:re.fromObject({selected:!1}),viewProps:hn.create()});e.add(r)}),e},api(n){return n.controller instanceof ds?new gd(n.controller,n.pool):n.controller instanceof zr?new wd(n.controller,n.pool):null}});class fi extends ai{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}}class mn{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((t,r)=>r.constrain(t),e)}}function Yn(n,e){if(n instanceof e)return n;if(n instanceof mn){const t=n.constraints.reduce((r,i)=>r||(i instanceof e?i:null),null);if(t)return t}return null}class sr{constructor(e){this.values=re.fromObject({options:e})}constrain(e){const t=this.values.get("options");return t.length===0||t.filter(i=>i.value===e).length>0?e:t[0].value}}function or(n){var e;const t=Fr;if(Array.isArray(n))return(e=Te({items:n},r=>({items:r.required.array(r.required.object({text:r.required.string,value:r.required.raw}))})))===null||e===void 0?void 0:e.items;if(typeof n=="object")return t.required.raw(n).value}function So(n){if(Array.isArray(n))return n;const e=[];return Object.keys(n).forEach(t=>{e.push({text:t,value:n[t]})}),e}function vi(n){return fe(n)?null:new sr(So(n))}const br=ie("lst");class _d{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(br()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("select");r.classList.add(br("s")),t.viewProps.bindDisabled(r),this.element.appendChild(r),this.selectElement=r;const i=e.createElement("div");i.classList.add(br("m")),i.appendChild(ir(e,"dropdown")),this.element.appendChild(i),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,Qe(this.props_,"options",s=>{xo(this.selectElement),s.forEach(o=>{const a=e.createElement("option");a.textContent=o.text,this.selectElement.appendChild(a)}),this.update_()})}update_(){const e=this.props_.get("options").map(t=>t.value);this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class Bt{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new _d(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget;this.value.rawValue=this.props.get("options")[t.selectedIndex].value}importProps(e){return et(e,null,t=>({options:t.required.custom(or)}),t=>(this.props.set("options",So(t.options)),!0))}exportProps(){return tt(null,{options:this.props.get("options")})}}const ps=ie("pop");class xd{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ps()),t.viewProps.bindClassModifiers(this.element),at(t.shows,zt(this.element,ps(void 0,"v")))}}class ko{constructor(e,t){this.shows=Ce(!1),this.viewProps=t.viewProps,this.view=new xd(e,{shows:this.shows,viewProps:this.viewProps})}}const hs=ie("txt");class Cd{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(hs()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const r=e.createElement("input");r.classList.add(hs("i")),r.type="text",t.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}}class gi{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Cd(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const r=e.currentTarget.value,i=this.parser_(r);fe(i)||(this.value.rawValue=i),this.view.refresh()}}function Pd(n){return String(n)}function Lo(n){return n==="false"?!1:!!n}function ms(n){return Pd(n)}function Ed(n){return e=>n.reduce((t,r)=>t!==null?t:r(e),null)}const Md=je(0);function Wn(n){return Md(n)+"%"}function Io(n){return String(n)}function Hr(n){return n}function Ht({primary:n,secondary:e,forward:t,backward:r}){let i=!1;function s(o){i||(i=!0,o(),i=!1)}n.emitter.on("change",o=>{s(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),e.emitter.on("change",o=>{s(()=>{n.setRawValue(r(n.rawValue,e.rawValue),o.options)}),s(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),s(()=>{e.setRawValue(t(n.rawValue,e.rawValue),{forceEmit:!1,last:!0})})}function Ve(n,e){const t=n*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+t:e.downKey?-t:0}function un(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}function ut(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}function Td(n){return n==="ArrowUp"||n==="ArrowDown"}function Ao(n){return Td(n)||n==="ArrowLeft"||n==="ArrowRight"}function yr(n,e){var t,r;const i=e.ownerDocument.defaultView,s=e.getBoundingClientRect();return{x:n.pageX-(((t=i&&i.scrollX)!==null&&t!==void 0?t:0)+s.left),y:n.pageY-(((r=i&&i.scrollY)!==null&&r!==void 0?r:0)+s.top)}}class Mt{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new Be,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),(t=e.currentTarget)===null||t===void 0||t.focus();const r=this.elem_.ownerDocument;r.addEventListener("mousemove",this.onDocumentMouseMove_),r.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(yr(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(yr(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(yr(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),r=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-r.left,y:t.clientY-r.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),r=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-r.left,y:t.clientY-r.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const r=(t=e.targetTouches.item(0))!==null&&t!==void 0?t:this.lastTouch_,i=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(r?{x:r.clientX-i.left,y:r.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey})}}const ze=ie("txt");class Sd{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(ze(),ze(void 0,"num")),t.arrayPosition&&this.element.classList.add(ze(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("input");r.classList.add(ze("i")),r.type="text",t.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(ze()),this.inputElement.classList.add(ze("i"));const i=e.createElement("div");i.classList.add(ze("k")),this.element.appendChild(i),this.knobElement=i;const s=e.createElementNS(qe,"svg");s.classList.add(ze("g")),this.knobElement.appendChild(s);const o=e.createElementNS(qe,"path");o.classList.add(ze("gb")),s.appendChild(o),this.guideBodyElem_=o;const a=e.createElementNS(qe,"path");a.classList.add(ze("gh")),s.appendChild(a),this.guideHeadElem_=a;const l=e.createElement("div");l.classList.add(ie("tt")()),this.knobElement.appendChild(l),this.tooltipElem_=l,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(ze(void 0,"drg"));return}this.element.classList.add(ze(void 0,"drg"));const t=e.rawValue/this.props_.get("pointerScale"),r=t+(t>0?-1:t<0?1:0),i=xe(-r,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${r+i},0 L${r},4 L${r+i},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const s=this.props_.get("formatter");this.tooltipElem_.textContent=s(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}}class fn{constructor(e,t){var r;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=t.parser,this.props=t.props,this.sliderProps_=(r=t.sliderProps)!==null&&r!==void 0?r:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=Ce(null),this.view=new Sd(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const i=new Mt(this.view.knobElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,r;const i=(t=this.sliderProps_)===null||t===void 0?void 0:t.get("min"),s=(r=this.sliderProps_)===null||r===void 0?void 0:r.get("max");let o=e;return i!==void 0&&(o=Math.max(o,i)),s!==void 0&&(o=Math.min(o,s)),o}onInputChange_(e){const r=e.currentTarget.value,i=this.parser_(r);fe(i)||(this.value.rawValue=this.constrainValue_(i)),this.view.refresh()}onInputKeyDown_(e){const t=Ve(this.props.get("keyScale"),un(e));t!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){Ve(this.props.get("keyScale"),un(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("pointerScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const _r=ie("sld");class kd{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(_r()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("div");r.classList.add(_r("t")),t.viewProps.bindTabIndex(r),this.element.appendChild(r),this.trackElement=r;const i=e.createElement("div");i.classList.add(_r("k")),this.trackElement.appendChild(i),this.knobElement=i,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=xe(ae(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}}class Ld{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new kd(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mt(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(ae(xe(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Ve(this.props.get("keyScale"),ut(e));t!==0&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){Ve(this.props.get("keyScale"),ut(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const xr=ie("sldtxt");class Id{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(xr());const r=e.createElement("div");r.classList.add(xr("s")),this.sliderView_=t.sliderView,r.appendChild(this.sliderView_.element),this.element.appendChild(r);const i=e.createElement("div");i.classList.add(xr("t")),this.textView_=t.textView,i.appendChild(this.textView_.element),this.element.appendChild(i)}}class fs{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new Ld(e,{props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new fn(e,{parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new Id(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return et(e,null,t=>({max:t.required.number,min:t.required.number}),t=>{const r=this.sliderC_.props;return r.set("max",t.max),r.set("min",t.min),!0})}exportProps(){const e=this.sliderC_.props;return tt(null,{max:e.get("max"),min:e.get("min")})}}function Ad(n){return{sliderProps:new re({keyScale:n.keyScale,max:n.max,min:n.min}),textProps:new re({formatter:Ce(n.formatter),keyScale:n.keyScale,pointerScale:Ce(n.pointerScale)})}}const Od={containerUnitSize:"cnt-usz"};function Oo(n){return`--${Od[n]}`}function cn(n){return bo(n)}function vt(n){if(Br(n))return Te(n,cn)}function ot(n,e){if(!n)return;const t=[],r=vo(n,e);r&&t.push(r);const i=go(n);return i&&t.push(i),new mn(t)}function Vo(n){if(n==="inline"||n==="popup")return n}function vn(n,e){n.write(e)}const Sn=ie("ckb");class Vd{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Sn()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("label");r.classList.add(Sn("l")),this.element.appendChild(r),this.labelElement=r;const i=e.createElement("input");i.classList.add(Sn("i")),i.type="checkbox",this.labelElement.appendChild(i),this.inputElement=i,t.viewProps.bindDisabled(this.inputElement);const s=e.createElement("div");s.classList.add(Sn("w")),this.labelElement.appendChild(s);const o=ir(e,"check");s.appendChild(o),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class jd{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.onLabelMouseDown_=this.onLabelMouseDown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Vd(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.labelElement.addEventListener("mousedown",this.onLabelMouseDown_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked,e.preventDefault(),e.stopPropagation()}onLabelMouseDown_(e){e.preventDefault()}}function Rd(n){const e=[],t=vi(n.options);return t&&e.push(t),new mn(e)}ke({id:"input-bool",type:"input",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=Te(e,r=>({options:r.optional.custom(or),readonly:r.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>Lo,constraint:n=>Rd(n.params),writer:n=>vn},controller:n=>{const e=n.document,t=n.value,r=n.constraint,i=r&&Yn(r,sr);return i?new Bt(e,{props:new re({options:i.values.value("options")}),value:t,viewProps:n.viewProps}):new jd(e,{value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="boolean"?null:n.controller.valueController instanceof Bt?new fi(n.controller):null}});const _t=ie("col");class Nd{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(_t()),t.foldable.bindExpandedClass(this.element,_t(void 0,"expanded")),Qe(t.foldable,"completed",zt(this.element,_t(void 0,"cpl")));const r=e.createElement("div");r.classList.add(_t("h")),this.element.appendChild(r);const i=e.createElement("div");i.classList.add(_t("s")),r.appendChild(i),this.swatchElement=i;const s=e.createElement("div");if(s.classList.add(_t("t")),r.appendChild(s),this.textElement=s,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(_t("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}}function Dd(n,e,t){const r=xe(n/255,0,1),i=xe(e/255,0,1),s=xe(t/255,0,1),o=Math.max(r,i,s),a=Math.min(r,i,s),l=o-a;let p=0,w=0;const h=(a+o)/2;return l!==0&&(w=l/(1-Math.abs(o+a-1)),r===o?p=(i-s)/l:i===o?p=2+(s-r)/l:p=4+(r-i)/l,p=p/6+(p<0?1:0)),[p*360,w*100,h*100]}function Bd(n,e,t){const r=(n%360+360)%360,i=xe(e/100,0,1),s=xe(t/100,0,1),o=(1-Math.abs(2*s-1))*i,a=o*(1-Math.abs(r/60%2-1)),l=s-o/2;let p,w,h;return r>=0&&r<60?[p,w,h]=[o,a,0]:r>=60&&r<120?[p,w,h]=[a,o,0]:r>=120&&r<180?[p,w,h]=[0,o,a]:r>=180&&r<240?[p,w,h]=[0,a,o]:r>=240&&r<300?[p,w,h]=[a,0,o]:[p,w,h]=[o,0,a],[(p+l)*255,(w+l)*255,(h+l)*255]}function Fd(n,e,t){const r=xe(n/255,0,1),i=xe(e/255,0,1),s=xe(t/255,0,1),o=Math.max(r,i,s),a=Math.min(r,i,s),l=o-a;let p;l===0?p=0:o===r?p=60*(((i-s)/l%6+6)%6):o===i?p=60*((s-r)/l+2):p=60*((r-i)/l+4);const w=o===0?0:l/o,h=o;return[p,w*100,h*100]}function jo(n,e,t){const r=mo(n,360),i=xe(e/100,0,1),s=xe(t/100,0,1),o=s*i,a=o*(1-Math.abs(r/60%2-1)),l=s-o;let p,w,h;return r>=0&&r<60?[p,w,h]=[o,a,0]:r>=60&&r<120?[p,w,h]=[a,o,0]:r>=120&&r<180?[p,w,h]=[0,o,a]:r>=180&&r<240?[p,w,h]=[0,a,o]:r>=240&&r<300?[p,w,h]=[a,0,o]:[p,w,h]=[o,0,a],[(p+l)*255,(w+l)*255,(h+l)*255]}function Ud(n,e,t){const r=t+e*(100-Math.abs(2*t-100))/200;return[n,r!==0?e*(100-Math.abs(2*t-100))/r:0,t+e*(100-Math.abs(2*t-100))/(2*100)]}function zd(n,e,t){const r=100-Math.abs(t*(200-e)/100-100);return[n,r!==0?e*t/r:0,t*(200-e)/(2*100)]}function Xe(n){return[n[0],n[1],n[2]]}function ar(n,e){return[n[0],n[1],n[2],e]}const Hd={hsl:{hsl:(n,e,t)=>[n,e,t],hsv:Ud,rgb:Bd},hsv:{hsl:zd,hsv:(n,e,t)=>[n,e,t],rgb:jo},rgb:{hsl:Dd,hsv:Fd,rgb:(n,e,t)=>[n,e,t]}};function Ft(n,e){return[e==="float"?1:n==="rgb"?255:360,e==="float"?1:n==="rgb"?255:100,e==="float"?1:n==="rgb"?255:100]}function $d(n,e){return n===e?e:mo(n,e)}function Ro(n,e,t){var r;const i=Ft(e,t);return[e==="rgb"?xe(n[0],0,i[0]):$d(n[0],i[0]),xe(n[1],0,i[1]),xe(n[2],0,i[2]),xe((r=n[3])!==null&&r!==void 0?r:1,0,1)]}function vs(n,e,t,r){const i=Ft(e,t),s=Ft(e,r);return n.map((o,a)=>o/i[a]*s[a])}function No(n,e,t){const r=vs(n,e.mode,e.type,"int"),i=Hd[e.mode][t.mode](...r);return vs(i,t.mode,"int",t.type)}class ne{static black(){return new ne([0,0,0],"rgb")}constructor(e,t){this.type="int",this.mode=t,this.comps_=Ro(e,t,this.type)}getComponents(e){return ar(No(Xe(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const dt=ie("colp");class Gd{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(dt()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("div");r.classList.add(dt("hsv"));const i=e.createElement("div");i.classList.add(dt("sv")),this.svPaletteView_=t.svPaletteView,i.appendChild(this.svPaletteView_.element),r.appendChild(i);const s=e.createElement("div");s.classList.add(dt("h")),this.hPaletteView_=t.hPaletteView,s.appendChild(this.hPaletteView_.element),r.appendChild(s),this.element.appendChild(r);const o=e.createElement("div");if(o.classList.add(dt("rgb")),this.textsView_=t.textsView,o.appendChild(this.textsView_.element),this.element.appendChild(o),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const a=e.createElement("div");a.classList.add(dt("a"));const l=e.createElement("div");l.classList.add(dt("ap")),l.appendChild(this.alphaViews_.palette.element),a.appendChild(l);const p=e.createElement("div");p.classList.add(dt("at")),p.appendChild(this.alphaViews_.text.element),a.appendChild(p),this.element.appendChild(a)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(t=>t.inputElement)];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}}function Kd(n){return n==="int"?"int":n==="float"?"float":void 0}function wi(n){return Te(n,e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(Kd)}),expanded:e.optional.boolean,picker:e.optional.custom(Vo),readonly:e.optional.constant(!1)}))}function Et(n){return n?.1:1}function Do(n){var e;return(e=n.color)===null||e===void 0?void 0:e.type}class bi{constructor(e,t){this.type="float",this.mode=t,this.comps_=Ro(e,t,this.type)}getComponents(e){return ar(No(Xe(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const Yd={int:(n,e)=>new ne(n,e),float:(n,e)=>new bi(n,e)};function yi(n,e,t){return Yd[t](n,e)}function Wd(n){return n.type==="float"}function qd(n){return n.type==="int"}function Zd(n){const e=n.getComponents(),t=Ft(n.mode,"int");return new ne([Math.round(ae(e[0],0,1,0,t[0])),Math.round(ae(e[1],0,1,0,t[1])),Math.round(ae(e[2],0,1,0,t[2])),e[3]],n.mode)}function Jd(n){const e=n.getComponents(),t=Ft(n.mode,"int");return new bi([ae(e[0],0,t[0],0,1),ae(e[1],0,t[1],0,1),ae(e[2],0,t[2],0,1),e[3]],n.mode)}function Se(n,e){if(n.type===e)return n;if(qd(n)&&e==="float")return Jd(n);if(Wd(n)&&e==="int")return Zd(n);throw Ne.shouldNeverHappen()}function Qd(n,e){return n.alpha===e.alpha&&n.mode===e.mode&&n.notation===e.notation&&n.type===e.type}function He(n,e){const t=n.match(/^(.+)%$/);return Math.min(t?parseFloat(t[1])*.01*e:parseFloat(n),e)}const Xd={deg:n=>n,grad:n=>n*360/400,rad:n=>n*360/(2*Math.PI),turn:n=>n*360};function Bo(n){const e=n.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(n);const t=parseFloat(e[1]),r=e[2];return Xd[r](t)}function Fo(n){const e=n.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[He(e[1],255),He(e[2],255),He(e[3],255)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function ep(n){const e=Fo(n);return e?new ne(e,"rgb"):null}function Uo(n){const e=n.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[He(e[1],255),He(e[2],255),He(e[3],255),He(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function tp(n){const e=Uo(n);return e?new ne(e,"rgb"):null}function zo(n){const e=n.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Bo(e[1]),He(e[2],100),He(e[3],100)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function np(n){const e=zo(n);return e?new ne(e,"hsl"):null}function Ho(n){const e=n.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Bo(e[1]),He(e[2],100),He(e[3],100),He(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function rp(n){const e=Ho(n);return e?new ne(e,"hsl"):null}function $o(n){const e=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const t=n.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}function ip(n){const e=$o(n);return e?new ne(e,"rgb"):null}function Go(n){const e=n.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),ae(parseInt(e[4]+e[4],16),0,255,0,1)];const t=n.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),ae(parseInt(t[4],16),0,255,0,1)]:null}function sp(n){const e=Go(n);return e?new ne(e,"rgb"):null}function Ko(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function op(n){return e=>{const t=Ko(e);return t?yi(t,"rgb",n):null}}function Yo(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function ap(n){return e=>{const t=Yo(e);return t?yi(t,"rgb",n):null}}const lp=[{parser:$o,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:Go,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:Fo,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:Uo,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:zo,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:Ho,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:Ko,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:Yo,result:{alpha:!0,mode:"rgb",notation:"object"}}];function up(n){return lp.reduce((e,{parser:t,result:r})=>e||(t(n)?r:null),null)}function cp(n,e="int"){const t=up(n);return t?t.notation==="hex"&&e!=="float"?Object.assign(Object.assign({},t),{type:"int"}):t.notation==="func"?Object.assign(Object.assign({},t),{type:e}):null:null}function gn(n){const e=[ip,sp,ep,tp,np,rp];e.push(op("int"),ap("int"));const t=Ed(e);return r=>{const i=t(r);return i?Se(i,n):null}}function dp(n){const e=gn("int");if(typeof n!="string")return ne.black();const t=e(n);return t??ne.black()}function Wo(n){const e=xe(Math.floor(n),0,255).toString(16);return e.length===1?`0${e}`:e}function _i(n,e="#"){const t=Xe(n.getComponents("rgb")).map(Wo).join("");return`${e}${t}`}function xi(n,e="#"){const t=n.getComponents("rgb"),r=[t[0],t[1],t[2],t[3]*255].map(Wo).join("");return`${e}${r}`}function qo(n){const e=je(0),t=Se(n,"int");return`rgb(${Xe(t.getComponents("rgb")).map(i=>e(i)).join(", ")})`}function Fn(n){const e=je(2),t=je(0);return`rgba(${Se(n,"int").getComponents("rgb").map((s,o)=>(o===3?e:t)(s)).join(", ")})`}function pp(n){const e=[je(0),Wn,Wn],t=Se(n,"int");return`hsl(${Xe(t.getComponents("hsl")).map((i,s)=>e[s](i)).join(", ")})`}function hp(n){const e=[je(0),Wn,Wn,je(2)];return`hsla(${Se(n,"int").getComponents("hsl").map((i,s)=>e[s](i)).join(", ")})`}function Zo(n,e){const t=je(e==="float"?2:0),r=["r","g","b"],i=Se(n,e);return`{${Xe(i.getComponents("rgb")).map((o,a)=>`${r[a]}: ${t(o)}`).join(", ")}}`}function mp(n){return e=>Zo(e,n)}function Jo(n,e){const t=je(2),r=je(e==="float"?2:0),i=["r","g","b","a"];return`{${Se(n,e).getComponents("rgb").map((a,l)=>{const p=l===3?t:r;return`${i[l]}: ${p(a)}`}).join(", ")}}`}function fp(n){return e=>Jo(e,n)}const vp=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:_i},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:xi},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:qo},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:Fn},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:pp},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:hp},...["int","float"].reduce((n,e)=>[...n,{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:mp(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:fp(e)}],[])];function Qo(n){return vp.reduce((e,t)=>e||(Qd(t.format,n)?t.stringifier:null),null)}const Qt=ie("apl");class gp{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Qt()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const r=e.createElement("div");r.classList.add(Qt("b")),this.element.appendChild(r);const i=e.createElement("div");i.classList.add(Qt("c")),r.appendChild(i),this.colorElem_=i;const s=e.createElement("div");s.classList.add(Qt("m")),this.element.appendChild(s),this.markerElem_=s;const o=e.createElement("div");o.classList.add(Qt("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),r=new ne([t[0],t[1],t[2],0],"rgb"),i=new ne([t[0],t[1],t[2],255],"rgb"),s=["to right",Fn(r),Fn(i)];this.colorElem_.style.background=`linear-gradient(${s.join(",")})`,this.previewElem_.style.backgroundColor=Fn(e);const o=ae(t[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}}class wp{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new gp(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const r=e.point.x/e.bounds.width,i=this.value.rawValue,[s,o,a]=i.getComponents("hsv");this.value.setRawValue(new ne([s,o,a,r],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Ve(Et(!0),ut(e));if(t===0)return;const r=this.value.rawValue,[i,s,o,a]=r.getComponents("hsv");this.value.setRawValue(new ne([i,s,o,a+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){Ve(Et(!0),ut(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const St=ie("coltxt");function bp(n){const e=n.createElement("select"),t=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return e.appendChild(t.reduce((r,i)=>{const s=n.createElement("option");return s.textContent=i.text,s.value=i.value,r.appendChild(s),r},n.createDocumentFragment())),e}class yp{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(St()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("div");r.classList.add(St("m")),this.modeElem_=bp(e),this.modeElem_.classList.add(St("ms")),r.appendChild(this.modeSelectElement),t.viewProps.bindDisabled(this.modeElem_);const i=e.createElement("div");i.classList.add(St("mm")),i.appendChild(ir(e,"dropdown")),r.appendChild(i),this.element.appendChild(r);const s=e.createElement("div");s.classList.add(St("w")),this.element.appendChild(s),this.inputsElem_=s,this.inputViews_=t.inputViews,this.applyInputViews_(),at(t.mode,o=>{this.modeElem_.value=o})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){xo(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach(t=>{const r=e.createElement("div");r.classList.add(St("c")),r.appendChild(t.element),this.inputsElem_.appendChild(r)})}}function _p(n){return je(n==="float"?2:0)}function xp(n,e,t){const r=Ft(n,e)[t];return new nr({min:0,max:r})}function Cp(n,e,t){return new fn(n,{arrayPosition:t===0?"fst":t===2?"lst":"mid",parser:e.parser,props:re.fromObject({formatter:_p(e.colorType),keyScale:Et(!1),pointerScale:e.colorType==="float"?.01:1}),value:Ce(0,{constraint:xp(e.colorMode,e.colorType,t)}),viewProps:e.viewProps})}function Pp(n,e){const t={colorMode:e.colorMode,colorType:e.colorType,parser:bt,viewProps:e.viewProps};return[0,1,2].map(r=>{const i=Cp(n,t,r);return Ht({primary:e.value,secondary:i.value,forward(s){return Se(s,e.colorType).getComponents(e.colorMode)[r]},backward(s,o){const a=e.colorMode,p=Se(s,e.colorType).getComponents(a);p[r]=o;const w=yi(ar(Xe(p),p[3]),a,e.colorType);return Se(w,"int")}}),i})}function Ep(n,e){const t=new gi(n,{parser:gn("int"),props:re.fromObject({formatter:_i}),value:Ce(ne.black()),viewProps:e.viewProps});return Ht({primary:e.value,secondary:t.value,forward:r=>new ne(Xe(r.getComponents()),r.mode),backward:(r,i)=>new ne(ar(Xe(i.getComponents(r.mode)),r.getComponents()[3]),r.mode)}),[t]}function Mp(n){return n!=="hex"}class Tp{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=Ce(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new yp(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t=this.colorMode.rawValue;return Mp(t)?Pp(e,{colorMode:t,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):Ep(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(r=>r.view)}}const Cr=ie("hpl");class Sp{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Cr()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const r=e.createElement("div");r.classList.add(Cr("c")),this.element.appendChild(r);const i=e.createElement("div");i.classList.add(Cr("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=qo(new ne([t,100,100],"hsv"));const r=ae(t,0,360,0,100);this.markerElem_.style.left=`${r}%`}onValueChange_(){this.update_()}}class kp{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Sp(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const r=ae(xe(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),i=this.value.rawValue,[,s,o,a]=i.getComponents("hsv");this.value.setRawValue(new ne([r,s,o,a],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Ve(Et(!1),ut(e));if(t===0)return;const r=this.value.rawValue,[i,s,o,a]=r.getComponents("hsv");this.value.setRawValue(new ne([i+t,s,o,a],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){Ve(Et(!1),ut(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Pr=ie("svp"),gs=64;class Lp{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Pr()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const r=e.createElement("canvas");r.height=gs,r.width=gs,r.classList.add(Pr("c")),this.element.appendChild(r),this.canvasElement=r;const i=e.createElement("div");i.classList.add(Pr("m")),this.element.appendChild(i),this.markerElem_=i,this.update_()}update_(){const e=Uc(this.canvasElement);if(!e)return;const r=this.value.rawValue.getComponents("hsv"),i=this.canvasElement.width,s=this.canvasElement.height,o=e.getImageData(0,0,i,s),a=o.data;for(let w=0;w<s;w++)for(let h=0;h<i;h++){const M=ae(h,0,i,0,100),P=ae(w,0,s,100,0),m=jo(r[0],M,P),C=(w*i+h)*4;a[C]=m[0],a[C+1]=m[1],a[C+2]=m[2],a[C+3]=255}e.putImageData(o,0,0);const l=ae(r[1],0,100,0,100);this.markerElem_.style.left=`${l}%`;const p=ae(r[2],0,100,100,0);this.markerElem_.style.top=`${p}%`}onValueChange_(){this.update_()}}class Ip{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Lp(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const r=ae(e.point.x,0,e.bounds.width,0,100),i=ae(e.point.y,0,e.bounds.height,100,0),[s,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new ne([s,r,i,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){Ao(e.key)&&e.preventDefault();const[t,r,i,s]=this.value.rawValue.getComponents("hsv"),o=Et(!1),a=Ve(o,ut(e)),l=Ve(o,un(e));a===0&&l===0||this.value.setRawValue(new ne([t,r+a,i+l,s],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=Et(!1),r=Ve(t,ut(e)),i=Ve(t,un(e));r===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Ap{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new kp(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Ip(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new wp(e,{value:this.value,viewProps:this.viewProps}),text:new fn(e,{parser:bt,props:re.fromObject({pointerScale:.01,keyScale:.1,formatter:je(2)}),value:Ce(0,{constraint:new nr({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Ht({primary:this.value,secondary:this.alphaIcs_.text.value,forward:r=>r.getComponents()[3],backward:(r,i)=>{const s=r.getComponents();return s[3]=i,new ne(s,r.mode)}}),this.textsC_=new Tp(e,{colorType:t.colorType,value:this.value,viewProps:this.viewProps}),this.view=new Gd(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}}const Er=ie("colsw");class Op{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(Er()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("div");r.classList.add(Er("sw")),this.element.appendChild(r),this.swatchElem_=r;const i=e.createElement("button");i.classList.add(Er("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=xi(e)}onValueChange_(){this.update_()}}class Vp{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Op(e,{value:this.value,viewProps:this.viewProps})}}class Ci{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=pn.create(t.expanded),this.swatchC_=new Vp(e,{value:this.value,viewProps:this.viewProps});const r=this.swatchC_.view.buttonElement;r.addEventListener("blur",this.onButtonBlur_),r.addEventListener("click",this.onButtonClick_),this.textC_=new gi(e,{parser:t.parser,props:re.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new Nd(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=t.pickerLayout==="popup"?new ko(e,{viewProps:this.viewProps}):null;const i=new Ap(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});i.view.allFocusableElements.forEach(s=>{s.addEventListener("blur",this.onPopupChildBlur_),s.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(i.view.element),Ht({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:s=>s,backward:(s,o)=>o})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),mi(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,r=e.relatedTarget;(!r||!t.contains(r))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,r=Co(e);r&&t.contains(r)||r&&r===this.swatchC_.view.buttonElement&&!li(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function jp(n){return Xe(n.getComponents("rgb")).reduce((e,t)=>e<<8|Math.floor(t)&255,0)}function Rp(n){return n.getComponents("rgb").reduce((e,t,r)=>{const i=Math.floor(r===3?t*255:t)&255;return e<<8|i},0)>>>0}function Np(n){return new ne([n>>16&255,n>>8&255,n&255],"rgb")}function Dp(n){return new ne([n>>24&255,n>>16&255,n>>8&255,ae(n&255,0,255,0,1)],"rgb")}function Bp(n){return typeof n!="number"?ne.black():Np(n)}function Fp(n){return typeof n!="number"?ne.black():Dp(n)}function Un(n,e){return typeof n!="object"||fe(n)?!1:e in n&&typeof n[e]=="number"}function Xo(n){return Un(n,"r")&&Un(n,"g")&&Un(n,"b")}function ea(n){return Xo(n)&&Un(n,"a")}function ta(n){return Xo(n)}function Pi(n,e){if(n.mode!==e.mode||n.type!==e.type)return!1;const t=n.getComponents(),r=e.getComponents();for(let i=0;i<t.length;i++)if(t[i]!==r[i])return!1;return!0}function ws(n){return"a"in n?[n.r,n.g,n.b,n.a]:[n.r,n.g,n.b]}function Up(n){const e=Qo(n);return e?(t,r)=>{vn(t,e(r))}:null}function zp(n){const e=n?Rp:jp;return(t,r)=>{vn(t,e(r))}}function Hp(n,e,t){const i=Se(e,t).toRgbaObject();n.writeProperty("r",i.r),n.writeProperty("g",i.g),n.writeProperty("b",i.b),n.writeProperty("a",i.a)}function $p(n,e,t){const i=Se(e,t).toRgbaObject();n.writeProperty("r",i.r),n.writeProperty("g",i.g),n.writeProperty("b",i.b)}function Gp(n,e){return(t,r)=>{n?Hp(t,r,e):$p(t,r,e)}}function Kp(n){var e;return!!(!((e=n==null?void 0:n.color)===null||e===void 0)&&e.alpha)}function Yp(n){return n?e=>xi(e,"0x"):e=>_i(e,"0x")}function Wp(n){return"color"in n||n.view==="color"}ke({id:"input-color-number",type:"input",accept:(n,e)=>{if(typeof n!="number"||!Wp(e))return null;const t=wi(e);return t?{initialValue:n,params:Object.assign(Object.assign({},t),{supportsAlpha:Kp(e)})}:null},binding:{reader:n=>n.params.supportsAlpha?Fp:Bp,equals:Pi,writer:n=>zp(n.params.supportsAlpha)},controller:n=>{var e,t;return new Ci(n.document,{colorType:"int",expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:Yp(n.params.supportsAlpha),parser:gn("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.supportsAlpha,value:n.value,viewProps:n.viewProps})}});function qp(n,e){if(!ta(n))return Se(ne.black(),e);if(e==="int"){const t=ws(n);return new ne(t,"rgb")}if(e==="float"){const t=ws(n);return new bi(t,"rgb")}return Se(ne.black(),"int")}function Zp(n){return ea(n)}function Jp(n){return e=>{const t=qp(e,n);return Se(t,"int")}}function Qp(n,e){return t=>n?Jo(t,e):Zo(t,e)}ke({id:"input-color-object",type:"input",accept:(n,e)=>{var t;if(!ta(n))return null;const r=wi(e);return r?{initialValue:n,params:Object.assign(Object.assign({},r),{colorType:(t=Do(e))!==null&&t!==void 0?t:"int"})}:null},binding:{reader:n=>Jp(n.params.colorType),equals:Pi,writer:n=>Gp(Zp(n.initialValue),n.params.colorType)},controller:n=>{var e,t;const r=ea(n.initialValue);return new Ci(n.document,{colorType:n.params.colorType,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:Qp(r,n.params.colorType),parser:gn("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:r,value:n.value,viewProps:n.viewProps})}});ke({id:"input-color-string",type:"input",accept:(n,e)=>{if(typeof n!="string"||e.view==="text")return null;const t=cp(n,Do(e));if(!t)return null;const r=Qo(t);if(!r)return null;const i=wi(e);return i?{initialValue:n,params:Object.assign(Object.assign({},i),{format:t,stringifier:r})}:null},binding:{reader:()=>dp,equals:Pi,writer:n=>{const e=Up(n.params.format);if(!e)throw Ne.notBindable();return e}},controller:n=>{var e,t;return new Ci(n.document,{colorType:n.params.format.type,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:n.params.stringifier,parser:gn("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.format.alpha,value:n.value,viewProps:n.viewProps})}});class Ei{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map((r,i)=>{var s,o;return(o=(s=this.components[i])===null||s===void 0?void 0:s.constrain(r))!==null&&o!==void 0?o:r});return this.asm_.fromComponents(t)}}const bs=ie("pndtxt");class Xp{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(bs()),this.textViews.forEach(r=>{const i=e.createElement("div");i.classList.add(bs("a")),i.appendChild(r.element),this.element.appendChild(i)})}}function eh(n,e,t){return new fn(n,{arrayPosition:t===0?"fst":t===e.axes.length-1?"lst":"mid",parser:e.parser,props:e.axes[t].textProps,value:Ce(0,{constraint:e.axes[t].constraint}),viewProps:e.viewProps})}class Mi{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map((r,i)=>eh(e,t,i)),this.acs_.forEach((r,i)=>{Ht({primary:this.value,secondary:r.value,forward:s=>t.assembly.toComponents(s)[i],backward:(s,o)=>{const a=t.assembly.toComponents(s);return a[i]=o,t.assembly.fromComponents(a)}})}),this.view=new Xp(e,{textViews:this.acs_.map(r=>r.view)})}get textControllers(){return this.acs_}}class th extends ai{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}}function nh(n,e){const t=[],r=vo(n,e);r&&t.push(r);const i=go(n);i&&t.push(i);const s=vi(n.options);return s&&t.push(s),new mn(t)}ke({id:"input-number",type:"input",accept:(n,e)=>{if(typeof n!="number")return null;const t=Te(e,r=>Object.assign(Object.assign({},bo(r)),{options:r.optional.custom(or),readonly:r.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>ho,constraint:n=>nh(n.params,n.initialValue),writer:n=>vn},controller:n=>{const e=n.value,t=n.constraint,r=t&&Yn(t,sr);if(r)return new Bt(n.document,{props:new re({options:r.values.value("options")}),value:e,viewProps:n.viewProps});const i=wo(n.params,e.rawValue),s=t&&Yn(t,nr);return s?new fs(n.document,Object.assign(Object.assign({},Ad(Object.assign(Object.assign({},i),{keyScale:Ce(i.keyScale),max:s.values.value("max"),min:s.values.value("min")}))),{parser:bt,value:e,viewProps:n.viewProps})):new fn(n.document,{parser:bt,props:re.fromObject(i),value:e,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="number"?null:n.controller.valueController instanceof fs?new th(n.controller):n.controller.valueController instanceof Bt?new fi(n.controller):null}});class gt{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(fe(e))return!1;const t=e.x,r=e.y;return!(typeof t!="number"||typeof r!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}}const na={toComponents:n=>n.getComponents(),fromComponents:n=>new gt(...n)},kt=ie("p2d");class rh{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(kt()),t.viewProps.bindClassModifiers(this.element),at(t.expanded,zt(this.element,kt(void 0,"expanded")));const r=e.createElement("div");r.classList.add(kt("h")),this.element.appendChild(r);const i=e.createElement("button");i.classList.add(kt("b")),i.appendChild(ir(e,"p2dpad")),t.viewProps.bindDisabled(i),r.appendChild(i),this.buttonElement=i;const s=e.createElement("div");if(s.classList.add(kt("t")),r.appendChild(s),this.textElement=s,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(kt("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}}const pt=ie("p2dp");class ih{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(pt()),t.layout==="popup"&&this.element.classList.add(pt(void 0,"p")),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("div");r.classList.add(pt("p")),t.viewProps.bindTabIndex(r),this.element.appendChild(r),this.padElement=r;const i=e.createElementNS(qe,"svg");i.classList.add(pt("g")),this.padElement.appendChild(i),this.svgElem_=i;const s=e.createElementNS(qe,"line");s.classList.add(pt("ax")),s.setAttributeNS(null,"x1","0"),s.setAttributeNS(null,"y1","50%"),s.setAttributeNS(null,"x2","100%"),s.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(s);const o=e.createElementNS(qe,"line");o.classList.add(pt("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const a=e.createElementNS(qe,"line");a.classList.add(pt("l")),a.setAttributeNS(null,"x1","50%"),a.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(a),this.lineElem_=a;const l=e.createElement("div");l.classList.add(pt("m")),this.padElement.appendChild(l),this.markerElem_=l,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),r=this.props_.get("max"),i=ae(e,-r,+r,0,100),s=ae(t,-r,+r,0,100),o=this.props_.get("invertsY")?100-s:s;this.lineElem_.setAttributeNS(null,"x2",`${i}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${i}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}}function ys(n,e,t){return[Ve(e[0],ut(n)),Ve(e[1],un(n))*(t?1:-1)]}class sh{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new ih(e,{layout:t.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Mt(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const r=this.props.get("max"),i=ae(e.point.x,0,e.bounds.width,-r,+r),s=ae(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-r,+r);this.value.setRawValue(new gt(i,s),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){Ao(e.key)&&e.preventDefault();const[t,r]=ys(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&r===0||this.value.setRawValue(new gt(this.value.rawValue.x+t,this.value.rawValue.y+r),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,r]=ys(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&r===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class oh{constructor(e,t){var r,i;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=pn.create(t.expanded),this.popC_=t.pickerLayout==="popup"?new ko(e,{viewProps:this.viewProps}):null;const s=new sh(e,{layout:t.pickerLayout,props:new re({invertsY:Ce(t.invertsY),max:Ce(t.max),xKeyScale:t.axes[0].textProps.value("keyScale"),yKeyScale:t.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach(o=>{o.addEventListener("blur",this.onPopupChildBlur_),o.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=s,this.textC_=new Mi(e,{assembly:na,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new rh(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(r=this.view.buttonElement)===null||r===void 0||r.addEventListener("blur",this.onPadButtonBlur_),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Ht({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:o=>o,backward:(o,a)=>a})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),mi(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,r=e.relatedTarget;(!r||!t.contains(r))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,r=Co(e);r&&t.contains(r)||r&&r===this.view.buttonElement&&!li(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()}}function ah(n){return gt.isObject(n)?new gt(n.x,n.y):new gt}function lh(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y)}function uh(n,e){return new Ei({assembly:na,components:[ot(Object.assign(Object.assign({},n),n.x),e.x),ot(Object.assign(Object.assign({},n),n.y),e.y)]})}function _s(n,e){var t,r;if(!fe(n.min)||!fe(n.max))return Math.max(Math.abs((t=n.min)!==null&&t!==void 0?t:0),Math.abs((r=n.max)!==null&&r!==void 0?r:0));const i=fo(n);return Math.max(Math.abs(i)*10,Math.abs(e)*10)}function ch(n,e){var t,r;const i=_s(Pt(n,(t=n.x)!==null&&t!==void 0?t:{}),e.x),s=_s(Pt(n,(r=n.y)!==null&&r!==void 0?r:{}),e.y);return Math.max(i,s)}function dh(n){if(!("y"in n))return!1;const e=n.y;return e&&"inverted"in e?!!e.inverted:!1}ke({id:"input-point2d",type:"input",accept:(n,e)=>{if(!gt.isObject(n))return null;const t=Te(e,r=>Object.assign(Object.assign({},cn(r)),{expanded:r.optional.boolean,picker:r.optional.custom(Vo),readonly:r.optional.constant(!1),x:r.optional.custom(vt),y:r.optional.object(Object.assign(Object.assign({},cn(r)),{inverted:r.optional.boolean}))}));return t?{initialValue:n,params:t}:null},binding:{reader:()=>ah,constraint:n=>uh(n.params,n.initialValue),equals:gt.equals,writer:()=>lh},controller:n=>{var e,t;const r=n.document,i=n.value,s=n.constraint,o=[n.params.x,n.params.y];return new oh(r,{axes:i.rawValue.getComponents().map((a,l)=>{var p;return si({constraint:s.components[l],initialValue:a,params:Pt(n.params,(p=o[l])!==null&&p!==void 0?p:{})})}),expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,invertsY:dh(n.params),max:ch(n.params,i.rawValue),parser:bt,pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",value:i,viewProps:n.viewProps})}});class jt{constructor(e=0,t=0,r=0){this.x=e,this.y=t,this.z=r}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(fe(e))return!1;const t=e.x,r=e.y,i=e.z;return!(typeof t!="number"||typeof r!="number"||typeof i!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const ra={toComponents:n=>n.getComponents(),fromComponents:n=>new jt(...n)};function ph(n){return jt.isObject(n)?new jt(n.x,n.y,n.z):new jt}function hh(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z)}function mh(n,e){return new Ei({assembly:ra,components:[ot(Object.assign(Object.assign({},n),n.x),e.x),ot(Object.assign(Object.assign({},n),n.y),e.y),ot(Object.assign(Object.assign({},n),n.z),e.z)]})}ke({id:"input-point3d",type:"input",accept:(n,e)=>{if(!jt.isObject(n))return null;const t=Te(e,r=>Object.assign(Object.assign({},cn(r)),{readonly:r.optional.constant(!1),x:r.optional.custom(vt),y:r.optional.custom(vt),z:r.optional.custom(vt)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>ph,constraint:n=>mh(n.params,n.initialValue),equals:jt.equals,writer:n=>hh},controller:n=>{const e=n.value,t=n.constraint,r=[n.params.x,n.params.y,n.params.z];return new Mi(n.document,{assembly:ra,axes:e.rawValue.getComponents().map((i,s)=>{var o;return si({constraint:t.components[s],initialValue:i,params:Pt(n.params,(o=r[s])!==null&&o!==void 0?o:{})})}),parser:bt,value:e,viewProps:n.viewProps})}});class Rt{constructor(e=0,t=0,r=0,i=0){this.x=e,this.y=t,this.z=r,this.w=i}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(fe(e))return!1;const t=e.x,r=e.y,i=e.z,s=e.w;return!(typeof t!="number"||typeof r!="number"||typeof i!="number"||typeof s!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const ia={toComponents:n=>n.getComponents(),fromComponents:n=>new Rt(...n)};function fh(n){return Rt.isObject(n)?new Rt(n.x,n.y,n.z,n.w):new Rt}function vh(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z),n.writeProperty("w",e.w)}function gh(n,e){return new Ei({assembly:ia,components:[ot(Object.assign(Object.assign({},n),n.x),e.x),ot(Object.assign(Object.assign({},n),n.y),e.y),ot(Object.assign(Object.assign({},n),n.z),e.z),ot(Object.assign(Object.assign({},n),n.w),e.w)]})}ke({id:"input-point4d",type:"input",accept:(n,e)=>{if(!Rt.isObject(n))return null;const t=Te(e,r=>Object.assign(Object.assign({},cn(r)),{readonly:r.optional.constant(!1),w:r.optional.custom(vt),x:r.optional.custom(vt),y:r.optional.custom(vt),z:r.optional.custom(vt)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>fh,constraint:n=>gh(n.params,n.initialValue),equals:Rt.equals,writer:n=>vh},controller:n=>{const e=n.value,t=n.constraint,r=[n.params.x,n.params.y,n.params.z,n.params.w];return new Mi(n.document,{assembly:ia,axes:e.rawValue.getComponents().map((i,s)=>{var o;return si({constraint:t.components[s],initialValue:i,params:Pt(n.params,(o=r[s])!==null&&o!==void 0?o:{})})}),parser:bt,value:e,viewProps:n.viewProps})}});function wh(n){const e=[],t=vi(n.options);return t&&e.push(t),new mn(e)}ke({id:"input-string",type:"input",accept:(n,e)=>{if(typeof n!="string")return null;const t=Te(e,r=>({readonly:r.optional.constant(!1),options:r.optional.custom(or)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>Io,constraint:n=>wh(n.params),writer:n=>vn},controller:n=>{const e=n.document,t=n.value,r=n.constraint,i=r&&Yn(r,sr);return i?new Bt(e,{props:new re({options:i.values.value("options")}),value:t,viewProps:n.viewProps}):new gi(e,{parser:s=>s,props:re.fromObject({formatter:Hr}),value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="string"?null:n.controller.valueController instanceof Bt?new fi(n.controller):null}});const lr={monitor:{defaultInterval:200,defaultRows:3}},xs=ie("mll");class bh{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(xs()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("textarea");r.classList.add(xs("i")),r.style.height=`calc(var(${Oo("containerUnitSize")}) * ${t.rows})`,r.readOnly=!0,t.viewProps.bindDisabled(r),this.element.appendChild(r),this.textareaElem_=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,r=[];this.value.rawValue.forEach(i=>{i!==void 0&&r.push(this.formatter_(i))}),e.textContent=r.join(`
`),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}}class Ti{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new bh(e,{formatter:t.formatter,rows:t.rows,value:this.value,viewProps:this.viewProps})}}const Cs=ie("sgl");class yh{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(Cs()),t.viewProps.bindClassModifiers(this.element);const r=e.createElement("input");r.classList.add(Cs("i")),r.readOnly=!0,r.type="text",t.viewProps.bindDisabled(r),this.element.appendChild(r),this.inputElement=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=t!==void 0?this.formatter_(t):""}onValueUpdate_(){this.update_()}}class Si{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new yh(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}}ke({id:"monitor-bool",type:"monitor",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=Te(e,r=>({readonly:r.required.constant(!0),rows:r.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>Lo},controller:n=>{var e;return n.value.rawValue.length===1?new Si(n.document,{formatter:ms,value:n.value,viewProps:n.viewProps}):new Ti(n.document,{formatter:ms,rows:(e=n.params.rows)!==null&&e!==void 0?e:lr.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}});class _h extends ai{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}}const ht=ie("grl");class xh{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ht()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const r=e.createElementNS(qe,"svg");r.classList.add(ht("g")),r.style.height=`calc(var(${Oo("containerUnitSize")}) * ${t.rows})`,this.element.appendChild(r),this.svgElem_=r;const i=e.createElementNS(qe,"polyline");this.svgElem_.appendChild(i),this.lineElem_=i;const s=e.createElement("div");s.classList.add(ht("t"),ie("tt")()),this.element.appendChild(s),this.tooltipElem_=s,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const{clientWidth:e,clientHeight:t}=this.element,r=this.value.rawValue.length-1,i=this.props_.get("min"),s=this.props_.get("max"),o=[];this.value.rawValue.forEach((h,M)=>{if(h===void 0)return;const P=ae(M,0,r,0,e),m=ae(h,i,s,t,0);o.push([P,m].join(","))}),this.lineElem_.setAttributeNS(null,"points",o.join(" "));const a=this.tooltipElem_,l=this.value.rawValue[this.cursor_.rawValue];if(l===void 0){a.classList.remove(ht("t","a"));return}const p=ae(this.cursor_.rawValue,0,r,0,e),w=ae(l,i,s,t,0);a.style.left=`${p}px`,a.style.top=`${w}px`,a.textContent=`${this.formatter_(l)}`,a.classList.contains(ht("t","a"))||(a.classList.add(ht("t","a"),ht("t","in")),Kn(a),a.classList.remove(ht("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class sa{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=Ce(-1),this.view=new xh(e,{cursor:this.cursor_,formatter:t.formatter,rows:t.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!li(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const r=new Mt(this.view.element);r.emitter.on("down",this.onGraphPointerDown_),r.emitter.on("move",this.onGraphPointerMove_),r.emitter.on("up",this.onGraphPointerUp_)}}importProps(e){return et(e,null,t=>({max:t.required.number,min:t.required.number}),t=>(this.props.set("max",t.max),this.props.set("min",t.min),!0))}exportProps(){return tt(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const{clientWidth:t}=this.view.element;this.cursor_.rawValue=Math.floor(ae(e.offsetX,0,t,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(ae(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function $r(n){return fe(n.format)?je(2):n.format}function Ch(n){var e;return n.value.rawValue.length===1?new Si(n.document,{formatter:$r(n.params),value:n.value,viewProps:n.viewProps}):new Ti(n.document,{formatter:$r(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:lr.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}function Ph(n){var e,t,r;return new sa(n.document,{formatter:$r(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:lr.monitor.defaultRows,props:re.fromObject({max:(t=n.params.max)!==null&&t!==void 0?t:100,min:(r=n.params.min)!==null&&r!==void 0?r:0}),value:n.value,viewProps:n.viewProps})}function Ps(n){return n.view==="graph"}ke({id:"monitor-number",type:"monitor",accept:(n,e)=>{if(typeof n!="number")return null;const t=Te(e,r=>({format:r.optional.function,max:r.optional.number,min:r.optional.number,readonly:r.required.constant(!0),rows:r.optional.number,view:r.optional.string}));return t?{initialValue:n,params:t}:null},binding:{defaultBufferSize:n=>Ps(n)?64:1,reader:n=>ho},controller:n=>Ps(n.params)?Ph(n):Ch(n),api:n=>n.controller.valueController instanceof sa?new _h(n.controller):null});ke({id:"monitor-string",type:"monitor",accept:(n,e)=>{if(typeof n!="string")return null;const t=Te(e,r=>({multiline:r.optional.boolean,readonly:r.required.constant(!0),rows:r.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>Io},controller:n=>{var e;const t=n.value;return t.rawValue.length>1||n.params.multiline?new Ti(n.document,{formatter:Hr,rows:(e=n.params.rows)!==null&&e!==void 0?e:lr.monitor.defaultRows,value:t,viewProps:n.viewProps}):new Si(n.document,{formatter:Hr,value:t,viewProps:n.viewProps})}});new Eo("4.0.3");const Eh=parseInt(Ns.replace(/\D+/g,""));var Mh=Object.defineProperty,Th=(n,e,t)=>e in n?Mh(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Sh=(n,e,t)=>(Th(n,e+"",t),t);async function Es(n){const e=await n.arrayBuffer(),t=btoa(String.fromCharCode(...new Uint8Array(e)));return`data:${n.type||""};base64,${t}`}let kn,Mr,Lt,Ln;function Tr(n,e=1/0,t=null){Mr||(Mr=new zs(2,2,1,1)),Lt||(Lt=new Jn({uniforms:{blitTexture:new Ha(n)},vertexShader:`
        varying vec2 vUv;
        void main(){
            vUv = uv;
            gl_Position = vec4(position.xy * 1.0,0.,.999999);
        }
      `,fragmentShader:`
          uniform sampler2D blitTexture; 
          varying vec2 vUv;

          void main(){ 
              gl_FragColor = vec4(vUv.xy, 0, 1);
              
              #ifdef IS_SRGB
              gl_FragColor = LinearTosRGB( texture2D( blitTexture, vUv) );
              #else
              gl_FragColor = texture2D( blitTexture, vUv);
              #endif
          }
      `})),Lt.uniforms.blitTexture.value=n,Lt.defines.IS_SRGB="colorSpace"in n?n.colorSpace==="srgb":n.encoding===3001,Lt.needsUpdate=!0,Ln||(Ln=new xt(Mr,Lt),Ln.frustrumCulled=!1);const r=new Ke,i=new rn;i.add(Ln),t||(t=kn=new On({antialias:!1})),t.setSize(Math.min(n.image.width,e),Math.min(n.image.height,e)),t.clear(),t.render(i,r);const s=new Hs(t.domElement);return s.minFilter=n.minFilter,s.magFilter=n.magFilter,s.wrapS=n.wrapS,s.wrapT=n.wrapT,s.name=n.name,kn&&(kn.dispose(),kn=null),s}const Ms={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class oa{constructor(){this.pluginCallbacks=[],this.register(function(e){return new Dh(e)}),this.register(function(e){return new Bh(e)}),this.register(function(e){return new zh(e)}),this.register(function(e){return new Hh(e)}),this.register(function(e){return new $h(e)}),this.register(function(e){return new Gh(e)}),this.register(function(e){return new Fh(e)}),this.register(function(e){return new Uh(e)}),this.register(function(e){return new Kh(e)}),this.register(function(e){return new Yh(e)}),this.register(function(e){return new Wh(e)})}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,r,i){const s=new Nh,o=[];for(let a=0,l=this.pluginCallbacks.length;a<l;a++)o.push(this.pluginCallbacks[a](s));s.setPlugins(o),s.write(e,t,i).catch(r)}parseAsync(e,t){const r=this;return new Promise(function(i,s){r.parse(e,i,s,t)})}}Sh(oa,"Utils",{insertKeyframe:function(n,e){const t=n.getValueSize(),r=new n.TimeBufferType(n.times.length+1),i=new n.ValueBufferType(n.values.length+t),s=n.createInterpolant(new n.ValueBufferType(t));let o;if(n.times.length===0){r[0]=e;for(let a=0;a<t;a++)i[a]=0;o=0}else if(e<n.times[0]){if(Math.abs(n.times[0]-e)<.001)return 0;r[0]=e,r.set(n.times,1),i.set(s.evaluate(e),0),i.set(n.values,t),o=0}else if(e>n.times[n.times.length-1]){if(Math.abs(n.times[n.times.length-1]-e)<.001)return n.times.length-1;r[r.length-1]=e,r.set(n.times,0),i.set(n.values,0),i.set(s.evaluate(e),n.values.length),o=r.length-1}else for(let a=0;a<n.times.length;a++){if(Math.abs(n.times[a]-e)<.001)return a;if(n.times[a]<e&&n.times[a+1]>e){r.set(n.times.slice(0,a+1),0),r[a+1]=e,r.set(n.times.slice(a+1),a+2),i.set(n.values.slice(0,(a+1)*t),0),i.set(s.evaluate(e),(a+1)*t),i.set(n.values.slice((a+1)*t),(a+2)*t),o=a+1;break}}return n.times=r,n.values=i,o},mergeMorphTargetTracks:function(n,e){const t=[],r={},i=n.tracks;for(let s=0;s<i.length;++s){let o=i[s];const a=zn.parseTrackName(o.name),l=zn.findNode(e,a.nodeName);if(a.propertyName!=="morphTargetInfluences"||a.propertyIndex===void 0){t.push(o);continue}if(o.createInterpolant!==o.InterpolantFactoryMethodDiscrete&&o.createInterpolant!==o.InterpolantFactoryMethodLinear){if(o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),o=o.clone(),o.setInterpolation(Ia)}const p=l.morphTargetInfluences.length,w=l.morphTargetDictionary[a.propertyIndex];if(w===void 0)throw new Error("THREE.GLTFExporter: Morph target name not found: "+a.propertyIndex);let h;if(r[l.uuid]===void 0){h=o.clone();const P=new h.ValueBufferType(p*h.times.length);for(let m=0;m<h.times.length;m++)P[m*p+w]=h.values[m];h.name=(a.nodeName||"")+".morphTargetInfluences",h.values=P,r[l.uuid]=h,t.push(h);continue}const M=o.createInterpolant(new o.ValueBufferType(1));h=r[l.uuid];for(let P=0;P<h.times.length;P++)h.values[P*p+w]=M.evaluate(h.times[P]);for(let P=0;P<o.times.length;P++){const m=this.insertKeyframe(h,o.times[P]);h.values[m*p+w]=o.values[P]}}return n.tracks=t,n}});const X={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},Sr="KHR_mesh_quantization",De={};De[$a]=X.NEAREST;De[Ga]=X.NEAREST_MIPMAP_NEAREST;De[Ka]=X.NEAREST_MIPMAP_LINEAR;De[Ya]=X.LINEAR;De[Wa]=X.LINEAR_MIPMAP_NEAREST;De[qa]=X.LINEAR_MIPMAP_LINEAR;De[Za]=X.CLAMP_TO_EDGE;De[Ja]=X.REPEAT;De[Qa]=X.MIRRORED_REPEAT;const Ts={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},kh=new Ze,Ss=12,Lh=1179937895,Ih=2,ks=8,Ah=1313821514,Oh=5130562;function en(n,e){return n.length===e.length&&n.every(function(t,r){return t===e[r]})}function Vh(n){return new TextEncoder().encode(n).buffer}function jh(n){return en(n.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function Rh(n,e,t){const r={min:new Array(n.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(n.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let i=e;i<e+t;i++)for(let s=0;s<n.itemSize;s++){let o;n.itemSize>4?o=n.array[i*n.itemSize+s]:(s===0?o=n.getX(i):s===1?o=n.getY(i):s===2?o=n.getZ(i):s===3&&(o=n.getW(i)),n.normalized===!0&&(o=Nt.normalize(o,n.array))),r.min[s]=Math.min(r.min[s],o),r.max[s]=Math.max(r.max[s],o)}return r}function aa(n){return Math.ceil(n/4)*4}function kr(n,e=0){const t=aa(n.byteLength);if(t!==n.byteLength){const r=new Uint8Array(t);if(r.set(new Uint8Array(n)),e!==0)for(let i=n.byteLength;i<t;i++)r[i]=e;return r.buffer}return n}function Ls(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function Is(n,e){if(n.toBlob!==void 0)return new Promise(r=>n.toBlob(r,e));let t;return e==="image/jpeg"?t=.92:e==="image/webp"&&(t=.8),n.convertToBlob({type:e,quality:t})}class Nh{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(e){this.plugins=e}async write(e,t,r={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},r),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e),await Promise.all(this.pending);const i=this,s=i.buffers,o=i.json;r=i.options;const a=i.extensionsUsed,l=i.extensionsRequired,p=new Blob(s,{type:"application/octet-stream"}),w=Object.keys(a),h=Object.keys(l);w.length>0&&(o.extensionsUsed=w),h.length>0&&(o.extensionsRequired=h),o.buffers&&o.buffers.length>0&&(o.buffers[0].byteLength=p.size),r.binary===!0?p.arrayBuffer().then(M=>{const P=kr(M),m=new DataView(new ArrayBuffer(ks));m.setUint32(0,P.byteLength,!0),m.setUint32(4,Oh,!0);const C=kr(Vh(JSON.stringify(o)),32),f=new DataView(new ArrayBuffer(ks));f.setUint32(0,C.byteLength,!0),f.setUint32(4,Ah,!0);const x=new ArrayBuffer(Ss),T=new DataView(x);T.setUint32(0,Lh,!0),T.setUint32(4,Ih,!0);const E=Ss+f.byteLength+C.byteLength+m.byteLength+P.byteLength;T.setUint32(8,E,!0),new Blob([x,f,C,m,P],{type:"application/octet-stream"}).arrayBuffer().then(t)}):o.buffers&&o.buffers.length>0?Es(p).then(M=>{o.buffers[0].uri=M,t(o)}):t(o)}serializeUserData(e,t){if(Object.keys(e.userData).length===0)return;const r=this.options,i=this.extensionsUsed;try{const s=JSON.parse(JSON.stringify(e.userData));if(r.includeCustomExtensions&&s.gltfExtensions){t.extensions===void 0&&(t.extensions={});for(const o in s.gltfExtensions)t.extensions[o]=s.gltfExtensions[o],i[o]=!0;delete s.gltfExtensions}Object.keys(s).length>0&&(t.extras=s)}catch(s){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+s.message)}}getUID(e,t=!1){if(this.uids.has(e)===!1){const r=new Map;r.set(!0,this.uid++),r.set(!1,this.uid++),this.uids.set(e,r)}return this.uids.get(e).get(t)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const t=new J;for(let r=0,i=e.count;r<i;r++)if(Math.abs(t.fromBufferAttribute(e,r).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);const r=e.clone(),i=new J;for(let s=0,o=r.count;s<o;s++)i.fromBufferAttribute(r,s),i.x===0&&i.y===0&&i.z===0?i.setX(1):i.normalize(),r.setXYZ(s,i.x,i.y,i.z);return t.attributesNormalized.set(e,r),r}applyTextureTransform(e,t){let r=!1;const i={};(t.offset.x!==0||t.offset.y!==0)&&(i.offset=t.offset.toArray(),r=!0),t.rotation!==0&&(i.rotation=t.rotation,r=!0),(t.repeat.x!==1||t.repeat.y!==1)&&(i.scale=t.repeat.toArray(),r=!0),r&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=i,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(e,t){if(e===t)return e;function r(M){return("colorSpace"in M?M.colorSpace==="srgb":M.encoding===3001)?function(P){return P<.04045?P*.0773993808:Math.pow(P*.9478672986+.0521327014,2.4)}:function(P){return P}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),e instanceof fr&&(e=Tr(e)),t instanceof fr&&(t=Tr(t));const i=e?e.image:null,s=t?t.image:null,o=Math.max(i?i.width:0,s?s.width:0),a=Math.max(i?i.height:0,s?s.height:0),l=Ls();l.width=o,l.height=a;const p=l.getContext("2d");p.fillStyle="#00ffff",p.fillRect(0,0,o,a);const w=p.getImageData(0,0,o,a);if(i){p.drawImage(i,0,0,o,a);const M=r(e),P=p.getImageData(0,0,o,a).data;for(let m=2;m<P.length;m+=4)w.data[m]=M(P[m]/256)*256}if(s){p.drawImage(s,0,0,o,a);const M=r(t),P=p.getImageData(0,0,o,a).data;for(let m=1;m<P.length;m+=4)w.data[m]=M(P[m]/256)*256}p.putImageData(w,0,0);const h=(e||t).clone();return h.source=new Hs(l).source,"colorSpace"in h?h.colorSpace="":h.encoding=3e3,h.channel=(e||t).channel,e&&t&&e.channel!==t.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),h}processBuffer(e){const t=this.json,r=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),r.push(e),0}processBufferView(e,t,r,i,s){const o=this.json;o.bufferViews||(o.bufferViews=[]);let a;switch(t){case X.BYTE:case X.UNSIGNED_BYTE:a=1;break;case X.SHORT:case X.UNSIGNED_SHORT:a=2;break;default:a=4}const l=aa(i*e.itemSize*a),p=new DataView(new ArrayBuffer(l));let w=0;for(let M=r;M<r+i;M++)for(let P=0;P<e.itemSize;P++){let m;e.itemSize>4?m=e.array[M*e.itemSize+P]:(P===0?m=e.getX(M):P===1?m=e.getY(M):P===2?m=e.getZ(M):P===3&&(m=e.getW(M)),e.normalized===!0&&(m=Nt.normalize(m,e.array))),t===X.FLOAT?p.setFloat32(w,m,!0):t===X.INT?p.setInt32(w,m,!0):t===X.UNSIGNED_INT?p.setUint32(w,m,!0):t===X.SHORT?p.setInt16(w,m,!0):t===X.UNSIGNED_SHORT?p.setUint16(w,m,!0):t===X.BYTE?p.setInt8(w,m):t===X.UNSIGNED_BYTE&&p.setUint8(w,m),w+=a}const h={buffer:this.processBuffer(p.buffer),byteOffset:this.byteOffset,byteLength:l};return s!==void 0&&(h.target=s),s===X.ARRAY_BUFFER&&(h.byteStride=e.itemSize*a),this.byteOffset+=l,o.bufferViews.push(h),{id:o.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const t=this,r=t.json;return r.bufferViews||(r.bufferViews=[]),e.arrayBuffer().then(i=>{const s=kr(i),o={buffer:t.processBuffer(s),byteOffset:t.byteOffset,byteLength:s.byteLength};return t.byteOffset+=s.byteLength,r.bufferViews.push(o)-1})}processAccessor(e,t,r,i){const s=this.json,o={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"};let a;if(e.array.constructor===Float32Array)a=X.FLOAT;else if(e.array.constructor===Int32Array)a=X.INT;else if(e.array.constructor===Uint32Array)a=X.UNSIGNED_INT;else if(e.array.constructor===Int16Array)a=X.SHORT;else if(e.array.constructor===Uint16Array)a=X.UNSIGNED_SHORT;else if(e.array.constructor===Int8Array)a=X.BYTE;else if(e.array.constructor===Uint8Array)a=X.UNSIGNED_BYTE;else throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);if(r===void 0&&(r=0),i===void 0&&(i=e.count),i===0)return null;const l=Rh(e,r,i);let p;t!==void 0&&(p=e===t.index?X.ELEMENT_ARRAY_BUFFER:X.ARRAY_BUFFER);const w=this.processBufferView(e,a,r,i,p),h={bufferView:w.id,byteOffset:w.byteOffset,componentType:a,count:i,max:l.max,min:l.min,type:o[e.itemSize]};return e.normalized===!0&&(h.normalized=!0),s.accessors||(s.accessors=[]),s.accessors.push(h)-1}processImage(e,t,r,i="image/png"){if(e!==null){const s=this,o=s.cache,a=s.json,l=s.options,p=s.pending;o.images.has(e)||o.images.set(e,{});const w=o.images.get(e),h=i+":flipY/"+r.toString();if(w[h]!==void 0)return w[h];a.images||(a.images=[]);const M={mimeType:i},P=Ls();P.width=Math.min(e.width,l.maxTextureSize),P.height=Math.min(e.height,l.maxTextureSize);const m=P.getContext("2d");if(r===!0&&(m.translate(0,P.height),m.scale(1,-1)),e.data!==void 0){t!==Fa&&console.error("GLTFExporter: Only RGBAFormat is supported.",t),(e.width>l.maxTextureSize||e.height>l.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const f=new Uint8ClampedArray(e.height*e.width*4);for(let x=0;x<f.length;x+=4)f[x+0]=e.data[x+0],f[x+1]=e.data[x+1],f[x+2]=e.data[x+2],f[x+3]=e.data[x+3];m.putImageData(new ImageData(f,e.width,e.height),0,0)}else m.drawImage(e,0,0,P.width,P.height);l.binary===!0?p.push(Is(P,i).then(f=>s.processBufferViewImage(f)).then(f=>{M.bufferView=f})):P.toDataURL!==void 0?M.uri=P.toDataURL(i):p.push(Is(P,i).then(Es).then(f=>{M.uri=f}));const C=a.images.push(M)-1;return w[h]=C,C}else throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const t=this.json;t.samplers||(t.samplers=[]);const r={magFilter:De[e.magFilter],minFilter:De[e.minFilter],wrapS:De[e.wrapS],wrapT:De[e.wrapT]};return t.samplers.push(r)-1}processTexture(e){const t=this.options,r=this.cache,i=this.json;if(r.textures.has(e))return r.textures.get(e);i.textures||(i.textures=[]),e instanceof fr&&(e=Tr(e,t.maxTextureSize));let s=e.userData.mimeType;s==="image/webp"&&(s="image/png");const o={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,s)};e.name&&(o.name=e.name),this._invokeAll(function(l){l.writeTexture&&l.writeTexture(e,o)});const a=i.textures.push(o)-1;return r.textures.set(e,a),a}processMaterial(e){const t=this.cache,r=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;r.materials||(r.materials=[]);const i={pbrMetallicRoughness:{}};e.isMeshStandardMaterial!==!0&&e.isMeshBasicMaterial!==!0&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const s=e.color.toArray().concat([e.opacity]);if(en(s,[1,1,1,1])||(i.pbrMetallicRoughness.baseColorFactor=s),e.isMeshStandardMaterial?(i.pbrMetallicRoughness.metallicFactor=e.metalness,i.pbrMetallicRoughness.roughnessFactor=e.roughness):(i.pbrMetallicRoughness.metallicFactor=.5,i.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap){const a=this.buildMetalRoughTexture(e.metalnessMap,e.roughnessMap),l={index:this.processTexture(a),channel:a.channel};this.applyTextureTransform(l,a),i.pbrMetallicRoughness.metallicRoughnessTexture=l}if(e.map){const a={index:this.processTexture(e.map),texCoord:e.map.channel};this.applyTextureTransform(a,e.map),i.pbrMetallicRoughness.baseColorTexture=a}if(e.emissive){const a=e.emissive;if(Math.max(a.r,a.g,a.b)>0&&(i.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const l={index:this.processTexture(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(l,e.emissiveMap),i.emissiveTexture=l}}if(e.normalMap){const a={index:this.processTexture(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&e.normalScale.x!==1&&(a.scale=e.normalScale.x),this.applyTextureTransform(a,e.normalMap),i.normalTexture=a}if(e.aoMap){const a={index:this.processTexture(e.aoMap),texCoord:e.aoMap.channel};e.aoMapIntensity!==1&&(a.strength=e.aoMapIntensity),this.applyTextureTransform(a,e.aoMap),i.occlusionTexture=a}e.transparent?i.alphaMode="BLEND":e.alphaTest>0&&(i.alphaMode="MASK",i.alphaCutoff=e.alphaTest),e.side===Zn&&(i.doubleSided=!0),e.name!==""&&(i.name=e.name),this.serializeUserData(e,i),this._invokeAll(function(a){a.writeMaterial&&a.writeMaterial(e,i)});const o=r.materials.push(i)-1;return t.materials.set(e,o),o}processMesh(e){const t=this.cache,r=this.json,i=[e.geometry.uuid];if(Array.isArray(e.material))for(let E=0,k=e.material.length;E<k;E++)i.push(e.material[E].uuid);else i.push(e.material.uuid);const s=i.join(":");if(t.meshes.has(s))return t.meshes.get(s);const o=e.geometry;let a;e.isLineSegments?a=X.LINES:e.isLineLoop?a=X.LINE_LOOP:e.isLine?a=X.LINE_STRIP:e.isPoints?a=X.POINTS:a=e.material.wireframe?X.LINES:X.TRIANGLES;const l={},p={},w=[],h=[],M={...Eh>=152?{uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3"}:{uv:"TEXCOORD_0",uv2:"TEXCOORD_1"},color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},P=o.getAttribute("normal");P!==void 0&&!this.isNormalizedNormalAttribute(P)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),o.setAttribute("normal",this.createNormalizedNormalAttribute(P)));let m=null;for(let E in o.attributes){if(E.slice(0,5)==="morph")continue;const k=o.attributes[E];if(E=M[E]||E.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(E)||(E="_"+E),t.attributes.has(this.getUID(k))){p[E]=t.attributes.get(this.getUID(k));continue}m=null;const S=k.array;E==="JOINTS_0"&&!(S instanceof Uint16Array)&&!(S instanceof Uint8Array)&&(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),m=new At(new Uint16Array(S),k.itemSize,k.normalized));const v=this.processAccessor(m||k,o);v!==null&&(E.startsWith("_")||this.detectMeshQuantization(E,k),p[E]=v,t.attributes.set(this.getUID(k),v))}if(P!==void 0&&o.setAttribute("normal",P),Object.keys(p).length===0)return null;if(e.morphTargetInfluences!==void 0&&e.morphTargetInfluences.length>0){const E=[],k=[],S={};if(e.morphTargetDictionary!==void 0)for(const v in e.morphTargetDictionary)S[e.morphTargetDictionary[v]]=v;for(let v=0;v<e.morphTargetInfluences.length;++v){const L={};let d=!1;for(const b in o.morphAttributes){if(b!=="position"&&b!=="normal"){d||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),d=!0);continue}const u=o.morphAttributes[b][v],y=b.toUpperCase(),A=o.attributes[b];if(t.attributes.has(this.getUID(u,!0))){L[y]=t.attributes.get(this.getUID(u,!0));continue}const F=u.clone();if(!o.morphTargetsRelative)for(let j=0,z=u.count;j<z;j++)for(let R=0;R<u.itemSize;R++)R===0&&F.setX(j,u.getX(j)-A.getX(j)),R===1&&F.setY(j,u.getY(j)-A.getY(j)),R===2&&F.setZ(j,u.getZ(j)-A.getZ(j)),R===3&&F.setW(j,u.getW(j)-A.getW(j));L[y]=this.processAccessor(F,o),t.attributes.set(this.getUID(A,!0),L[y])}h.push(L),E.push(e.morphTargetInfluences[v]),e.morphTargetDictionary!==void 0&&k.push(S[v])}l.weights=E,k.length>0&&(l.extras={},l.extras.targetNames=k)}const C=Array.isArray(e.material);if(C&&o.groups.length===0)return null;const f=C?e.material:[e.material],x=C?o.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let E=0,k=x.length;E<k;E++){const S={mode:a,attributes:p};if(this.serializeUserData(o,S),h.length>0&&(S.targets=h),o.index!==null){let L=this.getUID(o.index);(x[E].start!==void 0||x[E].count!==void 0)&&(L+=":"+x[E].start+":"+x[E].count),t.attributes.has(L)?S.indices=t.attributes.get(L):(S.indices=this.processAccessor(o.index,o,x[E].start,x[E].count),t.attributes.set(L,S.indices)),S.indices===null&&delete S.indices}const v=this.processMaterial(f[x[E].materialIndex]);v!==null&&(S.material=v),w.push(S)}l.primitives=w,r.meshes||(r.meshes=[]),this._invokeAll(function(E){E.writeMesh&&E.writeMesh(e,l)});const T=r.meshes.push(l)-1;return t.meshes.set(s,T),T}detectMeshQuantization(e,t){if(this.extensionsUsed[Sr])return;let r;switch(t.array.constructor){case Int8Array:r="byte";break;case Uint8Array:r="unsigned byte";break;case Int16Array:r="short";break;case Uint16Array:r="unsigned short";break;default:return}t.normalized&&(r+=" normalized");const i=e.split("_",1)[0];Ms[i]&&Ms[i].includes(r)&&(this.extensionsUsed[Sr]=!0,this.extensionsRequired[Sr]=!0)}processCamera(e){const t=this.json;t.cameras||(t.cameras=[]);const r=e.isOrthographicCamera,i={type:r?"orthographic":"perspective"};return r?i.orthographic={xmag:e.right*2,ymag:e.top*2,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:i.perspective={aspectRatio:e.aspect,yfov:Nt.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},e.name!==""&&(i.name=e.type),t.cameras.push(i)-1}processAnimation(e,t){const r=this.json,i=this.nodeMap;r.animations||(r.animations=[]),e=oa.Utils.mergeMorphTargetTracks(e.clone(),t);const s=e.tracks,o=[],a=[];for(let l=0;l<s.length;++l){const p=s[l],w=zn.parseTrackName(p.name);let h=zn.findNode(t,w.nodeName);const M=Ts[w.propertyName];if(w.objectName==="bones"&&(h.isSkinnedMesh===!0?h=h.skeleton.getBoneByName(w.objectIndex):h=void 0),!h||!M)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',p.name),null;const P=1;let m=p.values.length/p.times.length;M===Ts.morphTargetInfluences&&(m/=h.morphTargetInfluences.length);let C;p.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline===!0?(C="CUBICSPLINE",m/=3):p.getInterpolation()===Ua?C="STEP":C="LINEAR",a.push({input:this.processAccessor(new At(p.times,P)),output:this.processAccessor(new At(p.values,m)),interpolation:C}),o.push({sampler:a.length-1,target:{node:i.get(h),path:M}})}return r.animations.push({name:e.name||"clip_"+r.animations.length,samplers:a,channels:o}),r.animations.length-1}processSkin(e){const t=this.json,r=this.nodeMap,i=t.nodes[r.get(e)],s=e.skeleton;if(s===void 0)return null;const o=e.skeleton.bones[0];if(o===void 0)return null;const a=[],l=new Float32Array(s.bones.length*16),p=new sn;for(let w=0;w<s.bones.length;++w)a.push(r.get(s.bones[w])),p.copy(s.boneInverses[w]),p.multiply(e.bindMatrix).toArray(l,w*16);return t.skins===void 0&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new At(l,16)),joints:a,skeleton:r.get(o)}),i.skin=t.skins.length-1}processNode(e){const t=this.json,r=this.options,i=this.nodeMap;t.nodes||(t.nodes=[]);const s={};if(r.trs){const a=e.quaternion.toArray(),l=e.position.toArray(),p=e.scale.toArray();en(a,[0,0,0,1])||(s.rotation=a),en(l,[0,0,0])||(s.translation=l),en(p,[1,1,1])||(s.scale=p)}else e.matrixAutoUpdate&&e.updateMatrix(),jh(e.matrix)===!1&&(s.matrix=e.matrix.elements);if(e.name!==""&&(s.name=String(e.name)),this.serializeUserData(e,s),e.isMesh||e.isLine||e.isPoints){const a=this.processMesh(e);a!==null&&(s.mesh=a)}else e.isCamera&&(s.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){const a=[];for(let l=0,p=e.children.length;l<p;l++){const w=e.children[l];if(w.visible||r.onlyVisible===!1){const h=this.processNode(w);h!==null&&a.push(h)}}a.length>0&&(s.children=a)}this._invokeAll(function(a){a.writeNode&&a.writeNode(e,s)});const o=t.nodes.push(s)-1;return i.set(e,o),o}processScene(e){const t=this.json,r=this.options;t.scenes||(t.scenes=[],t.scene=0);const i={};e.name!==""&&(i.name=e.name),t.scenes.push(i);const s=[];for(let o=0,a=e.children.length;o<a;o++){const l=e.children[o];if(l.visible||r.onlyVisible===!1){const p=this.processNode(l);p!==null&&s.push(p)}}s.length>0&&(i.nodes=s),this.serializeUserData(e,i)}processObjects(e){const t=new rn;t.name="AuxScene";for(let r=0;r<e.length;r++)t.children.push(e[r]);this.processScene(t)}processInput(e){const t=this.options;e=e instanceof Array?e:[e],this._invokeAll(function(i){i.beforeParse&&i.beforeParse(e)});const r=[];for(let i=0;i<e.length;i++)e[i]instanceof rn?this.processScene(e[i]):r.push(e[i]);r.length>0&&this.processObjects(r);for(let i=0;i<this.skins.length;++i)this.processSkin(this.skins[i]);for(let i=0;i<t.animations.length;++i)this.processAnimation(t.animations[i],e[0]);this._invokeAll(function(i){i.afterParse&&i.afterParse(e)})}_invokeAll(e){for(let t=0,r=this.plugins.length;t<r;t++)e(this.plugins[t])}}class Dh{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,t){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight){console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);return}const r=this.writer,i=r.json,s=r.extensionsUsed,o={};e.name&&(o.name=e.name),o.color=e.color.toArray(),o.intensity=e.intensity,e.isDirectionalLight?o.type="directional":e.isPointLight?(o.type="point",e.distance>0&&(o.range=e.distance)):e.isSpotLight&&(o.type="spot",e.distance>0&&(o.range=e.distance),o.spot={},o.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,o.spot.outerConeAngle=e.angle),e.decay!==void 0&&e.decay!==2&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),e.target&&(e.target.parent!==e||e.target.position.x!==0||e.target.position.y!==0||e.target.position.z!==-1)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),s[this.name]||(i.extensions=i.extensions||{},i.extensions[this.name]={lights:[]},s[this.name]=!0);const a=i.extensions[this.name].lights;a.push(o),t.extensions=t.extensions||{},t.extensions[this.name]={light:a.length-1}}}let Bh=class{constructor(n){this.writer=n,this.name="KHR_materials_unlit"}writeMaterial(n,e){if(!n.isMeshBasicMaterial)return;const t=this.writer.extensionsUsed;e.extensions=e.extensions||{},e.extensions[this.name]={},t[this.name]=!0,e.pbrMetallicRoughness.metallicFactor=0,e.pbrMetallicRoughness.roughnessFactor=.9}},Fh=class{constructor(n){this.writer=n,this.name="KHR_materials_clearcoat"}writeMaterial(n,e){if(!n.isMeshPhysicalMaterial||n.clearcoat===0)return;const t=this.writer,r=t.extensionsUsed,i={};if(i.clearcoatFactor=n.clearcoat,n.clearcoatMap){const s={index:t.processTexture(n.clearcoatMap),texCoord:n.clearcoatMap.channel};t.applyTextureTransform(s,n.clearcoatMap),i.clearcoatTexture=s}if(i.clearcoatRoughnessFactor=n.clearcoatRoughness,n.clearcoatRoughnessMap){const s={index:t.processTexture(n.clearcoatRoughnessMap),texCoord:n.clearcoatRoughnessMap.channel};t.applyTextureTransform(s,n.clearcoatRoughnessMap),i.clearcoatRoughnessTexture=s}if(n.clearcoatNormalMap){const s={index:t.processTexture(n.clearcoatNormalMap),texCoord:n.clearcoatNormalMap.channel};t.applyTextureTransform(s,n.clearcoatNormalMap),i.clearcoatNormalTexture=s}e.extensions=e.extensions||{},e.extensions[this.name]=i,r[this.name]=!0}},Uh=class{constructor(n){this.writer=n,this.name="KHR_materials_iridescence"}writeMaterial(n,e){if(!n.isMeshPhysicalMaterial||n.iridescence===0)return;const t=this.writer,r=t.extensionsUsed,i={};if(i.iridescenceFactor=n.iridescence,n.iridescenceMap){const s={index:t.processTexture(n.iridescenceMap),texCoord:n.iridescenceMap.channel};t.applyTextureTransform(s,n.iridescenceMap),i.iridescenceTexture=s}if(i.iridescenceIor=n.iridescenceIOR,i.iridescenceThicknessMinimum=n.iridescenceThicknessRange[0],i.iridescenceThicknessMaximum=n.iridescenceThicknessRange[1],n.iridescenceThicknessMap){const s={index:t.processTexture(n.iridescenceThicknessMap),texCoord:n.iridescenceThicknessMap.channel};t.applyTextureTransform(s,n.iridescenceThicknessMap),i.iridescenceThicknessTexture=s}e.extensions=e.extensions||{},e.extensions[this.name]=i,r[this.name]=!0}},zh=class{constructor(n){this.writer=n,this.name="KHR_materials_transmission"}writeMaterial(n,e){if(!n.isMeshPhysicalMaterial||n.transmission===0)return;const t=this.writer,r=t.extensionsUsed,i={};if(i.transmissionFactor=n.transmission,n.transmissionMap){const s={index:t.processTexture(n.transmissionMap),texCoord:n.transmissionMap.channel};t.applyTextureTransform(s,n.transmissionMap),i.transmissionTexture=s}e.extensions=e.extensions||{},e.extensions[this.name]=i,r[this.name]=!0}},Hh=class{constructor(n){this.writer=n,this.name="KHR_materials_volume"}writeMaterial(n,e){if(!n.isMeshPhysicalMaterial||n.transmission===0)return;const t=this.writer,r=t.extensionsUsed,i={};if(i.thicknessFactor=n.thickness,n.thicknessMap){const s={index:t.processTexture(n.thicknessMap),texCoord:n.thicknessMap.channel};t.applyTextureTransform(s,n.thicknessMap),i.thicknessTexture=s}i.attenuationDistance=n.attenuationDistance,i.attenuationColor=n.attenuationColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=i,r[this.name]=!0}},$h=class{constructor(n){this.writer=n,this.name="KHR_materials_ior"}writeMaterial(n,e){if(!n.isMeshPhysicalMaterial||n.ior===1.5)return;const t=this.writer.extensionsUsed,r={};r.ior=n.ior,e.extensions=e.extensions||{},e.extensions[this.name]=r,t[this.name]=!0}},Gh=class{constructor(n){this.writer=n,this.name="KHR_materials_specular"}writeMaterial(n,e){if(!n.isMeshPhysicalMaterial||n.specularIntensity===1&&n.specularColor.equals(kh)&&!n.specularIntensityMap&&!n.specularColorTexture)return;const t=this.writer,r=t.extensionsUsed,i={};if(n.specularIntensityMap){const s={index:t.processTexture(n.specularIntensityMap),texCoord:n.specularIntensityMap.channel};t.applyTextureTransform(s,n.specularIntensityMap),i.specularTexture=s}if(n.specularColorMap){const s={index:t.processTexture(n.specularColorMap),texCoord:n.specularColorMap.channel};t.applyTextureTransform(s,n.specularColorMap),i.specularColorTexture=s}i.specularFactor=n.specularIntensity,i.specularColorFactor=n.specularColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=i,r[this.name]=!0}},Kh=class{constructor(n){this.writer=n,this.name="KHR_materials_sheen"}writeMaterial(n,e){if(!n.isMeshPhysicalMaterial||n.sheen==0)return;const t=this.writer,r=t.extensionsUsed,i={};if(n.sheenRoughnessMap){const s={index:t.processTexture(n.sheenRoughnessMap),texCoord:n.sheenRoughnessMap.channel};t.applyTextureTransform(s,n.sheenRoughnessMap),i.sheenRoughnessTexture=s}if(n.sheenColorMap){const s={index:t.processTexture(n.sheenColorMap),texCoord:n.sheenColorMap.channel};t.applyTextureTransform(s,n.sheenColorMap),i.sheenColorTexture=s}i.sheenRoughnessFactor=n.sheenRoughness,i.sheenColorFactor=n.sheenColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=i,r[this.name]=!0}},Yh=class{constructor(n){this.writer=n,this.name="KHR_materials_anisotropy"}writeMaterial(n,e){if(!n.isMeshPhysicalMaterial||n.anisotropy==0)return;const t=this.writer,r=t.extensionsUsed,i={};if(n.anisotropyMap){const s={index:t.processTexture(n.anisotropyMap)};t.applyTextureTransform(s,n.anisotropyMap),i.anisotropyTexture=s}i.anisotropyStrength=n.anisotropy,i.anisotropyRotation=n.anisotropyRotation,e.extensions=e.extensions||{},e.extensions[this.name]=i,r[this.name]=!0}},Wh=class{constructor(n){this.writer=n,this.name="KHR_materials_emissive_strength"}writeMaterial(n,e){if(!n.isMeshStandardMaterial||n.emissiveIntensity===1)return;const t=this.writer.extensionsUsed,r={};r.emissiveStrength=n.emissiveIntensity,e.extensions=e.extensions||{},e.extensions[this.name]=r,t[this.name]=!0}};var wn=Uint8Array,la=Uint16Array,qh=Uint32Array,Zh=new wn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Jh=new wn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ua=function(n,e){for(var t=new la(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];for(var i=new qh(t[30]),r=1;r<30;++r)for(var s=t[r];s<t[r+1];++s)i[s]=s-t[r]<<5|r;return[t,i]},ca=ua(Zh,2),Qh=ca[0],Xh=ca[1];Qh[28]=258,Xh[258]=28;ua(Jh,0);var em=new la(32768);for(var pe=0;pe<32768;++pe){var mt=(pe&43690)>>>1|(pe&21845)<<1;mt=(mt&52428)>>>2|(mt&13107)<<2,mt=(mt&61680)>>>4|(mt&3855)<<4,em[pe]=((mt&65280)>>>8|(mt&255)<<8)>>>1}var ur=new wn(288);for(var pe=0;pe<144;++pe)ur[pe]=8;for(var pe=144;pe<256;++pe)ur[pe]=9;for(var pe=256;pe<280;++pe)ur[pe]=7;for(var pe=280;pe<288;++pe)ur[pe]=8;var tm=new wn(32);for(var pe=0;pe<32;++pe)tm[pe]=5;var nm=new wn(0),rm=typeof TextDecoder<"u"&&new TextDecoder,im=0;try{rm.decode(nm,{stream:!0}),im=1}catch{}new Ea;new J;new Bs(0,0,0,"YXZ");new J;var sm=Object.defineProperty,om=(n,e,t)=>e in n?sm(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,G=(n,e,t)=>(om(n,typeof e!="symbol"?e+"":e,t),t);const In=new Ma,As=new Fs,am=Math.cos(70*(Math.PI/180)),Os=(n,e)=>(n%e+e)%e;class lm extends Da{constructor(e,t){super(),G(this,"object"),G(this,"domElement"),G(this,"enabled",!0),G(this,"target",new J),G(this,"minDistance",0),G(this,"maxDistance",1/0),G(this,"minZoom",0),G(this,"maxZoom",1/0),G(this,"minPolarAngle",0),G(this,"maxPolarAngle",Math.PI),G(this,"minAzimuthAngle",-1/0),G(this,"maxAzimuthAngle",1/0),G(this,"enableDamping",!1),G(this,"dampingFactor",.05),G(this,"enableZoom",!0),G(this,"zoomSpeed",1),G(this,"enableRotate",!0),G(this,"rotateSpeed",1),G(this,"enablePan",!0),G(this,"panSpeed",1),G(this,"screenSpacePanning",!0),G(this,"keyPanSpeed",7),G(this,"zoomToCursor",!1),G(this,"autoRotate",!1),G(this,"autoRotateSpeed",2),G(this,"reverseOrbit",!1),G(this,"reverseHorizontalOrbit",!1),G(this,"reverseVerticalOrbit",!1),G(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),G(this,"mouseButtons",{LEFT:Tt.ROTATE,MIDDLE:Tt.DOLLY,RIGHT:Tt.PAN}),G(this,"touches",{ONE:ft.ROTATE,TWO:ft.DOLLY_PAN}),G(this,"target0"),G(this,"position0"),G(this,"zoom0"),G(this,"_domElementKeyEvents",null),G(this,"getPolarAngle"),G(this,"getAzimuthalAngle"),G(this,"setPolarAngle"),G(this,"setAzimuthalAngle"),G(this,"getDistance"),G(this,"listenToKeyEvents"),G(this,"stopListenToKeyEvents"),G(this,"saveState"),G(this,"reset"),G(this,"update"),G(this,"connect"),G(this,"dispose"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>w.phi,this.getAzimuthalAngle=()=>w.theta,this.setPolarAngle=I=>{let D=Os(I,2*Math.PI),$=w.phi;$<0&&($+=2*Math.PI),D<0&&(D+=2*Math.PI);let oe=Math.abs(D-$);2*Math.PI-oe<oe&&(D<$?D+=2*Math.PI:$+=2*Math.PI),h.phi=D-$,r.update()},this.setAzimuthalAngle=I=>{let D=Os(I,2*Math.PI),$=w.theta;$<0&&($+=2*Math.PI),D<0&&(D+=2*Math.PI);let oe=Math.abs(D-$);2*Math.PI-oe<oe&&(D<$?D+=2*Math.PI:$+=2*Math.PI),h.theta=D-$,r.update()},this.getDistance=()=>r.object.position.distanceTo(r.target),this.listenToKeyEvents=I=>{I.addEventListener("keydown",pr),this._domElementKeyEvents=I},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",pr),this._domElementKeyEvents=null},this.saveState=()=>{r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=()=>{r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(i),r.update(),l=a.NONE},this.update=(()=>{const I=new J,D=new J(0,1,0),$=new Bi().setFromUnitVectors(e.up,D),oe=$.clone().invert(),Re=new J,$e=new Bi,yn=2*Math.PI;return function(){const ji=r.object.position;$.setFromUnitVectors(e.up,D),oe.copy($).invert(),I.copy(ji).sub(r.target),I.applyQuaternion($),w.setFromVector3(I),r.autoRotate&&l===a.NONE&&j(A()),r.enableDamping?(w.theta+=h.theta*r.dampingFactor,w.phi+=h.phi*r.dampingFactor):(w.theta+=h.theta,w.phi+=h.phi);let nt=r.minAzimuthAngle,rt=r.maxAzimuthAngle;isFinite(nt)&&isFinite(rt)&&(nt<-Math.PI?nt+=yn:nt>Math.PI&&(nt-=yn),rt<-Math.PI?rt+=yn:rt>Math.PI&&(rt-=yn),nt<=rt?w.theta=Math.max(nt,Math.min(rt,w.theta)):w.theta=w.theta>(nt+rt)/2?Math.max(nt,w.theta):Math.min(rt,w.theta)),w.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,w.phi)),w.makeSafe(),r.enableDamping===!0?r.target.addScaledVector(P,r.dampingFactor):r.target.add(P),r.zoomToCursor&&b||r.object.isOrthographicCamera?w.radius=U(w.radius):w.radius=U(w.radius*M),I.setFromSpherical(w),I.applyQuaternion(oe),ji.copy(r.target).add(I),r.object.matrixAutoUpdate||r.object.updateMatrix(),r.object.lookAt(r.target),r.enableDamping===!0?(h.theta*=1-r.dampingFactor,h.phi*=1-r.dampingFactor,P.multiplyScalar(1-r.dampingFactor)):(h.set(0,0,0),P.set(0,0,0));let $t=!1;if(r.zoomToCursor&&b){let Gt=null;if(r.object instanceof Ke&&r.object.isPerspectiveCamera){const Kt=I.length();Gt=U(Kt*M);const _n=Kt-Gt;r.object.position.addScaledVector(L,_n),r.object.updateMatrixWorld()}else if(r.object.isOrthographicCamera){const Kt=new J(d.x,d.y,0);Kt.unproject(r.object),r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/M)),r.object.updateProjectionMatrix(),$t=!0;const _n=new J(d.x,d.y,0);_n.unproject(r.object),r.object.position.sub(_n).add(Kt),r.object.updateMatrixWorld(),Gt=I.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),r.zoomToCursor=!1;Gt!==null&&(r.screenSpacePanning?r.target.set(0,0,-1).transformDirection(r.object.matrix).multiplyScalar(Gt).add(r.object.position):(In.origin.copy(r.object.position),In.direction.set(0,0,-1).transformDirection(r.object.matrix),Math.abs(r.object.up.dot(In.direction))<am?e.lookAt(r.target):(As.setFromNormalAndCoplanarPoint(r.object.up,r.target),In.intersectPlane(As,r.target))))}else r.object instanceof Ot&&r.object.isOrthographicCamera&&($t=M!==1,$t&&(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/M)),r.object.updateProjectionMatrix()));return M=1,b=!1,$t||Re.distanceToSquared(r.object.position)>p||8*(1-$e.dot(r.object.quaternion))>p?(r.dispatchEvent(i),Re.copy(r.object.position),$e.copy(r.object.quaternion),$t=!1,!0):!1}})(),this.connect=I=>{I===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),r.domElement=I,r.domElement.style.touchAction="none",r.domElement.addEventListener("contextmenu",Ai),r.domElement.addEventListener("pointerdown",me),r.domElement.addEventListener("pointercancel",yt),r.domElement.addEventListener("wheel",We,{passive:!0})},this.dispose=()=>{var I,D,$,oe,Re,$e;r.domElement&&(r.domElement.style.touchAction="auto"),(I=r.domElement)==null||I.removeEventListener("contextmenu",Ai),(D=r.domElement)==null||D.removeEventListener("pointerdown",me),($=r.domElement)==null||$.removeEventListener("pointercancel",yt),(oe=r.domElement)==null||oe.removeEventListener("wheel",We),(Re=r.domElement)==null||Re.ownerDocument.removeEventListener("pointermove",de),($e=r.domElement)==null||$e.ownerDocument.removeEventListener("pointerup",Ue),r._domElementKeyEvents!==null&&r._domElementKeyEvents.removeEventListener("keydown",pr)};const r=this,i={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=a.NONE;const p=1e-6,w=new Fi,h=new Fi;let M=1;const P=new J,m=new ye,C=new ye,f=new ye,x=new ye,T=new ye,E=new ye,k=new ye,S=new ye,v=new ye,L=new J,d=new ye;let b=!1;const u=[],y={};function A(){return 2*Math.PI/60/60*r.autoRotateSpeed}function F(){return Math.pow(.95,r.zoomSpeed)}function j(I){r.reverseOrbit||r.reverseHorizontalOrbit?h.theta+=I:h.theta-=I}function z(I){r.reverseOrbit||r.reverseVerticalOrbit?h.phi+=I:h.phi-=I}const R=(()=>{const I=new J;return function(D,$){I.setFromMatrixColumn($,0),I.multiplyScalar(-D),P.add(I)}})(),H=(()=>{const I=new J;return function(D,$){r.screenSpacePanning===!0?I.setFromMatrixColumn($,1):(I.setFromMatrixColumn($,0),I.crossVectors(r.object.up,I)),I.multiplyScalar(D),P.add(I)}})(),te=(()=>{const I=new J;return function(D,$){const oe=r.domElement;if(oe&&r.object instanceof Ke&&r.object.isPerspectiveCamera){const Re=r.object.position;I.copy(Re).sub(r.target);let $e=I.length();$e*=Math.tan(r.object.fov/2*Math.PI/180),R(2*D*$e/oe.clientHeight,r.object.matrix),H(2*$*$e/oe.clientHeight,r.object.matrix)}else oe&&r.object instanceof Ot&&r.object.isOrthographicCamera?(R(D*(r.object.right-r.object.left)/r.object.zoom/oe.clientWidth,r.object.matrix),H($*(r.object.top-r.object.bottom)/r.object.zoom/oe.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}})();function ee(I){r.object instanceof Ke&&r.object.isPerspectiveCamera||r.object instanceof Ot&&r.object.isOrthographicCamera?M/=I:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function Z(I){r.object instanceof Ke&&r.object.isPerspectiveCamera||r.object instanceof Ot&&r.object.isOrthographicCamera?M*=I:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function Pe(I){if(!r.zoomToCursor||!r.domElement)return;b=!0;const D=r.domElement.getBoundingClientRect(),$=I.clientX-D.left,oe=I.clientY-D.top,Re=D.width,$e=D.height;d.x=$/Re*2-1,d.y=-(oe/$e)*2+1,L.set(d.x,d.y,1).unproject(r.object).sub(r.object.position).normalize()}function U(I){return Math.max(r.minDistance,Math.min(r.maxDistance,I))}function Q(I){m.set(I.clientX,I.clientY)}function se(I){Pe(I),k.set(I.clientX,I.clientY)}function we(I){x.set(I.clientX,I.clientY)}function Le(I){C.set(I.clientX,I.clientY),f.subVectors(C,m).multiplyScalar(r.rotateSpeed);const D=r.domElement;D&&(j(2*Math.PI*f.x/D.clientHeight),z(2*Math.PI*f.y/D.clientHeight)),m.copy(C),r.update()}function Fe(I){S.set(I.clientX,I.clientY),v.subVectors(S,k),v.y>0?ee(F()):v.y<0&&Z(F()),k.copy(S),r.update()}function N(I){T.set(I.clientX,I.clientY),E.subVectors(T,x).multiplyScalar(r.panSpeed),te(E.x,E.y),x.copy(T),r.update()}function c(I){Pe(I),I.deltaY<0?Z(F()):I.deltaY>0&&ee(F()),r.update()}function g(I){let D=!1;switch(I.code){case r.keys.UP:te(0,r.keyPanSpeed),D=!0;break;case r.keys.BOTTOM:te(0,-r.keyPanSpeed),D=!0;break;case r.keys.LEFT:te(r.keyPanSpeed,0),D=!0;break;case r.keys.RIGHT:te(-r.keyPanSpeed,0),D=!0;break}D&&(I.preventDefault(),r.update())}function _(){if(u.length==1)m.set(u[0].pageX,u[0].pageY);else{const I=.5*(u[0].pageX+u[1].pageX),D=.5*(u[0].pageY+u[1].pageY);m.set(I,D)}}function V(){if(u.length==1)x.set(u[0].pageX,u[0].pageY);else{const I=.5*(u[0].pageX+u[1].pageX),D=.5*(u[0].pageY+u[1].pageY);x.set(I,D)}}function O(){const I=u[0].pageX-u[1].pageX,D=u[0].pageY-u[1].pageY,$=Math.sqrt(I*I+D*D);k.set(0,$)}function B(){r.enableZoom&&O(),r.enablePan&&V()}function Y(){r.enableZoom&&O(),r.enableRotate&&_()}function ue(I){if(u.length==1)C.set(I.pageX,I.pageY);else{const $=hr(I),oe=.5*(I.pageX+$.x),Re=.5*(I.pageY+$.y);C.set(oe,Re)}f.subVectors(C,m).multiplyScalar(r.rotateSpeed);const D=r.domElement;D&&(j(2*Math.PI*f.x/D.clientHeight),z(2*Math.PI*f.y/D.clientHeight)),m.copy(C)}function ce(I){if(u.length==1)T.set(I.pageX,I.pageY);else{const D=hr(I),$=.5*(I.pageX+D.x),oe=.5*(I.pageY+D.y);T.set($,oe)}E.subVectors(T,x).multiplyScalar(r.panSpeed),te(E.x,E.y),x.copy(T)}function Ee(I){const D=hr(I),$=I.pageX-D.x,oe=I.pageY-D.y,Re=Math.sqrt($*$+oe*oe);S.set(0,Re),v.set(0,Math.pow(S.y/k.y,r.zoomSpeed)),ee(v.y),k.copy(S)}function ge(I){r.enableZoom&&Ee(I),r.enablePan&&ce(I)}function be(I){r.enableZoom&&Ee(I),r.enableRotate&&ue(I)}function me(I){var D,$;r.enabled!==!1&&(u.length===0&&((D=r.domElement)==null||D.ownerDocument.addEventListener("pointermove",de),($=r.domElement)==null||$.ownerDocument.addEventListener("pointerup",Ue)),wa(I),I.pointerType==="touch"?va(I):cr(I))}function de(I){r.enabled!==!1&&(I.pointerType==="touch"?ga(I):dr(I))}function Ue(I){var D,$,oe;Oi(I),u.length===0&&((D=r.domElement)==null||D.releasePointerCapture(I.pointerId),($=r.domElement)==null||$.ownerDocument.removeEventListener("pointermove",de),(oe=r.domElement)==null||oe.ownerDocument.removeEventListener("pointerup",Ue)),r.dispatchEvent(o),l=a.NONE}function yt(I){Oi(I)}function cr(I){let D;switch(I.button){case 0:D=r.mouseButtons.LEFT;break;case 1:D=r.mouseButtons.MIDDLE;break;case 2:D=r.mouseButtons.RIGHT;break;default:D=-1}switch(D){case Tt.DOLLY:if(r.enableZoom===!1)return;se(I),l=a.DOLLY;break;case Tt.ROTATE:if(I.ctrlKey||I.metaKey||I.shiftKey){if(r.enablePan===!1)return;we(I),l=a.PAN}else{if(r.enableRotate===!1)return;Q(I),l=a.ROTATE}break;case Tt.PAN:if(I.ctrlKey||I.metaKey||I.shiftKey){if(r.enableRotate===!1)return;Q(I),l=a.ROTATE}else{if(r.enablePan===!1)return;we(I),l=a.PAN}break;default:l=a.NONE}l!==a.NONE&&r.dispatchEvent(s)}function dr(I){if(r.enabled!==!1)switch(l){case a.ROTATE:if(r.enableRotate===!1)return;Le(I);break;case a.DOLLY:if(r.enableZoom===!1)return;Fe(I);break;case a.PAN:if(r.enablePan===!1)return;N(I);break}}function We(I){r.enabled===!1||r.enableZoom===!1||l!==a.NONE&&l!==a.ROTATE||(r.dispatchEvent(s),c(I),r.dispatchEvent(o))}function pr(I){r.enabled===!1||r.enablePan===!1||g(I)}function va(I){switch(Vi(I),u.length){case 1:switch(r.touches.ONE){case ft.ROTATE:if(r.enableRotate===!1)return;_(),l=a.TOUCH_ROTATE;break;case ft.PAN:if(r.enablePan===!1)return;V(),l=a.TOUCH_PAN;break;default:l=a.NONE}break;case 2:switch(r.touches.TWO){case ft.DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;B(),l=a.TOUCH_DOLLY_PAN;break;case ft.DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;Y(),l=a.TOUCH_DOLLY_ROTATE;break;default:l=a.NONE}break;default:l=a.NONE}l!==a.NONE&&r.dispatchEvent(s)}function ga(I){switch(Vi(I),l){case a.TOUCH_ROTATE:if(r.enableRotate===!1)return;ue(I),r.update();break;case a.TOUCH_PAN:if(r.enablePan===!1)return;ce(I),r.update();break;case a.TOUCH_DOLLY_PAN:if(r.enableZoom===!1&&r.enablePan===!1)return;ge(I),r.update();break;case a.TOUCH_DOLLY_ROTATE:if(r.enableZoom===!1&&r.enableRotate===!1)return;be(I),r.update();break;default:l=a.NONE}}function Ai(I){r.enabled!==!1&&I.preventDefault()}function wa(I){u.push(I)}function Oi(I){delete y[I.pointerId];for(let D=0;D<u.length;D++)if(u[D].pointerId==I.pointerId){u.splice(D,1);return}}function Vi(I){let D=y[I.pointerId];D===void 0&&(D=new ye,y[I.pointerId]=D),D.set(I.pageX,I.pageY)}function hr(I){const D=I.pointerId===u[0].pointerId?u[1]:u[0];return y[D.pointerId]}t!==void 0&&this.connect(t),this.update()}}new sn;new J;new Bs;new J;var um=Object.defineProperty,cm=(n,e,t)=>e in n?um(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ki=(n,e,t)=>(cm(n,typeof e!="symbol"?e+"":e,t),t);class da{constructor(e){ki(this,"data"),this.data=e}generateShapes(e,t=100,r){const i=[],s={letterSpacing:0,lineHeight:1,...r},o=dm(e,t,this.data,s);for(let a=0,l=o.length;a<l;a++)Array.prototype.push.apply(i,o[a].toShapes(!1));return i}}ki(da,"isFont");ki(da,"type");function dm(n,e,t,r){const i=Array.from(n),s=e/t.resolution,o=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*s,a=[];let l=0,p=0;for(let w=0;w<i.length;w++){const h=i[w];if(h===`
`)l=0,p-=o*r.lineHeight;else{const M=pm(h,s,l,p,t);M&&(l+=M.offsetX+r.letterSpacing,a.push(M.path))}}return a}function pm(n,e,t,r,i){const s=i.glyphs[n]||i.glyphs["?"];if(!s){console.error('THREE.Font: character "'+n+'" does not exists in font family '+i.familyName+".");return}const o=new za;let a,l,p,w,h,M,P,m;if(s.o){const C=s._cachedOutline||(s._cachedOutline=s.o.split(" "));for(let f=0,x=C.length;f<x;)switch(C[f++]){case"m":a=parseInt(C[f++])*e+t,l=parseInt(C[f++])*e+r,o.moveTo(a,l);break;case"l":a=parseInt(C[f++])*e+t,l=parseInt(C[f++])*e+r,o.lineTo(a,l);break;case"q":p=parseInt(C[f++])*e+t,w=parseInt(C[f++])*e+r,h=parseInt(C[f++])*e+t,M=parseInt(C[f++])*e+r,o.quadraticCurveTo(h,M,p,w);break;case"b":p=parseInt(C[f++])*e+t,w=parseInt(C[f++])*e+r,h=parseInt(C[f++])*e+t,M=parseInt(C[f++])*e+r,P=parseInt(C[f++])*e+t,m=parseInt(C[f++])*e+r,o.bezierCurveTo(h,M,P,m,p,w);break}}return{offsetX:s.ha*e,path:o}}class dn extends xt{constructor(e,t={}){super(e),this.isReflector=!0,this.type="Reflector",this.camera=new Ke;const r=this,i=t.color!==void 0?new Ze(t.color):new Ze(8355711),s=t.textureWidth||512,o=t.textureHeight||512,a=t.clipBias||0,l=t.shader||dn.ReflectorShader,p=t.multisample!==void 0?t.multisample:4,w=new Fs,h=new J,M=new J,P=new J,m=new sn,C=new J(0,0,-1),f=new Ct,x=new J,T=new J,E=new Ct,k=new sn,S=this.camera,v=new Aa(s,o,{samples:p,type:Oa}),L=new Jn({name:l.name!==void 0?l.name:"unspecified",uniforms:Wr.clone(l.uniforms),fragmentShader:l.fragmentShader,vertexShader:l.vertexShader});L.uniforms.tDiffuse.value=v.texture,L.uniforms.color.value=i,L.uniforms.textureMatrix.value=k,this.material=L,this.onBeforeRender=function(d,b,u){if(M.setFromMatrixPosition(r.matrixWorld),P.setFromMatrixPosition(u.matrixWorld),m.extractRotation(r.matrixWorld),h.set(0,0,1),h.applyMatrix4(m),x.subVectors(M,P),x.dot(h)>0)return;x.reflect(h).negate(),x.add(M),m.extractRotation(u.matrixWorld),C.set(0,0,-1),C.applyMatrix4(m),C.add(P),T.subVectors(M,C),T.reflect(h).negate(),T.add(M),S.position.copy(x),S.up.set(0,1,0),S.up.applyMatrix4(m),S.up.reflect(h),S.lookAt(T),S.far=u.far,S.updateMatrixWorld(),S.projectionMatrix.copy(u.projectionMatrix),k.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),k.multiply(S.projectionMatrix),k.multiply(S.matrixWorldInverse),k.multiply(r.matrixWorld),w.setFromNormalAndCoplanarPoint(h,M),w.applyMatrix4(S.matrixWorldInverse),f.set(w.normal.x,w.normal.y,w.normal.z,w.constant);const y=S.projectionMatrix;E.x=(Math.sign(f.x)+y.elements[8])/y.elements[0],E.y=(Math.sign(f.y)+y.elements[9])/y.elements[5],E.z=-1,E.w=(1+y.elements[10])/y.elements[14],f.multiplyScalar(2/f.dot(E)),y.elements[2]=f.x,y.elements[6]=f.y,y.elements[10]=f.z+1-a,y.elements[14]=f.w,r.visible=!1;const A=d.getRenderTarget(),F=d.xr.enabled,j=d.shadowMap.autoUpdate;d.xr.enabled=!1,d.shadowMap.autoUpdate=!1,d.setRenderTarget(v),d.state.buffers.depth.setMask(!0),d.autoClear===!1&&d.clear(),d.render(b,S),d.xr.enabled=F,d.shadowMap.autoUpdate=j,d.setRenderTarget(A);const z=u.viewport;z!==void 0&&d.state.viewport(z),r.visible=!0},this.getRenderTarget=function(){return v},this.dispose=function(){v.dispose(),r.material.dispose()}}}dn.ReflectorShader={name:"ReflectorShader",uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:`
		uniform mat4 textureMatrix;
		varying vec4 vUv;

		#include <common>
		#include <logdepthbuf_pars_vertex>

		void main() {

			vUv = textureMatrix * vec4( position, 1.0 );

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

			#include <logdepthbuf_vertex>

		}`,fragmentShader:`
		uniform vec3 color;
		uniform sampler2D tDiffuse;
		varying vec4 vUv;

		#include <logdepthbuf_pars_fragment>

		float blendOverlay( float base, float blend ) {

			return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );

		}

		vec3 blendOverlay( vec3 base, vec3 blend ) {

			return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );

		}

		void main() {

			#include <logdepthbuf_fragment>

			vec4 base = texture2DProj( tDiffuse, vUv );
			gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>

		}`};const hm=["args","material-uniforms-color-value"],mm=Vt("TresPlaneGeometry",{args:[5,5]},null,-1);dn.ReflectorShader;function fm(n){return $s()?(Gs(n),!0):!1}function pa(n){return typeof n=="function"?n():q(n)}const vm=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const gm=Object.prototype.toString,wm=n=>gm.call(n)==="[object Object]",bm=()=>{};function ym(n){var e;const t=pa(n);return(e=t==null?void 0:t.$el)!=null?e:t}const _m=vm?window:void 0;function Lr(...n){let e,t,r,i;if(typeof n[0]=="string"||Array.isArray(n[0])?([t,r,i]=n,e=_m):[e,t,r,i]=n,!e)return bm;Array.isArray(t)||(t=[t]),Array.isArray(r)||(r=[r]);const s=[],o=()=>{s.forEach(w=>w()),s.length=0},a=(w,h,M,P)=>(w.addEventListener(h,M,P),()=>w.removeEventListener(h,M,P)),l=Me(()=>[ym(e),pa(i)],([w,h])=>{if(o(),!w)return;const M=wm(h)?{...h}:h;s.push(...t.flatMap(P=>r.map(m=>a(w,P,m,M))))},{immediate:!0,flush:"post"}),p=()=>{l(),o()};return fm(p),p}class qn extends xt{constructor(){super(qn.Geometry,new Ds({opacity:0,transparent:!0})),this.isLensflare=!0,this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;const e=new J,t=new J,r=new Ni(16,16),i=new Ni(16,16);let s=Di;const o=qn.Geometry,a=new mr({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;

				void main() {

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				void main() {

					gl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );

				}`,depthTest:!0,depthWrite:!1,transparent:!1}),l=new mr({uniforms:{map:{value:r},scale:{value:null},screenPosition:{value:null}},vertexShader:`

				precision highp float;

				uniform vec3 screenPosition;
				uniform vec2 scale;

				attribute vec3 position;
				attribute vec2 uv;

				varying vec2 vUV;

				void main() {

					vUV = uv;

					gl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );

				}`,fragmentShader:`

				precision highp float;

				uniform sampler2D map;

				varying vec2 vUV;

				void main() {

					gl_FragColor = texture2D( map, vUV );

				}`,depthTest:!1,depthWrite:!1,transparent:!1}),p=new xt(o,a),w=[],h=ha.Shader,M=new mr({name:h.name,uniforms:{map:{value:null},occlusionMap:{value:i},color:{value:new Ze(16777215)},scale:{value:new ye},screenPosition:{value:new J}},vertexShader:h.vertexShader,fragmentShader:h.fragmentShader,blending:Va,transparent:!0,depthWrite:!1}),P=new xt(o,M);this.addElement=function(T){w.push(T)};const m=new ye,C=new ye,f=new ja,x=new Ct;this.onBeforeRender=function(T,E,k){T.getCurrentViewport(x);const S=T.getRenderTarget(),v=S!==null?S.texture.type:Di;s!==v&&(r.dispose(),i.dispose(),r.type=i.type=v,s=v);const L=x.w/x.z,d=x.z/2,b=x.w/2;let u=16/x.w;if(m.set(u*L,u),f.min.set(x.x,x.y),f.max.set(x.x+(x.z-16),x.y+(x.w-16)),t.setFromMatrixPosition(this.matrixWorld),t.applyMatrix4(k.matrixWorldInverse),!(t.z>0)&&(e.copy(t).applyMatrix4(k.projectionMatrix),C.x=x.x+e.x*d+d-8,C.y=x.y+e.y*b+b-8,f.containsPoint(C))){T.copyFramebufferToTexture(C,r);let y=a.uniforms;y.scale.value=m,y.screenPosition.value=e,T.renderBufferDirect(k,null,o,a,p,null),T.copyFramebufferToTexture(C,i),y=l.uniforms,y.scale.value=m,y.screenPosition.value=e,T.renderBufferDirect(k,null,o,l,p,null);const A=-e.x*2,F=-e.y*2;for(let j=0,z=w.length;j<z;j++){const R=w[j],H=M.uniforms;H.color.value.copy(R.color),H.map.value=R.texture,H.screenPosition.value.x=e.x+A*R.distance,H.screenPosition.value.y=e.y+F*R.distance,u=R.size/x.w;const te=x.w/x.z;H.scale.value.set(u*te,u),M.uniformsNeedUpdate=!0,T.renderBufferDirect(k,null,o,M,P,null)}}},this.dispose=function(){a.dispose(),l.dispose(),M.dispose(),r.dispose(),i.dispose();for(let T=0,E=w.length;T<E;T++)w[T].texture.dispose()}}}class ha{constructor(e,t=1,r=0,i=new Ze(16777215)){this.texture=e,this.size=t,this.distance=r,this.color=i}}ha.Shader={name:"LensflareElementShader",uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:`

		precision highp float;

		uniform vec3 screenPosition;
		uniform vec2 scale;

		uniform sampler2D occlusionMap;

		attribute vec3 position;
		attribute vec2 uv;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vUV = uv;

			vec2 pos = position.xy;

			vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );
			visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );
			visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );

			vVisibility =        visibility.r / 9.0;
			vVisibility *= 1.0 - visibility.g / 9.0;
			vVisibility *=       visibility.b / 9.0;

			gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );

		}`,fragmentShader:`

		precision highp float;

		uniform sampler2D map;
		uniform vec3 color;

		varying vec2 vUV;
		varying float vVisibility;

		void main() {

			vec4 texture = texture2D( map, vUV );
			texture.a *= vVisibility;
			gl_FragColor = texture;
			gl_FragColor.rgb *= color;

		}`};qn.Geometry=function(){const n=new Ta,e=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),t=new Sa(e,5);return n.setIndex([0,1,2,0,2,3]),n.setAttribute("position",new Ri(t,3,0,!1)),n.setAttribute("uv",new Ri(t,2,3,!1)),n}();Nt.clamp;Nt.lerp;const xm=["target","auto-rotate","auto-rotate-speed","enable-damping","damping-factor","enable-pan","key-pan-speed","keys","max-azimuth-angle","min-azimuth-angle","max-polar-angle","min-polar-angle","min-distance","max-distance","min-zoom","max-zoom","touches","enable-zoom","zoom-speed","enable-rotate","rotate-speed","args"],Cm=Dt({__name:"OrbitControls",props:{makeDefault:{type:Boolean,default:!1},camera:{},domElement:{},target:{default:()=>[0,0,0]},enableDamping:{type:Boolean,default:!0},dampingFactor:{default:.05},autoRotate:{type:Boolean,default:!1},autoRotateSpeed:{default:2},enablePan:{type:Boolean,default:!0},keyPanSpeed:{default:7},keys:{},maxAzimuthAngle:{default:Number.POSITIVE_INFINITY},minAzimuthAngle:{default:Number.NEGATIVE_INFINITY},maxPolarAngle:{default:Math.PI},minPolarAngle:{default:0},minDistance:{default:0},maxDistance:{default:Number.POSITIVE_INFINITY},minZoom:{default:0},maxZoom:{default:Number.POSITIVE_INFINITY},touches:{default:()=>({ONE:ft.ROTATE,TWO:ft.DOLLY_PAN})},enableZoom:{type:Boolean,default:!0},zoomSpeed:{default:1},enableRotate:{type:Boolean,default:!0},rotateSpeed:{default:1}},emits:["change","start","end"],setup(n,{expose:e,emit:t}){const r=n,i=t,{makeDefault:s,autoRotate:o,autoRotateSpeed:a,enableDamping:l,dampingFactor:p,enablePan:w,keyPanSpeed:h,maxAzimuthAngle:M,minAzimuthAngle:P,maxPolarAngle:m,minPolarAngle:C,minDistance:f,maxDistance:x,minZoom:T,maxZoom:E,enableZoom:k,zoomSpeed:S,enableRotate:v,touches:L,rotateSpeed:d,target:b}=Qn(r),{camera:u,renderer:y,extend:A,controls:F}=ti(),j=W(null);A({OrbitControls:lm}),Me(j,H=>{z(),H&&s.value?F.value=H:F.value=null});function z(){Lr(j.value,"change",()=>i("change",j.value)),Lr(j.value,"start",()=>i("start",j.value)),Lr(j.value,"end",()=>i("end",j.value))}const{onLoop:R}=ao();return R(()=>{j.value&&(l.value||o.value)&&j.value.update()}),wt(()=>{j.value&&j.value.dispose()}),e({value:j}),(H,te)=>(H.camera||q(u))&&(H.domElement||q(y))?(Ge(),st("TresOrbitControls",{key:0,ref_key:"controlsRef",ref:j,target:q(b),"auto-rotate":q(o),"auto-rotate-speed":q(a),"enable-damping":q(l),"damping-factor":q(p),"enable-pan":q(w),"key-pan-speed":q(h),keys:H.keys,"max-azimuth-angle":q(M),"min-azimuth-angle":q(P),"max-polar-angle":q(m),"min-polar-angle":q(C),"min-distance":q(f),"max-distance":q(x),"min-zoom":q(T),"max-zoom":q(E),touches:q(L),"enable-zoom":q(k),"zoom-speed":q(S),"enable-rotate":q(v),"rotate-speed":q(d),args:[H.camera||q(u),H.domElement||q(y).domElement]},null,8,xm)):Zs("",!0)}});var Ir;/Mac/.test((Ir=globalThis==null?void 0:globalThis.navigator)===null||Ir===void 0?void 0:Ir.platform);var Pm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function An(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Em={exports:{}};(function(n,e){(function(t){n.exports=t()})(function(){return function t(r,i,s){function o(p,w){if(!i[p]){if(!r[p]){var h=typeof An=="function"&&An;if(!w&&h)return h(p,!0);if(a)return a(p,!0);throw new Error("Cannot find module '"+p+"'")}w=i[p]={exports:{}},r[p][0].call(w.exports,function(M){var P=r[p][1][M];return o(P||M)},w,w.exports,t,r,i,s)}return i[p].exports}for(var a=typeof An=="function"&&An,l=0;l<s.length;l++)o(s[l]);return o}({1:[function(t,r,i){(function(s,o,a,l,p,w,h,M,P){var m=t("crypto");function C(v,L){L=T(v,L);var d;return(d=L.algorithm!=="passthrough"?m.createHash(L.algorithm):new S).write===void 0&&(d.write=d.update,d.end=d.update),k(L,d).dispatch(v),d.update||d.end(""),d.digest?d.digest(L.encoding==="buffer"?void 0:L.encoding):(v=d.read(),L.encoding!=="buffer"?v.toString(L.encoding):v)}(i=r.exports=C).sha1=function(v){return C(v)},i.keys=function(v){return C(v,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},i.MD5=function(v){return C(v,{algorithm:"md5",encoding:"hex"})},i.keysMD5=function(v){return C(v,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var f=m.getHashes?m.getHashes().slice():["sha1","md5"],x=(f.push("passthrough"),["buffer","hex","binary","base64"]);function T(v,L){var d={};if(d.algorithm=(L=L||{}).algorithm||"sha1",d.encoding=L.encoding||"hex",d.excludeValues=!!L.excludeValues,d.algorithm=d.algorithm.toLowerCase(),d.encoding=d.encoding.toLowerCase(),d.ignoreUnknown=L.ignoreUnknown===!0,d.respectType=L.respectType!==!1,d.respectFunctionNames=L.respectFunctionNames!==!1,d.respectFunctionProperties=L.respectFunctionProperties!==!1,d.unorderedArrays=L.unorderedArrays===!0,d.unorderedSets=L.unorderedSets!==!1,d.unorderedObjects=L.unorderedObjects!==!1,d.replacer=L.replacer||void 0,d.excludeKeys=L.excludeKeys||void 0,v===void 0)throw new Error("Object argument required.");for(var b=0;b<f.length;++b)f[b].toLowerCase()===d.algorithm.toLowerCase()&&(d.algorithm=f[b]);if(f.indexOf(d.algorithm)===-1)throw new Error('Algorithm "'+d.algorithm+'"  not supported. supported values: '+f.join(", "));if(x.indexOf(d.encoding)===-1&&d.algorithm!=="passthrough")throw new Error('Encoding "'+d.encoding+'"  not supported. supported values: '+x.join(", "));return d}function E(v){if(typeof v=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(v))!=null}function k(v,L,d){d=d||[];function b(u){return L.update?L.update(u,"utf8"):L.write(u,"utf8")}return{dispatch:function(u){return this["_"+((u=v.replacer?v.replacer(u):u)===null?"null":typeof u)](u)},_object:function(u){var y,A=Object.prototype.toString.call(u),F=/\[object (.*)\]/i.exec(A);if(F=(F=F?F[1]:"unknown:["+A+"]").toLowerCase(),0<=(A=d.indexOf(u)))return this.dispatch("[CIRCULAR:"+A+"]");if(d.push(u),a!==void 0&&a.isBuffer&&a.isBuffer(u))return b("buffer:"),b(u);if(F==="object"||F==="function"||F==="asyncfunction")return A=Object.keys(u),v.unorderedObjects&&(A=A.sort()),v.respectType===!1||E(u)||A.splice(0,0,"prototype","__proto__","constructor"),v.excludeKeys&&(A=A.filter(function(j){return!v.excludeKeys(j)})),b("object:"+A.length+":"),y=this,A.forEach(function(j){y.dispatch(j),b(":"),v.excludeValues||y.dispatch(u[j]),b(",")});if(!this["_"+F]){if(v.ignoreUnknown)return b("["+F+"]");throw new Error('Unknown object type "'+F+'"')}this["_"+F](u)},_array:function(u,j){j=j!==void 0?j:v.unorderedArrays!==!1;var A=this;if(b("array:"+u.length+":"),!j||u.length<=1)return u.forEach(function(z){return A.dispatch(z)});var F=[],j=u.map(function(z){var R=new S,H=d.slice();return k(v,R,H).dispatch(z),F=F.concat(H.slice(d.length)),R.read().toString()});return d=d.concat(F),j.sort(),this._array(j,!1)},_date:function(u){return b("date:"+u.toJSON())},_symbol:function(u){return b("symbol:"+u.toString())},_error:function(u){return b("error:"+u.toString())},_boolean:function(u){return b("bool:"+u.toString())},_string:function(u){b("string:"+u.length+":"),b(u.toString())},_function:function(u){b("fn:"),E(u)?this.dispatch("[native]"):this.dispatch(u.toString()),v.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(u.name)),v.respectFunctionProperties&&this._object(u)},_number:function(u){return b("number:"+u.toString())},_xml:function(u){return b("xml:"+u.toString())},_null:function(){return b("Null")},_undefined:function(){return b("Undefined")},_regexp:function(u){return b("regex:"+u.toString())},_uint8array:function(u){return b("uint8array:"),this.dispatch(Array.prototype.slice.call(u))},_uint8clampedarray:function(u){return b("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(u))},_int8array:function(u){return b("int8array:"),this.dispatch(Array.prototype.slice.call(u))},_uint16array:function(u){return b("uint16array:"),this.dispatch(Array.prototype.slice.call(u))},_int16array:function(u){return b("int16array:"),this.dispatch(Array.prototype.slice.call(u))},_uint32array:function(u){return b("uint32array:"),this.dispatch(Array.prototype.slice.call(u))},_int32array:function(u){return b("int32array:"),this.dispatch(Array.prototype.slice.call(u))},_float32array:function(u){return b("float32array:"),this.dispatch(Array.prototype.slice.call(u))},_float64array:function(u){return b("float64array:"),this.dispatch(Array.prototype.slice.call(u))},_arraybuffer:function(u){return b("arraybuffer:"),this.dispatch(new Uint8Array(u))},_url:function(u){return b("url:"+u.toString())},_map:function(u){return b("map:"),u=Array.from(u),this._array(u,v.unorderedSets!==!1)},_set:function(u){return b("set:"),u=Array.from(u),this._array(u,v.unorderedSets!==!1)},_file:function(u){return b("file:"),this.dispatch([u.name,u.size,u.type,u.lastModfied])},_blob:function(){if(v.ignoreUnknown)return b("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return b("domwindow")},_bigint:function(u){return b("bigint:"+u.toString())},_process:function(){return b("process")},_timer:function(){return b("timer")},_pipe:function(){return b("pipe")},_tcp:function(){return b("tcp")},_udp:function(){return b("udp")},_tty:function(){return b("tty")},_statwatcher:function(){return b("statwatcher")},_securecontext:function(){return b("securecontext")},_connection:function(){return b("connection")},_zlib:function(){return b("zlib")},_context:function(){return b("context")},_nodescript:function(){return b("nodescript")},_httpparser:function(){return b("httpparser")},_dataview:function(){return b("dataview")},_signal:function(){return b("signal")},_fsevent:function(){return b("fsevent")},_tlswrap:function(){return b("tlswrap")}}}function S(){return{buf:"",write:function(v){this.buf+=v},end:function(v){this.buf+=v},read:function(){return this.buf}}}i.writeToStream=function(v,L,d){return d===void 0&&(d=L,L={}),k(L=T(v,L),d).dispatch(v)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(t,r,i){(function(s,o,a,l,p,w,h,M,P){(function(m){var C=typeof Uint8Array<"u"?Uint8Array:Array,f=43,x=47,T=48,E=97,k=65,S=45,v=95;function L(d){return d=d.charCodeAt(0),d===f||d===S?62:d===x||d===v?63:d<T?-1:d<T+10?d-T+26+26:d<k+26?d-k:d<E+26?d-E+26:void 0}m.toByteArray=function(d){var b,u;if(0<d.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var y=d.length,y=d.charAt(y-2)==="="?2:d.charAt(y-1)==="="?1:0,A=new C(3*d.length/4-y),F=0<y?d.length-4:d.length,j=0;function z(R){A[j++]=R}for(b=0;b<F;b+=4,0)z((16711680&(u=L(d.charAt(b))<<18|L(d.charAt(b+1))<<12|L(d.charAt(b+2))<<6|L(d.charAt(b+3))))>>16),z((65280&u)>>8),z(255&u);return y==2?z(255&(u=L(d.charAt(b))<<2|L(d.charAt(b+1))>>4)):y==1&&(z((u=L(d.charAt(b))<<10|L(d.charAt(b+1))<<4|L(d.charAt(b+2))>>2)>>8&255),z(255&u)),A},m.fromByteArray=function(d){var b,u,y,A,F=d.length%3,j="";function z(R){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(R)}for(b=0,y=d.length-F;b<y;b+=3)u=(d[b]<<16)+(d[b+1]<<8)+d[b+2],j+=z((A=u)>>18&63)+z(A>>12&63)+z(A>>6&63)+z(63&A);switch(F){case 1:j=(j+=z((u=d[d.length-1])>>2))+z(u<<4&63)+"==";break;case 2:j=(j=(j+=z((u=(d[d.length-2]<<8)+d[d.length-1])>>10))+z(u>>4&63))+z(u<<2&63)+"="}return j}})(i===void 0?this.base64js={}:i)}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(t,r,i){(function(s,o,f,l,p,w,h,M,P){var m=t("base64-js"),C=t("ieee754");function f(c,g,_){if(!(this instanceof f))return new f(c,g,_);var V,O,B,Y,ue=typeof c;if(g==="base64"&&ue=="string")for(c=(Y=c).trim?Y.trim():Y.replace(/^\s+|\s+$/g,"");c.length%4!=0;)c+="=";if(ue=="number")V=te(c);else if(ue=="string")V=f.byteLength(c,g);else{if(ue!="object")throw new Error("First argument needs to be a number, array or string.");V=te(c.length)}if(f._useTypedArrays?O=f._augment(new Uint8Array(V)):((O=this).length=V,O._isBuffer=!0),f._useTypedArrays&&typeof c.byteLength=="number")O._set(c);else if(ee(Y=c)||f.isBuffer(Y)||Y&&typeof Y=="object"&&typeof Y.length=="number")for(B=0;B<V;B++)f.isBuffer(c)?O[B]=c.readUInt8(B):O[B]=c[B];else if(ue=="string")O.write(c,0,g);else if(ue=="number"&&!f._useTypedArrays&&!_)for(B=0;B<V;B++)O[B]=0;return O}function x(c,g,_,V){return f._charsWritten=Q(function(O){for(var B=[],Y=0;Y<O.length;Y++)B.push(255&O.charCodeAt(Y));return B}(g),c,_,V)}function T(c,g,_,V){return f._charsWritten=Q(function(O){for(var B,Y,ue=[],ce=0;ce<O.length;ce++)Y=O.charCodeAt(ce),B=Y>>8,Y=Y%256,ue.push(Y),ue.push(B);return ue}(g),c,_,V)}function E(c,g,_){var V="";_=Math.min(c.length,_);for(var O=g;O<_;O++)V+=String.fromCharCode(c[O]);return V}function k(c,g,_,B){B||(N(typeof _=="boolean","missing or invalid endian"),N(g!=null,"missing offset"),N(g+1<c.length,"Trying to read beyond buffer length"));var O,B=c.length;if(!(B<=g))return _?(O=c[g],g+1<B&&(O|=c[g+1]<<8)):(O=c[g]<<8,g+1<B&&(O|=c[g+1])),O}function S(c,g,_,B){B||(N(typeof _=="boolean","missing or invalid endian"),N(g!=null,"missing offset"),N(g+3<c.length,"Trying to read beyond buffer length"));var O,B=c.length;if(!(B<=g))return _?(g+2<B&&(O=c[g+2]<<16),g+1<B&&(O|=c[g+1]<<8),O|=c[g],g+3<B&&(O+=c[g+3]<<24>>>0)):(g+1<B&&(O=c[g+1]<<16),g+2<B&&(O|=c[g+2]<<8),g+3<B&&(O|=c[g+3]),O+=c[g]<<24>>>0),O}function v(c,g,_,V){if(V||(N(typeof _=="boolean","missing or invalid endian"),N(g!=null,"missing offset"),N(g+1<c.length,"Trying to read beyond buffer length")),!(c.length<=g))return V=k(c,g,_,!0),32768&V?-1*(65535-V+1):V}function L(c,g,_,V){if(V||(N(typeof _=="boolean","missing or invalid endian"),N(g!=null,"missing offset"),N(g+3<c.length,"Trying to read beyond buffer length")),!(c.length<=g))return V=S(c,g,_,!0),2147483648&V?-1*(4294967295-V+1):V}function d(c,g,_,V){return V||(N(typeof _=="boolean","missing or invalid endian"),N(g+3<c.length,"Trying to read beyond buffer length")),C.read(c,g,_,23,4)}function b(c,g,_,V){return V||(N(typeof _=="boolean","missing or invalid endian"),N(g+7<c.length,"Trying to read beyond buffer length")),C.read(c,g,_,52,8)}function u(c,g,_,V,O){if(O||(N(g!=null,"missing value"),N(typeof V=="boolean","missing or invalid endian"),N(_!=null,"missing offset"),N(_+1<c.length,"trying to write beyond buffer length"),we(g,65535)),O=c.length,!(O<=_))for(var B=0,Y=Math.min(O-_,2);B<Y;B++)c[_+B]=(g&255<<8*(V?B:1-B))>>>8*(V?B:1-B)}function y(c,g,_,V,O){if(O||(N(g!=null,"missing value"),N(typeof V=="boolean","missing or invalid endian"),N(_!=null,"missing offset"),N(_+3<c.length,"trying to write beyond buffer length"),we(g,4294967295)),O=c.length,!(O<=_))for(var B=0,Y=Math.min(O-_,4);B<Y;B++)c[_+B]=g>>>8*(V?B:3-B)&255}function A(c,g,_,V,O){O||(N(g!=null,"missing value"),N(typeof V=="boolean","missing or invalid endian"),N(_!=null,"missing offset"),N(_+1<c.length,"Trying to write beyond buffer length"),Le(g,32767,-32768)),c.length<=_||u(c,0<=g?g:65535+g+1,_,V,O)}function F(c,g,_,V,O){O||(N(g!=null,"missing value"),N(typeof V=="boolean","missing or invalid endian"),N(_!=null,"missing offset"),N(_+3<c.length,"Trying to write beyond buffer length"),Le(g,2147483647,-2147483648)),c.length<=_||y(c,0<=g?g:4294967295+g+1,_,V,O)}function j(c,g,_,V,O){O||(N(g!=null,"missing value"),N(typeof V=="boolean","missing or invalid endian"),N(_!=null,"missing offset"),N(_+3<c.length,"Trying to write beyond buffer length"),Fe(g,34028234663852886e22,-34028234663852886e22)),c.length<=_||C.write(c,g,_,V,23,4)}function z(c,g,_,V,O){O||(N(g!=null,"missing value"),N(typeof V=="boolean","missing or invalid endian"),N(_!=null,"missing offset"),N(_+7<c.length,"Trying to write beyond buffer length"),Fe(g,17976931348623157e292,-17976931348623157e292)),c.length<=_||C.write(c,g,_,V,52,8)}i.Buffer=f,i.SlowBuffer=f,i.INSPECT_MAX_BYTES=50,f.poolSize=8192,f._useTypedArrays=function(){try{var c=new ArrayBuffer(0),g=new Uint8Array(c);return g.foo=function(){return 42},g.foo()===42&&typeof g.subarray=="function"}catch{return!1}}(),f.isEncoding=function(c){switch(String(c).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.isBuffer=function(c){return!(c==null||!c._isBuffer)},f.byteLength=function(c,g){var _;switch(c+="",g||"utf8"){case"hex":_=c.length/2;break;case"utf8":case"utf-8":_=Pe(c).length;break;case"ascii":case"binary":case"raw":_=c.length;break;case"base64":_=U(c).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":_=2*c.length;break;default:throw new Error("Unknown encoding")}return _},f.concat=function(c,g){if(N(ee(c),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),c.length===0)return new f(0);if(c.length===1)return c[0];if(typeof g!="number")for(O=g=0;O<c.length;O++)g+=c[O].length;for(var _=new f(g),V=0,O=0;O<c.length;O++){var B=c[O];B.copy(_,V),V+=B.length}return _},f.prototype.write=function(c,g,_,V){isFinite(g)?isFinite(_)||(V=_,_=void 0):(ce=V,V=g,g=_,_=ce),g=Number(g)||0;var O,B,Y,ue,ce=this.length-g;switch((!_||ce<(_=Number(_)))&&(_=ce),V=String(V||"utf8").toLowerCase()){case"hex":O=function(Ee,ge,be,me){be=Number(be)||0;var de=Ee.length-be;(!me||de<(me=Number(me)))&&(me=de),N((de=ge.length)%2==0,"Invalid hex string"),de/2<me&&(me=de/2);for(var Ue=0;Ue<me;Ue++){var yt=parseInt(ge.substr(2*Ue,2),16);N(!isNaN(yt),"Invalid hex string"),Ee[be+Ue]=yt}return f._charsWritten=2*Ue,Ue}(this,c,g,_);break;case"utf8":case"utf-8":B=this,Y=g,ue=_,O=f._charsWritten=Q(Pe(c),B,Y,ue);break;case"ascii":case"binary":O=x(this,c,g,_);break;case"base64":B=this,Y=g,ue=_,O=f._charsWritten=Q(U(c),B,Y,ue);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":O=T(this,c,g,_);break;default:throw new Error("Unknown encoding")}return O},f.prototype.toString=function(c,g,_){var V,O,B,Y,ue=this;if(c=String(c||"utf8").toLowerCase(),g=Number(g)||0,(_=_!==void 0?Number(_):ue.length)===g)return"";switch(c){case"hex":V=function(ce,Ee,ge){var be=ce.length;(!Ee||Ee<0)&&(Ee=0),(!ge||ge<0||be<ge)&&(ge=be);for(var me="",de=Ee;de<ge;de++)me+=Z(ce[de]);return me}(ue,g,_);break;case"utf8":case"utf-8":V=function(ce,Ee,ge){var be="",me="";ge=Math.min(ce.length,ge);for(var de=Ee;de<ge;de++)ce[de]<=127?(be+=se(me)+String.fromCharCode(ce[de]),me=""):me+="%"+ce[de].toString(16);return be+se(me)}(ue,g,_);break;case"ascii":case"binary":V=E(ue,g,_);break;case"base64":O=ue,Y=_,V=(B=g)===0&&Y===O.length?m.fromByteArray(O):m.fromByteArray(O.slice(B,Y));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":V=function(ce,Ee,ge){for(var be=ce.slice(Ee,ge),me="",de=0;de<be.length;de+=2)me+=String.fromCharCode(be[de]+256*be[de+1]);return me}(ue,g,_);break;default:throw new Error("Unknown encoding")}return V},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},f.prototype.copy=function(c,g,_,V){if(g=g||0,(V=V||V===0?V:this.length)!==(_=_||0)&&c.length!==0&&this.length!==0){N(_<=V,"sourceEnd < sourceStart"),N(0<=g&&g<c.length,"targetStart out of bounds"),N(0<=_&&_<this.length,"sourceStart out of bounds"),N(0<=V&&V<=this.length,"sourceEnd out of bounds"),V>this.length&&(V=this.length);var O=(V=c.length-g<V-_?c.length-g+_:V)-_;if(O<100||!f._useTypedArrays)for(var B=0;B<O;B++)c[B+g]=this[B+_];else c._set(this.subarray(_,_+O),g)}},f.prototype.slice=function(c,g){var _=this.length;if(c=H(c,_,0),g=H(g,_,_),f._useTypedArrays)return f._augment(this.subarray(c,g));for(var V=g-c,O=new f(V,void 0,!0),B=0;B<V;B++)O[B]=this[B+c];return O},f.prototype.get=function(c){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(c)},f.prototype.set=function(c,g){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(c,g)},f.prototype.readUInt8=function(c,g){if(g||(N(c!=null,"missing offset"),N(c<this.length,"Trying to read beyond buffer length")),!(c>=this.length))return this[c]},f.prototype.readUInt16LE=function(c,g){return k(this,c,!0,g)},f.prototype.readUInt16BE=function(c,g){return k(this,c,!1,g)},f.prototype.readUInt32LE=function(c,g){return S(this,c,!0,g)},f.prototype.readUInt32BE=function(c,g){return S(this,c,!1,g)},f.prototype.readInt8=function(c,g){if(g||(N(c!=null,"missing offset"),N(c<this.length,"Trying to read beyond buffer length")),!(c>=this.length))return 128&this[c]?-1*(255-this[c]+1):this[c]},f.prototype.readInt16LE=function(c,g){return v(this,c,!0,g)},f.prototype.readInt16BE=function(c,g){return v(this,c,!1,g)},f.prototype.readInt32LE=function(c,g){return L(this,c,!0,g)},f.prototype.readInt32BE=function(c,g){return L(this,c,!1,g)},f.prototype.readFloatLE=function(c,g){return d(this,c,!0,g)},f.prototype.readFloatBE=function(c,g){return d(this,c,!1,g)},f.prototype.readDoubleLE=function(c,g){return b(this,c,!0,g)},f.prototype.readDoubleBE=function(c,g){return b(this,c,!1,g)},f.prototype.writeUInt8=function(c,g,_){_||(N(c!=null,"missing value"),N(g!=null,"missing offset"),N(g<this.length,"trying to write beyond buffer length"),we(c,255)),g>=this.length||(this[g]=c)},f.prototype.writeUInt16LE=function(c,g,_){u(this,c,g,!0,_)},f.prototype.writeUInt16BE=function(c,g,_){u(this,c,g,!1,_)},f.prototype.writeUInt32LE=function(c,g,_){y(this,c,g,!0,_)},f.prototype.writeUInt32BE=function(c,g,_){y(this,c,g,!1,_)},f.prototype.writeInt8=function(c,g,_){_||(N(c!=null,"missing value"),N(g!=null,"missing offset"),N(g<this.length,"Trying to write beyond buffer length"),Le(c,127,-128)),g>=this.length||(0<=c?this.writeUInt8(c,g,_):this.writeUInt8(255+c+1,g,_))},f.prototype.writeInt16LE=function(c,g,_){A(this,c,g,!0,_)},f.prototype.writeInt16BE=function(c,g,_){A(this,c,g,!1,_)},f.prototype.writeInt32LE=function(c,g,_){F(this,c,g,!0,_)},f.prototype.writeInt32BE=function(c,g,_){F(this,c,g,!1,_)},f.prototype.writeFloatLE=function(c,g,_){j(this,c,g,!0,_)},f.prototype.writeFloatBE=function(c,g,_){j(this,c,g,!1,_)},f.prototype.writeDoubleLE=function(c,g,_){z(this,c,g,!0,_)},f.prototype.writeDoubleBE=function(c,g,_){z(this,c,g,!1,_)},f.prototype.fill=function(c,g,_){if(g=g||0,_=_||this.length,N(typeof(c=typeof(c=c||0)=="string"?c.charCodeAt(0):c)=="number"&&!isNaN(c),"value is not a number"),N(g<=_,"end < start"),_!==g&&this.length!==0){N(0<=g&&g<this.length,"start out of bounds"),N(0<=_&&_<=this.length,"end out of bounds");for(var V=g;V<_;V++)this[V]=c}},f.prototype.inspect=function(){for(var c=[],g=this.length,_=0;_<g;_++)if(c[_]=Z(this[_]),_===i.INSPECT_MAX_BYTES){c[_+1]="...";break}return"<Buffer "+c.join(" ")+">"},f.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(f._useTypedArrays)return new f(this).buffer;for(var c=new Uint8Array(this.length),g=0,_=c.length;g<_;g+=1)c[g]=this[g];return c.buffer};var R=f.prototype;function H(c,g,_){return typeof c!="number"?_:g<=(c=~~c)?g:0<=c||0<=(c+=g)?c:0}function te(c){return(c=~~Math.ceil(+c))<0?0:c}function ee(c){return(Array.isArray||function(g){return Object.prototype.toString.call(g)==="[object Array]"})(c)}function Z(c){return c<16?"0"+c.toString(16):c.toString(16)}function Pe(c){for(var g=[],_=0;_<c.length;_++){var V=c.charCodeAt(_);if(V<=127)g.push(c.charCodeAt(_));else for(var O=_,B=(55296<=V&&V<=57343&&_++,encodeURIComponent(c.slice(O,_+1)).substr(1).split("%")),Y=0;Y<B.length;Y++)g.push(parseInt(B[Y],16))}return g}function U(c){return m.toByteArray(c)}function Q(c,g,_,V){for(var O=0;O<V&&!(O+_>=g.length||O>=c.length);O++)g[O+_]=c[O];return O}function se(c){try{return decodeURIComponent(c)}catch{return"�"}}function we(c,g){N(typeof c=="number","cannot write a non-number as a number"),N(0<=c,"specified a negative value for writing an unsigned value"),N(c<=g,"value is larger than maximum value for type"),N(Math.floor(c)===c,"value has a fractional component")}function Le(c,g,_){N(typeof c=="number","cannot write a non-number as a number"),N(c<=g,"value larger than maximum allowed value"),N(_<=c,"value smaller than minimum allowed value"),N(Math.floor(c)===c,"value has a fractional component")}function Fe(c,g,_){N(typeof c=="number","cannot write a non-number as a number"),N(c<=g,"value larger than maximum allowed value"),N(_<=c,"value smaller than minimum allowed value")}function N(c,g){if(!c)throw new Error(g||"Failed assertion")}f._augment=function(c){return c._isBuffer=!0,c._get=c.get,c._set=c.set,c.get=R.get,c.set=R.set,c.write=R.write,c.toString=R.toString,c.toLocaleString=R.toString,c.toJSON=R.toJSON,c.copy=R.copy,c.slice=R.slice,c.readUInt8=R.readUInt8,c.readUInt16LE=R.readUInt16LE,c.readUInt16BE=R.readUInt16BE,c.readUInt32LE=R.readUInt32LE,c.readUInt32BE=R.readUInt32BE,c.readInt8=R.readInt8,c.readInt16LE=R.readInt16LE,c.readInt16BE=R.readInt16BE,c.readInt32LE=R.readInt32LE,c.readInt32BE=R.readInt32BE,c.readFloatLE=R.readFloatLE,c.readFloatBE=R.readFloatBE,c.readDoubleLE=R.readDoubleLE,c.readDoubleBE=R.readDoubleBE,c.writeUInt8=R.writeUInt8,c.writeUInt16LE=R.writeUInt16LE,c.writeUInt16BE=R.writeUInt16BE,c.writeUInt32LE=R.writeUInt32LE,c.writeUInt32BE=R.writeUInt32BE,c.writeInt8=R.writeInt8,c.writeInt16LE=R.writeInt16LE,c.writeInt16BE=R.writeInt16BE,c.writeInt32LE=R.writeInt32LE,c.writeInt32BE=R.writeInt32BE,c.writeFloatLE=R.writeFloatLE,c.writeFloatBE=R.writeFloatBE,c.writeDoubleLE=R.writeDoubleLE,c.writeDoubleBE=R.writeDoubleBE,c.fill=R.fill,c.inspect=R.inspect,c.toArrayBuffer=R.toArrayBuffer,c}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(t,r,i){(function(s,o,m,l,p,w,h,M,P){var m=t("buffer").Buffer,C=4,f=new m(C);f.fill(0),r.exports={hash:function(x,T,E,k){for(var S=T(function(u,y){u.length%C!=0&&(A=u.length+(C-u.length%C),u=m.concat([u,f],A));for(var A,F=[],j=y?u.readInt32BE:u.readInt32LE,z=0;z<u.length;z+=C)F.push(j.call(u,z));return F}(x=m.isBuffer(x)?x:new m(x),k),8*x.length),T=k,v=new m(E),L=T?v.writeInt32BE:v.writeInt32LE,d=0;d<S.length;d++)L.call(v,S[d],4*d,!0);return v}}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(t,r,i){(function(s,o,m,l,p,w,h,M,P){var m=t("buffer").Buffer,C=t("./sha"),f=t("./sha256"),x=t("./rng"),T={sha1:C,sha256:f,md5:t("./md5")},E=64,k=new m(E);function S(u,y){var A=T[u=u||"sha1"],F=[];return A||v("algorithm:",u,"is not yet supported"),{update:function(j){return m.isBuffer(j)||(j=new m(j)),F.push(j),j.length,this},digest:function(j){var z=m.concat(F),z=y?function(R,H,te){m.isBuffer(H)||(H=new m(H)),m.isBuffer(te)||(te=new m(te)),H.length>E?H=R(H):H.length<E&&(H=m.concat([H,k],E));for(var ee=new m(E),Z=new m(E),Pe=0;Pe<E;Pe++)ee[Pe]=54^H[Pe],Z[Pe]=92^H[Pe];return te=R(m.concat([ee,te])),R(m.concat([Z,te]))}(A,y,z):A(z);return F=null,j?z.toString(j):z}}}function v(){var u=[].slice.call(arguments).join(" ");throw new Error([u,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}k.fill(0),i.createHash=function(u){return S(u)},i.createHmac=S,i.randomBytes=function(u,y){if(!y||!y.call)return new m(x(u));try{y.call(this,void 0,new m(x(u)))}catch(A){y(A)}};var L,d=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],b=function(u){i[u]=function(){v("sorry,",u,"is not implemented yet")}};for(L in d)b(d[L])}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(t,r,i){(function(s,o,a,l,p,w,h,M,P){var m=t("./helpers");function C(v,L){v[L>>5]|=128<<L%32,v[14+(L+64>>>9<<4)]=L;for(var d=1732584193,b=-271733879,u=-1732584194,y=271733878,A=0;A<v.length;A+=16){var F=d,j=b,z=u,R=y,d=x(d,b,u,y,v[A+0],7,-680876936),y=x(y,d,b,u,v[A+1],12,-389564586),u=x(u,y,d,b,v[A+2],17,606105819),b=x(b,u,y,d,v[A+3],22,-1044525330);d=x(d,b,u,y,v[A+4],7,-176418897),y=x(y,d,b,u,v[A+5],12,1200080426),u=x(u,y,d,b,v[A+6],17,-1473231341),b=x(b,u,y,d,v[A+7],22,-45705983),d=x(d,b,u,y,v[A+8],7,1770035416),y=x(y,d,b,u,v[A+9],12,-1958414417),u=x(u,y,d,b,v[A+10],17,-42063),b=x(b,u,y,d,v[A+11],22,-1990404162),d=x(d,b,u,y,v[A+12],7,1804603682),y=x(y,d,b,u,v[A+13],12,-40341101),u=x(u,y,d,b,v[A+14],17,-1502002290),d=T(d,b=x(b,u,y,d,v[A+15],22,1236535329),u,y,v[A+1],5,-165796510),y=T(y,d,b,u,v[A+6],9,-1069501632),u=T(u,y,d,b,v[A+11],14,643717713),b=T(b,u,y,d,v[A+0],20,-373897302),d=T(d,b,u,y,v[A+5],5,-701558691),y=T(y,d,b,u,v[A+10],9,38016083),u=T(u,y,d,b,v[A+15],14,-660478335),b=T(b,u,y,d,v[A+4],20,-405537848),d=T(d,b,u,y,v[A+9],5,568446438),y=T(y,d,b,u,v[A+14],9,-1019803690),u=T(u,y,d,b,v[A+3],14,-187363961),b=T(b,u,y,d,v[A+8],20,1163531501),d=T(d,b,u,y,v[A+13],5,-1444681467),y=T(y,d,b,u,v[A+2],9,-51403784),u=T(u,y,d,b,v[A+7],14,1735328473),d=E(d,b=T(b,u,y,d,v[A+12],20,-1926607734),u,y,v[A+5],4,-378558),y=E(y,d,b,u,v[A+8],11,-2022574463),u=E(u,y,d,b,v[A+11],16,1839030562),b=E(b,u,y,d,v[A+14],23,-35309556),d=E(d,b,u,y,v[A+1],4,-1530992060),y=E(y,d,b,u,v[A+4],11,1272893353),u=E(u,y,d,b,v[A+7],16,-155497632),b=E(b,u,y,d,v[A+10],23,-1094730640),d=E(d,b,u,y,v[A+13],4,681279174),y=E(y,d,b,u,v[A+0],11,-358537222),u=E(u,y,d,b,v[A+3],16,-722521979),b=E(b,u,y,d,v[A+6],23,76029189),d=E(d,b,u,y,v[A+9],4,-640364487),y=E(y,d,b,u,v[A+12],11,-421815835),u=E(u,y,d,b,v[A+15],16,530742520),d=k(d,b=E(b,u,y,d,v[A+2],23,-995338651),u,y,v[A+0],6,-198630844),y=k(y,d,b,u,v[A+7],10,1126891415),u=k(u,y,d,b,v[A+14],15,-1416354905),b=k(b,u,y,d,v[A+5],21,-57434055),d=k(d,b,u,y,v[A+12],6,1700485571),y=k(y,d,b,u,v[A+3],10,-1894986606),u=k(u,y,d,b,v[A+10],15,-1051523),b=k(b,u,y,d,v[A+1],21,-2054922799),d=k(d,b,u,y,v[A+8],6,1873313359),y=k(y,d,b,u,v[A+15],10,-30611744),u=k(u,y,d,b,v[A+6],15,-1560198380),b=k(b,u,y,d,v[A+13],21,1309151649),d=k(d,b,u,y,v[A+4],6,-145523070),y=k(y,d,b,u,v[A+11],10,-1120210379),u=k(u,y,d,b,v[A+2],15,718787259),b=k(b,u,y,d,v[A+9],21,-343485551),d=S(d,F),b=S(b,j),u=S(u,z),y=S(y,R)}return Array(d,b,u,y)}function f(v,L,d,b,u,y){return S((L=S(S(L,v),S(b,y)))<<u|L>>>32-u,d)}function x(v,L,d,b,u,y,A){return f(L&d|~L&b,v,L,u,y,A)}function T(v,L,d,b,u,y,A){return f(L&b|d&~b,v,L,u,y,A)}function E(v,L,d,b,u,y,A){return f(L^d^b,v,L,u,y,A)}function k(v,L,d,b,u,y,A){return f(d^(L|~b),v,L,u,y,A)}function S(v,L){var d=(65535&v)+(65535&L);return(v>>16)+(L>>16)+(d>>16)<<16|65535&d}r.exports=function(v){return m.hash(v,C,16)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(t,r,i){(function(s,o,a,l,p,w,h,M,P){r.exports=function(m){for(var C,f=new Array(m),x=0;x<m;x++)!(3&x)&&(C=4294967296*Math.random()),f[x]=C>>>((3&x)<<3)&255;return f}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(t,r,i){(function(s,o,a,l,p,w,h,M,P){var m=t("./helpers");function C(T,E){T[E>>5]|=128<<24-E%32,T[15+(E+64>>9<<4)]=E;for(var k,S,v,L=Array(80),d=1732584193,b=-271733879,u=-1732584194,y=271733878,A=-1009589776,F=0;F<T.length;F+=16){for(var j=d,z=b,R=u,H=y,te=A,ee=0;ee<80;ee++){L[ee]=ee<16?T[F+ee]:x(L[ee-3]^L[ee-8]^L[ee-14]^L[ee-16],1);var Z=f(f(x(d,5),(Z=b,S=u,v=y,(k=ee)<20?Z&S|~Z&v:!(k<40)&&k<60?Z&S|Z&v|S&v:Z^S^v)),f(f(A,L[ee]),(k=ee)<20?1518500249:k<40?1859775393:k<60?-1894007588:-899497514)),A=y,y=u,u=x(b,30),b=d,d=Z}d=f(d,j),b=f(b,z),u=f(u,R),y=f(y,H),A=f(A,te)}return Array(d,b,u,y,A)}function f(T,E){var k=(65535&T)+(65535&E);return(T>>16)+(E>>16)+(k>>16)<<16|65535&k}function x(T,E){return T<<E|T>>>32-E}r.exports=function(T){return m.hash(T,C,20,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(t,r,i){(function(s,o,a,l,p,w,h,M,P){function m(E,k){var S=(65535&E)+(65535&k);return(E>>16)+(k>>16)+(S>>16)<<16|65535&S}function C(E,k){var S,v=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),L=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),d=new Array(64);E[k>>5]|=128<<24-k%32,E[15+(k+64>>9<<4)]=k;for(var b,u,y=0;y<E.length;y+=16){for(var A=L[0],F=L[1],j=L[2],z=L[3],R=L[4],H=L[5],te=L[6],ee=L[7],Z=0;Z<64;Z++)d[Z]=Z<16?E[Z+y]:m(m(m((u=d[Z-2],x(u,17)^x(u,19)^T(u,10)),d[Z-7]),(u=d[Z-15],x(u,7)^x(u,18)^T(u,3))),d[Z-16]),S=m(m(m(m(ee,x(u=R,6)^x(u,11)^x(u,25)),R&H^~R&te),v[Z]),d[Z]),b=m(x(b=A,2)^x(b,13)^x(b,22),A&F^A&j^F&j),ee=te,te=H,H=R,R=m(z,S),z=j,j=F,F=A,A=m(S,b);L[0]=m(A,L[0]),L[1]=m(F,L[1]),L[2]=m(j,L[2]),L[3]=m(z,L[3]),L[4]=m(R,L[4]),L[5]=m(H,L[5]),L[6]=m(te,L[6]),L[7]=m(ee,L[7])}return L}var f=t("./helpers"),x=function(E,k){return E>>>k|E<<32-k},T=function(E,k){return E>>>k};r.exports=function(E){return f.hash(E,C,32,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(t,r,i){(function(s,o,a,l,p,w,h,M,P){i.read=function(m,C,f,x,y){var E,k,S=8*y-x-1,v=(1<<S)-1,L=v>>1,d=-7,b=f?y-1:0,u=f?-1:1,y=m[C+b];for(b+=u,E=y&(1<<-d)-1,y>>=-d,d+=S;0<d;E=256*E+m[C+b],b+=u,d-=8);for(k=E&(1<<-d)-1,E>>=-d,d+=x;0<d;k=256*k+m[C+b],b+=u,d-=8);if(E===0)E=1-L;else{if(E===v)return k?NaN:1/0*(y?-1:1);k+=Math.pow(2,x),E-=L}return(y?-1:1)*k*Math.pow(2,E-x)},i.write=function(m,C,f,x,T,A){var k,S,v=8*A-T-1,L=(1<<v)-1,d=L>>1,b=T===23?Math.pow(2,-24)-Math.pow(2,-77):0,u=x?0:A-1,y=x?1:-1,A=C<0||C===0&&1/C<0?1:0;for(C=Math.abs(C),isNaN(C)||C===1/0?(S=isNaN(C)?1:0,k=L):(k=Math.floor(Math.log(C)/Math.LN2),C*(x=Math.pow(2,-k))<1&&(k--,x*=2),2<=(C+=1<=k+d?b/x:b*Math.pow(2,1-d))*x&&(k++,x/=2),L<=k+d?(S=0,k=L):1<=k+d?(S=(C*x-1)*Math.pow(2,T),k+=d):(S=C*Math.pow(2,d-1)*Math.pow(2,T),k=0));8<=T;m[f+u]=255&S,u+=y,S/=256,T-=8);for(k=k<<T|S,v+=T;0<v;m[f+u]=255&k,u+=y,k/=256,v-=8);m[f+u-y]|=128*A}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(t,r,i){(function(s,o,a,l,p,w,h,M,P){var m,C,f;function x(){}(s=r.exports={}).nextTick=(C=typeof window<"u"&&window.setImmediate,f=typeof window<"u"&&window.postMessage&&window.addEventListener,C?function(T){return window.setImmediate(T)}:f?(m=[],window.addEventListener("message",function(T){var E=T.source;E!==window&&E!==null||T.data!=="process-tick"||(T.stopPropagation(),0<m.length&&m.shift()())},!0),function(T){m.push(T),window.postMessage("process-tick","*")}):function(T){setTimeout(T,0)}),s.title="browser",s.browser=!0,s.env={},s.argv=[],s.on=x,s.addListener=x,s.once=x,s.off=x,s.removeListener=x,s.removeAllListeners=x,s.emit=x,s.binding=function(T){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(T){throw new Error("process.chdir is not supported")}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(Em);var Mm=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"],Gr=Mm;Gr=Gr.slice().filter(function(n){return!/^(gl\_|texture)/.test(n)});Gr.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"]);function Tm(n,e){if(typeof n!="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Sm(n){var e=Tm(n,"string");return typeof e=="symbol"?e:String(e)}function le(n,e,t){return e=Sm(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var K={position:"csm_Position",positionRaw:"csm_PositionRaw",pointSize:"csm_PointSize",fragColor:"csm_FragColor",diffuseColor:"csm_DiffuseColor",normal:"csm_Normal",roughness:"csm_Roughness",metalness:"csm_Metalness",emissive:"csm_Emissive",ao:"csm_AO",bump:"csm_Bump",depthAlpha:"csm_DepthAlpha"},Ie,It;Ie={},le(Ie,"".concat(K.normal),{"#include <beginnormal_vertex>":`
    vec3 objectNormal = `.concat(K.normal,`;
    #ifdef USE_TANGENT
	    vec3 objectTangent = vec3( tangent.xyz );
    #endif
    `)}),le(Ie,"".concat(K.position),{"#include <begin_vertex>":`
    vec3 transformed = `.concat(K.position,`;
  `)}),le(Ie,"".concat(K.positionRaw),{"#include <begin_vertex>":`
    vec4 csm_internal_positionUnprojected = `.concat(K.positionRaw,`;
    mat4x4 csm_internal_unprojectMatrix = projectionMatrix * modelViewMatrix;
    #ifdef USE_INSTANCING
      csm_internal_unprojectMatrix = csm_internal_unprojectMatrix * instanceMatrix;
    #endif
    csm_internal_positionUnprojected = inverse(csm_internal_unprojectMatrix) * csm_internal_positionUnprojected;
    vec3 transformed = csm_internal_positionUnprojected.xyz;
  `)}),le(Ie,"".concat(K.pointSize),{"gl_PointSize = size;":`
    gl_PointSize = `.concat(K.pointSize,`;
    `)}),le(Ie,"".concat(K.diffuseColor),{"#include <color_fragment>":`
    #include <color_fragment>
    diffuseColor = `.concat(K.diffuseColor,`;
  `)}),le(Ie,"".concat(K.fragColor),{"#include <dithering_fragment>":`
    #include <dithering_fragment>
    gl_FragColor  = `.concat(K.fragColor,`;
  `)}),le(Ie,"".concat(K.emissive),{"vec3 totalEmissiveRadiance = emissive;":`
    vec3 totalEmissiveRadiance = `.concat(K.emissive,`;
    `)}),le(Ie,"".concat(K.roughness),{"#include <roughnessmap_fragment>":`
    #include <roughnessmap_fragment>
    roughnessFactor = `.concat(K.roughness,`;
    `)}),le(Ie,"".concat(K.metalness),{"#include <metalnessmap_fragment>":`
    #include <metalnessmap_fragment>
    metalnessFactor = `.concat(K.metalness,`;
    `)}),le(Ie,"".concat(K.ao),{"#include <aomap_fragment>":`
    #include <aomap_fragment>
    reflectedLight.indirectDiffuse *= 1. - `.concat(K.ao,`;
    `)}),le(Ie,"".concat(K.bump),{"#include <normal_fragment_maps>":`
    #include <normal_fragment_maps>

    vec3 csm_internal_orthogonal = `.concat(K.bump," - (dot(").concat(K.bump,`, normal) * normal);
    vec3 csm_internal_projectedbump = mat3(csm_internal_vModelViewMatrix) * csm_internal_orthogonal;
    normal = normalize(normal - csm_internal_projectedbump);
    `)}),le(Ie,"".concat(K.depthAlpha),{"gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );":`
      gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity * `.concat(K.depthAlpha,` );
    `),"gl_FragColor = packDepthToRGBA( fragCoordZ );":`
      gl_FragColor = packDepthToRGBA( fragCoordZ );
      gl_FragColor.a *= `.concat(K.depthAlpha,`;
    `)});It={},le(It,"".concat(K.position),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = projectionMatrix * modelViewMatrix * vec4( `.concat(K.position,`, 1.0 );
  `)}),le(It,"".concat(K.positionRaw),{"gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );":`
    gl_Position = `.concat(K.position,`;
  `)}),le(It,"".concat(K.diffuseColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = `.concat(K.diffuseColor,`;
  `)}),le(It,"".concat(K.fragColor),{"gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );":`
    gl_FragColor = `.concat(K.fragColor,`;
  `)});var Ae;Ae={},le(Ae,"".concat(K.position),"*"),le(Ae,"".concat(K.positionRaw),"*"),le(Ae,"".concat(K.normal),"*"),le(Ae,"".concat(K.pointSize),["PointsMaterial"]),le(Ae,"".concat(K.diffuseColor),"*"),le(Ae,"".concat(K.fragColor),"*"),le(Ae,"".concat(K.emissive),["MeshStandardMaterial","MeshPhysicalMaterial"]),le(Ae,"".concat(K.roughness),["MeshStandardMaterial","MeshPhysicalMaterial"]),le(Ae,"".concat(K.metalness),["MeshStandardMaterial","MeshPhysicalMaterial"]),le(Ae,"".concat(K.ao),["MeshStandardMaterial","MeshPhysicalMaterial","MeshBasicMaterial","MeshLambertMaterial","MeshPhongMaterial","MeshToonMaterial"]),le(Ae,"".concat(K.bump),["MeshLambertMaterial","MeshMatcapMaterial","MeshNormalMaterial","MeshPhongMaterial","MeshPhysicalMaterial","MeshStandardMaterial","MeshToonMaterial","ShadowMaterial"]),le(Ae,"".concat(K.depthAlpha),"*");new Us;new J;Vn.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new ye(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}};Ba.line={uniforms:Wr.merge([Vn.common,Vn.fog,Vn.line]),vertexShader:`
		#include <common>
		#include <color_pars_vertex>
		#include <fog_pars_vertex>
		#include <logdepthbuf_pars_vertex>
		#include <clipping_planes_pars_vertex>

		uniform float linewidth;
		uniform vec2 resolution;

		attribute vec3 instanceStart;
		attribute vec3 instanceEnd;

		attribute vec3 instanceColorStart;
		attribute vec3 instanceColorEnd;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#ifdef USE_DASH

			uniform float dashScale;
			attribute float instanceDistanceStart;
			attribute float instanceDistanceEnd;
			varying float vLineDistance;

		#endif

		void trimSegment( const in vec4 start, inout vec4 end ) {

			// trim end segment so it terminates between the camera plane and the near plane

			// conservative estimate of the near plane
			float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
			float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
			float nearEstimate = - 0.5 * b / a;

			float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

			end.xyz = mix( start.xyz, end.xyz, alpha );

		}

		void main() {

			#ifdef USE_COLOR

				vColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

			#endif

			#ifdef USE_DASH

				vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
				vUv = uv;

			#endif

			float aspect = resolution.x / resolution.y;

			// camera space
			vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
			vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

			#ifdef WORLD_UNITS

				worldStart = start.xyz;
				worldEnd = end.xyz;

			#else

				vUv = uv;

			#endif

			// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
			// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
			// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
			// perhaps there is a more elegant solution -- WestLangley

			bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

			if ( perspective ) {

				if ( start.z < 0.0 && end.z >= 0.0 ) {

					trimSegment( start, end );

				} else if ( end.z < 0.0 && start.z >= 0.0 ) {

					trimSegment( end, start );

				}

			}

			// clip space
			vec4 clipStart = projectionMatrix * start;
			vec4 clipEnd = projectionMatrix * end;

			// ndc space
			vec3 ndcStart = clipStart.xyz / clipStart.w;
			vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

			// direction
			vec2 dir = ndcEnd.xy - ndcStart.xy;

			// account for clip-space aspect ratio
			dir.x *= aspect;
			dir = normalize( dir );

			#ifdef WORLD_UNITS

				vec3 worldDir = normalize( end.xyz - start.xyz );
				vec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );
				vec3 worldUp = normalize( cross( worldDir, tmpFwd ) );
				vec3 worldFwd = cross( worldDir, worldUp );
				worldPos = position.y < 0.5 ? start: end;

				// height offset
				float hw = linewidth * 0.5;
				worldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;

				// don't extend the line if we're rendering dashes because we
				// won't be rendering the endcaps
				#ifndef USE_DASH

					// cap extension
					worldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;

					// add width to the box
					worldPos.xyz += worldFwd * hw;

					// endcaps
					if ( position.y > 1.0 || position.y < 0.0 ) {

						worldPos.xyz -= worldFwd * 2.0 * hw;

					}

				#endif

				// project the worldpos
				vec4 clip = projectionMatrix * worldPos;

				// shift the depth of the projected points so the line
				// segments overlap neatly
				vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
				clip.z = clipPose.z * clip.w;

			#else

				vec2 offset = vec2( dir.y, - dir.x );
				// undo aspect ratio adjustment
				dir.x /= aspect;
				offset.x /= aspect;

				// sign flip
				if ( position.x < 0.0 ) offset *= - 1.0;

				// endcaps
				if ( position.y < 0.0 ) {

					offset += - dir;

				} else if ( position.y > 1.0 ) {

					offset += dir;

				}

				// adjust for linewidth
				offset *= linewidth;

				// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
				offset /= resolution.y;

				// select end
				vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

				// back to clip space
				offset *= clip.w;

				clip.xy += offset;

			#endif

			gl_Position = clip;

			vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

			#include <logdepthbuf_vertex>
			#include <clipping_planes_vertex>
			#include <fog_vertex>

		}
		`,fragmentShader:`
		uniform vec3 diffuse;
		uniform float opacity;
		uniform float linewidth;

		#ifdef USE_DASH

			uniform float dashOffset;
			uniform float dashSize;
			uniform float gapSize;

		#endif

		varying float vLineDistance;

		#ifdef WORLD_UNITS

			varying vec4 worldPos;
			varying vec3 worldStart;
			varying vec3 worldEnd;

			#ifdef USE_DASH

				varying vec2 vUv;

			#endif

		#else

			varying vec2 vUv;

		#endif

		#include <common>
		#include <color_pars_fragment>
		#include <fog_pars_fragment>
		#include <logdepthbuf_pars_fragment>
		#include <clipping_planes_pars_fragment>

		vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

			float mua;
			float mub;

			vec3 p13 = p1 - p3;
			vec3 p43 = p4 - p3;

			vec3 p21 = p2 - p1;

			float d1343 = dot( p13, p43 );
			float d4321 = dot( p43, p21 );
			float d1321 = dot( p13, p21 );
			float d4343 = dot( p43, p43 );
			float d2121 = dot( p21, p21 );

			float denom = d2121 * d4343 - d4321 * d4321;

			float numer = d1343 * d4321 - d1321 * d4343;

			mua = numer / denom;
			mua = clamp( mua, 0.0, 1.0 );
			mub = ( d1343 + d4321 * ( mua ) ) / d4343;
			mub = clamp( mub, 0.0, 1.0 );

			return vec2( mua, mub );

		}

		void main() {

			#include <clipping_planes_fragment>

			#ifdef USE_DASH

				if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

				if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

			#endif

			float alpha = opacity;

			#ifdef WORLD_UNITS

				// Find the closest points on the view ray and the line segment
				vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
				vec3 lineDir = worldEnd - worldStart;
				vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

				vec3 p1 = worldStart + lineDir * params.x;
				vec3 p2 = rayEnd * params.y;
				vec3 delta = p1 - p2;
				float len = length( delta );
				float norm = len / linewidth;

				#ifndef USE_DASH

					#ifdef USE_ALPHA_TO_COVERAGE

						float dnorm = fwidth( norm );
						alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

					#else

						if ( norm > 0.5 ) {

							discard;

						}

					#endif

				#endif

			#else

				#ifdef USE_ALPHA_TO_COVERAGE

					// artifacts appear on some hardware if a derivative is taken within a conditional
					float a = vUv.x;
					float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
					float len2 = a * a + b * b;
					float dlen = fwidth( len2 );

					if ( abs( vUv.y ) > 1.0 ) {

						alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

					}

				#else

					if ( abs( vUv.y ) > 1.0 ) {

						float a = vUv.x;
						float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
						float len2 = a * a + b * b;

						if ( len2 > 1.0 ) discard;

					}

				#endif

			#endif

			vec4 diffuseColor = vec4( diffuse, alpha );

			#include <logdepthbuf_fragment>
			#include <color_fragment>

			gl_FragColor = vec4( diffuseColor.rgb, alpha );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>
			#include <fog_fragment>
			#include <premultiplied_alpha_fragment>

		}
		`};new J;new J;new Ct;new Ct;new Ct;new J;new sn;new ka;new J;new Us;new La;new Ct;const km={key:0,args:[0,1,64]},Lm={key:1,args:[.5,1,64]},Im={key:2},Am=["tone-mapped","map","side","color"];new Ze(16777215);class Li extends xt{constructor(){const e=Li.SkyShader,t=new Jn({name:e.name,uniforms:Wr.clone(e.uniforms),vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,side:Ra,depthWrite:!1});super(new Na(1,1,1),t),this.isSky=!0}}Li.SkyShader={name:"SkyShader",uniforms:{turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new J},up:{value:new J(0,1,0)}},vertexShader:`
		uniform vec3 sunPosition;
		uniform float rayleigh;
		uniform float turbidity;
		uniform float mieCoefficient;
		uniform vec3 up;

		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		// constants for atmospheric scattering
		const float e = 2.71828182845904523536028747135266249775724709369995957;
		const float pi = 3.141592653589793238462643383279502884197169;

		// wavelength of used primaries, according to preetham
		const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );
		// this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:
		// (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))
		const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );

		// mie stuff
		// K coefficient for the primaries
		const float v = 4.0;
		const vec3 K = vec3( 0.686, 0.678, 0.666 );
		// MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K
		const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );

		// earth shadow hack
		// cutoffAngle = pi / 1.95;
		const float cutoffAngle = 1.6110731556870734;
		const float steepness = 1.5;
		const float EE = 1000.0;

		float sunIntensity( float zenithAngleCos ) {
			zenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );
			return EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );
		}

		vec3 totalMie( float T ) {
			float c = ( 0.2 * T ) * 10E-18;
			return 0.434 * c * MieConst;
		}

		void main() {

			vec4 worldPosition = modelMatrix * vec4( position, 1.0 );
			vWorldPosition = worldPosition.xyz;

			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			gl_Position.z = gl_Position.w; // set z to camera.far

			vSunDirection = normalize( sunPosition );

			vSunE = sunIntensity( dot( vSunDirection, up ) );

			vSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );

			float rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );

			// extinction (absorbtion + out scattering)
			// rayleigh coefficients
			vBetaR = totalRayleigh * rayleighCoefficient;

			// mie coefficients
			vBetaM = totalMie( turbidity ) * mieCoefficient;

		}`,fragmentShader:`
		varying vec3 vWorldPosition;
		varying vec3 vSunDirection;
		varying float vSunfade;
		varying vec3 vBetaR;
		varying vec3 vBetaM;
		varying float vSunE;

		uniform float mieDirectionalG;
		uniform vec3 up;

		// constants for atmospheric scattering
		const float pi = 3.141592653589793238462643383279502884197169;

		const float n = 1.0003; // refractive index of air
		const float N = 2.545E25; // number of molecules per unit volume for air at 288.15K and 1013mb (sea level -45 celsius)

		// optical length at zenith for molecules
		const float rayleighZenithLength = 8.4E3;
		const float mieZenithLength = 1.25E3;
		// 66 arc seconds -> degrees, and the cosine of that
		const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;

		// 3.0 / ( 16.0 * pi )
		const float THREE_OVER_SIXTEENPI = 0.05968310365946075;
		// 1.0 / ( 4.0 * pi )
		const float ONE_OVER_FOURPI = 0.07957747154594767;

		float rayleighPhase( float cosTheta ) {
			return THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );
		}

		float hgPhase( float cosTheta, float g ) {
			float g2 = pow( g, 2.0 );
			float inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );
			return ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );
		}

		void main() {

			vec3 direction = normalize( vWorldPosition - cameraPosition );

			// optical length
			// cutoff angle at 90 to avoid singularity in next formula.
			float zenithAngle = acos( max( 0.0, dot( up, direction ) ) );
			float inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );
			float sR = rayleighZenithLength * inverse;
			float sM = mieZenithLength * inverse;

			// combined extinction factor
			vec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );

			// in scattering
			float cosTheta = dot( direction, vSunDirection );

			float rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );
			vec3 betaRTheta = vBetaR * rPhase;

			float mPhase = hgPhase( cosTheta, mieDirectionalG );
			vec3 betaMTheta = vBetaM * mPhase;

			vec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );
			Lin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );

			// nightsky
			float theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]
			float phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]
			vec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );
			vec3 L0 = vec3( 0.1 ) * Fex;

			// composition + solar disc
			float sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );
			L0 += ( vSunE * 19000.0 * Fex ) * sundisk;

			vec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );

			vec3 retColor = pow( texColor, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );

			gl_FragColor = vec4( retColor, 1.0 );

			#include <tonemapping_fragment>
			#include <colorspace_fragment>

		}`};var Om={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(Pm,function(){var t=function(){function r(P){return o.appendChild(P.dom),P}function i(P){for(var m=0;m<o.children.length;m++)o.children[m].style.display=m===P?"block":"none";s=P}var s=0,o=document.createElement("div");o.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",o.addEventListener("click",function(P){P.preventDefault(),i(++s%o.children.length)},!1);var a=(performance||Date).now(),l=a,p=0,w=r(new t.Panel("FPS","#0ff","#002")),h=r(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var M=r(new t.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:o,addPanel:r,showPanel:i,begin:function(){a=(performance||Date).now()},end:function(){p++;var P=(performance||Date).now();if(h.update(P-a,200),P>l+1e3&&(w.update(1e3*p/(P-l),100),l=P,p=0,M)){var m=performance.memory;M.update(m.usedJSHeapSize/1048576,m.jsHeapSizeLimit/1048576)}return P},update:function(){a=this.end()},domElement:o,setMode:i}};return t.Panel=function(r,i,s){var o=1/0,a=0,l=Math.round,p=l(window.devicePixelRatio||1),w=80*p,h=48*p,M=3*p,P=2*p,m=3*p,C=15*p,f=74*p,x=30*p,T=document.createElement("canvas");T.width=w,T.height=h,T.style.cssText="width:80px;height:48px";var E=T.getContext("2d");return E.font="bold "+9*p+"px Helvetica,Arial,sans-serif",E.textBaseline="top",E.fillStyle=s,E.fillRect(0,0,w,h),E.fillStyle=i,E.fillText(r,M,P),E.fillRect(m,C,f,x),E.fillStyle=s,E.globalAlpha=.9,E.fillRect(m,C,f,x),{dom:T,update:function(k,S){o=Math.min(o,k),a=Math.max(a,k),E.fillStyle=s,E.globalAlpha=1,E.fillRect(0,0,w,C),E.fillStyle=i,E.fillText(l(k)+" "+r+" ("+l(o)+"-"+l(a)+")",M,P),E.drawImage(T,m+p,C,f-p,x,m,C,f-p,x),E.fillRect(m+f-p,C,p,x),E.fillStyle=s,E.globalAlpha=.9,E.fillRect(m+f-p,C,p,l((1-k/S)*x))}}},t})})(Om);var Vm=`#include <common>

void main() {
  vec2 center = vec2(0., 1.);
  float rotation = 0.0;

  
  
  float size = 0.03;

  vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
  vec2 scale;
  scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
  scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

  bool isPerspective = isPerspectiveMatrix( projectionMatrix );
  if ( isPerspective ) scale *= - mvPosition.z;

  vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
  vec2 rotatedPosition;
  rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
  rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
  mvPosition.xy += rotatedPosition;

  gl_Position = projectionMatrix * mvPosition;
}`,jm=`void main() {
  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
}`;const bn=new J(0,0,0),Ii=new J(0,0,0),Rm=new J(0,0,0);function Vs(n,e,t){const r=bn.setFromMatrixPosition(n.matrixWorld);r.project(e);const i=t.width/2,s=t.height/2;return[(Number.isNaN(r.x)?0:r.x)*i+i,-(r.y*s)+s]}function Nm(n,e){const t=bn.setFromMatrixPosition(n.matrixWorld),r=Ii.setFromMatrixPosition(e.matrixWorld),i=t.sub(r),s=e.getWorldDirection(Rm);return i.angleTo(s)>Math.PI/2}function Dm(n,e,t,r){const i=bn.setFromMatrixPosition(n.matrixWorld),s=i.clone();s.project(e),t.setFromCamera(new ye(s.x,s.y),e);const o=t.intersectObjects(r,!0);if(o.length>0){const a=o[0].distance;return i.distanceTo(t.ray.origin)<a}return!0}function Bm(n,e){if(e instanceof Ot)return e.zoom;if(e instanceof Ke){const t=bn.setFromMatrixPosition(n.matrixWorld),r=Ii.setFromMatrixPosition(e.matrixWorld),i=e.fov*Math.PI/180,s=t.distanceTo(r);return 1/(2*Math.tan(i/2)*s)}else return 1}function Fm(n,e,t){if(e instanceof Ke||e instanceof Ot){const r=bn.setFromMatrixPosition(n.matrixWorld),i=Ii.setFromMatrixPosition(e.matrixWorld),s=r.distanceTo(i),o=(t[1]-t[0])/(e.far-e.near),a=t[1]-o*e.far;return Math.round(o*s+a)}}const Kr=n=>Math.abs(n)<1e-10?0:n;function ma(n,e,t=""){let r="matrix3d(";for(let i=0;i!==16;i++)r+=Kr(e[i]*n.elements[i])+(i!==15?",":")");return t+r}const Um=(n=>e=>ma(e,n))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),zm=(n=>(e,t)=>ma(e,n(t),"translate(-50%,-50%)"))(n=>[1/n,1/n,1/n,1,-1/n,-1/n,-1/n,-1,1/n,1/n,1/n,1,1,1,1,1]),Hm=["geometry","material"];new zs;const $m={name:"BasicScene",components:{TresCanvas:Bu,OrbitControls:Cm},data(){return{}}},fa=n=>(cl("data-v-5c770407"),n=n(),dl(),n),Gm=fa(()=>Vt("TresPerspectiveCamera",null,null,-1)),Km=fa(()=>Vt("TresMesh",{class:"box-one"},[Vt("TresBoxGeometry",{args:[1,1,1]}),Vt("TresMeshBasicMaterial",{color:"#2412FF",transparent:!0,opacity:.25})],-1));function Ym(n,e,t,r,i,s){const o=zi("OrbitControls"),a=zi("TresCanvas");return Ge(),qs(a,null,{default:ul(()=>[Xt(o),Gm,Km]),_:1})}const Qm=ll($m,[["render",Ym],["__scopeId","data-v-5c770407"]]);export{Qm as default};
